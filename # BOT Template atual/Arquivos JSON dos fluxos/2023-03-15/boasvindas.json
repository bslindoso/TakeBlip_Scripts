{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"1c27dfa3-2968-40a7-bb7d-e07499eda823","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f4078b7c-fd36-47ec-a5d6-57e5392cddaa","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"111px","left":"159px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"707ddd82-ac70-4497-ac43-7bc2760e04ea","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","typeOfStateId":"state","$connId":"con_3","$id":"8be4dbc8-c01d-43cd-823b-a4f2f99fd33b","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"error","conditions":[{"source":"input","comparison":"exists","values":[]}],"$id":"2b261064-4ccb-44a4-ae37-67890ed2d033","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[{"$id":"b7d8a5e8-fe2c-4a36-827d-db4e935f9c3d","$typeOfContent":"","type":"ExecuteScript","$title":"exception","$invalid":false,"settings":{"function":"run","source":"function run(previousState, typeInput) {\n    try {\n        typeInput = JSON.parse(typeInput).input\n        let idFormated = previousState.split(' ');\n        idFormated = idFormated[0].replace(/\\[/g,'').replace(/\\]/g,'').replace(/\\./g,'');\n        const exception = {\n            id: `${idFormated}`,\n            input: '{{input.content}}',\n            redirectMenu: `${typeInput}`\n        }\n        return exception\n    }\n    catch (e) {\n        return 'error'\n    }\n}","inputVariables":["state.previous.name","validInputJs"],"outputVariable":"exception","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"45px","left":"1698px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"action":{"$id":"695b5f9d-0544-4cc3-9485-eeded0eeb4ec","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6d25cb97-cc30-4b8a-aecd-c0e52f520e5e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6d25cb97-cc30-4b8a-aecd-c0e52f520e5e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f77d8144-fe5d-4bea-9047-c57a79088ac4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"03fb2c56-3d6f-4060-b629-7b0014fdabe6","type":"text/plain","content":"Ol√°! Eu sou Ol√≠via, seu contato inteligente do {{n1}}Al√¥ Oncocl√≠nicas!{{n2}} üòÑüíô\n\nVou te ajudar com o que precisar de forma r√°pida e pr√°tica. ","metadata":{}},"$cardContent":{"document":{"id":"03fb2c56-3d6f-4060-b629-7b0014fdabe6","type":"text/plain","content":"Ol√°! Eu sou Ol√≠via, seu contato inteligente do {{n1}}Al√¥ Oncocl√≠nicas!{{n2}} üòÑüíô\n\nVou te ajudar com o que precisar de forma r√°pida e pr√°tica. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"name"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"name","expiration":"2:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_13","$id":"f74cd007-f647-4039-a3a2-fcd077971afc","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"privacyPolicy"}],"$invalid":false},{"stateId":"d338f9e9-6010-4547-9d7f-1527381e3d57","typeOfStateId":"state","$connId":"con_18","$id":"ee5884fe-90dd-4866-82cd-39a47a308007","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6146ae07-d367-4b08-9daa-f2a8e356a3fc","$typeOfContent":"","type":"TrackEvent","$title":"boas vindas oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"boas vindas oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"956fc0bd-1e9d-4582-8f5b-5454b8aff552","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"d338f9e9-6010-4547-9d7f-1527381e3d57","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"welcome","$title":"[BV.1.1.0] Apresenta√ß√£o","$position":{"top":"311px","left":"155px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fbf92afc-a1bf-400c-8e40-22d772bf16fa","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7d31e570-2f6e-4693-9895-eb1669fe5c4d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Exce√ß√µes","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{exception}}"},"address":"sacexcecao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"error","$title":"[REDIRECT TO] Exce√ß√µes","$position":{"top":"45px","left":"1902px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"f4078b7c-fd36-47ec-a5d6-57e5392cddaa":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d177afe0-1fc9-47f7-8d6d-a8888d6c114c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_23","$id":"7227a028-c0fe-4e1f-a89b-50f7ab9ec86e","conditions":[{"source":"input","comparison":"equals","values":["MENU"]},{"source":"context","comparison":"equals","variable":"privacyPolicy","values":["true"]}],"$invalid":false},{"stateId":"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898","typeOfStateId":"state","$connId":"con_28","$id":"a67efdf5-bbfd-4800-b030-2378aacdf05f","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"returnException"}],"$invalid":false},{"stateId":"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4","typeOfStateId":"state","$connId":"con_33","$id":"92093d7d-4ec2-45fa-a5c6-7ea747c187cd","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"return"},{"source":"context","comparison":"exists","values":[],"variable":"return"}],"$invalid":false},{"stateId":"welcome","typeOfStateId":"state","$connId":"con_38","$id":"6a92a1c2-2268-4114-a92e-ee5f30f5a409","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"98c87606-f80d-41c9-85b9-ba045acd21be","$typeOfContent":"","type":"SetVariable","$title":"SERVICE","$invalid":false,"settings":{"variable":"service","value":"sacboasvindas"},"conditions":[]},{"$id":"d3a5114c-7cef-4f0d-af4a-31e3c74f7d07","$typeOfContent":"","type":"ExecuteScript","$title":"GET PLATFORM","$invalid":false,"settings":{"function":"run","source":"function run(contactIdentity) {\n    return getUserChannel(contactIdentity);\n}\n\nfunction getUserChannel(contactIdentity) {\n    const DEFAULT_CHANNEL = 'default';\n    const CHANNEL_INDEX = 1;\n\n    const CHANNEL_IDENTIFIERS = {\n        'wa.gw.msging.net': 'WhatsApp',\n        '0mn.io': 'BlipChat',\n        'take.io': 'TakeSMS',\n        'messenger.gw.msging.net': 'Messenger',\n        'instagram.gw.msging.net': 'Instagram',\n        'abs.gw.msging.net': 'Teams',\n        'businessmessages.gw.msging.net': 'gbm',\n        'skype.gw.msging.net': 'Skype',\n        'telegram.gw.msging.net': 'Telegram',\n        'workplace.gw.msging.net': 'Workplace',\n        'mailgun.gw.msging.net': 'Email',\n        'pagseguro.gw.msging.net': 'PageSeguro'\n    };\n\n    let contactChannelId = contactIdentity.split('@')[CHANNEL_INDEX];\n\n    return CHANNEL_IDENTIFIERS[contactChannelId] || DEFAULT_CHANNEL;\n}","inputVariables":["contact.identity"],"outputVariable":"platform","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1e0a12c3-3bd0-45b8-9592-898a0d17fb7a","$typeOfContent":"","type":"ExecuteScript","$title":"CHANNEL TAGS","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\nfunction run(platform) {\n  return channelTags(platform);\n}","inputVariables":["platform"],"outputVariable":"channelTags","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c185e811-51f6-4036-bb91-b84d8a08be1e","$typeOfContent":"","type":"ExecuteScript","$title":"GET PHONE","$invalid":false,"settings":{"function":"run","source":"function run(contact) {\n                \n    let phone = contact.split(\"@\")[0].replace(\"55\", \"\");   \n    let tamanho = phone.length;\n\n\n    if(tamanho == 10){\n        \n        let telefone = phone.split('').join().replace(/\\D/g, '');\n        let math = Math.floor(telefone.length - 8 ); \n        let concat = telefone.substr(0,math)+\"9\"+telefone.substr(math);\n        let retorno = concat;\n\n        return retorno;\n    }\n    if(tamanho == 11){\n        \n        let retorno = phone\n        return retorno;\n    }\n\n}","inputVariables":["contact.identity"],"outputVariable":"phone","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]}]},{"$id":"01a695de-17bd-4fa4-aa10-1b8be89092e0","$typeOfContent":"","type":"SetVariable","$title":"whatsappPhone","$invalid":false,"settings":{"variable":"whatsappPhone","value":"{{phone}}"},"conditions":[]},{"$id":"9723fb17-392b-4ef1-ab2d-d6fa1757bb60","$typeOfContent":"","type":"SetVariable","$title":"openBold","$invalid":false,"settings":{"variable":"n1","value":"{{channelTags@bold.open}}","expiration":null},"conditions":[]},{"$id":"d6ecf2df-35e3-47bc-9895-c41306197d45","$typeOfContent":"","type":"SetVariable","$title":"closeBold","$invalid":false,"settings":{"variable":"n2","value":"{{channelTags@bold.close}}"},"conditions":[]},{"$id":"9149107e-580b-4eb3-8eb9-165b47482575","$typeOfContent":"","type":"SetVariable","$title":"openItalic","$invalid":false,"settings":{"variable":"i1","value":"{{channelTags@italic.open}}"},"conditions":[]},{"$id":"56e47675-bdb9-4f24-bd2e-83ce80b7c6c0","$typeOfContent":"","type":"SetVariable","$title":"closeItalic","$invalid":false,"settings":{"variable":"i2","value":"{{channelTags@italic.close}}"},"conditions":[]},{"$id":"bdb84258-dd8b-45a5-a69c-3a169bebf84e","$typeOfContent":"","type":"SetVariable","$title":"italicValue","$invalid":false,"settings":{"variable":"italicValue","value":"{{channelTags@italic}}"},"conditions":[]},{"$id":"3cac1085-9f69-4efe-a0cb-5b21e60c1cb7","$typeOfContent":"","type":"ExecuteScript","$title":"AtualizaTelefoneWpp","$invalid":false,"settings":{"function":"run","source":"function run(identificador) {\nvar telefoneUsuario = identificador.split(\"@\")[0];\nreturn telefoneUsuario;\n}","inputVariables":["contact.identity"],"outputVariable":"telAjustado","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]}]},{"$id":"2b67cddf-03af-41f5-a723-07176d8344eb","$typeOfContent":"","type":"ProcessHttp","$title":"GetNameWpp","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n\"id\": \"{{$guid}}\",\n\"to\": \"postmaster@wa.gw.msging.net\",\n\"method\": \"get\",\n\"uri\": \"lime://wa.gw.msging.net/accounts/{{telAjustado}}\"\n}","uri":"{{config.urlBlip}}","responseStatusVariable":"statusNameWpp","responseBodyVariable":"responseNameWpp"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["WhatsApp"]}]},{"$id":"ce22a169-7f63-4bd6-b375-ace0b1246918","$typeOfContent":"","type":"MergeContact","$title":"SetNameWpp","$invalid":false,"settings":{"extras":{},"name":"{{responseNameWpp@resource.fullName}}"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]}]}],"$leavingCustomActions":[{"$id":"814fe256-ce33-47c2-a31e-50f62e0b8d14","$typeOfContent":"","type":"SetVariable","$title":"name","$invalid":false,"settings":{"variable":"name","value":"{{responseNameWpp@resource.fullName}}"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["whatsapp"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-d2f6d32a-8f3d-ae80-2164-881f1467e0ac","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"f4078b7c-fd36-47ec-a5d6-57e5392cddaa","root":false,"$title":"[REQUIREMENTS]","$position":{"top":"198.571px","left":"159px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#000000","textColor":"#ffffff","commentsIdList":[]}},"a4425c36-b361-4363-97cc-0bb558f88edf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"23db93b0-a85a-41fa-8b51-374afe7e7b68","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"a4425c36-b361-4363-97cc-0bb558f88edf","root":false,"$title":"[GO TO] Finaliza√ß√£o","$position":{"top":"506px","left":"560px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000"}},"3b904cac-d437-46b1-8b32-fe2450a423d7":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","typeOfStateId":"state","$connId":"con_43","$id":"7e7cff67-6680-44da-9e70-bb398a9a0334","conditions":[{"source":"context","comparison":"equals","values":["SAIR"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"fa878c43-b5a2-4997-94a1-521013c240c8","typeOfStateId":"state","$connId":"con_48","$id":"7ad6e10d-366d-456b-8fcf-f201591999a9","conditions":[{"source":"context","comparison":"equals","values":["Informa√ß√µes"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"68862337-f436-4b3e-83a2-c499a0cf0a8e","typeOfStateId":"state","$connId":"con_53","$id":"28503015-2190-4454-83f7-a6a9e5b95a81","conditions":[{"source":"context","comparison":"equals","values":["Elogios"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"2e009768-50e9-4520-86e9-581a91352fcc","typeOfStateId":"state","$connId":"con_58","$id":"d07fdb41-2e32-4586-ae53-419b0d78eb3b","conditions":[{"source":"context","comparison":"equals","values":["D√∫vidas"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"4d3926d6-006a-4325-b1ea-1a6b34e894fe","typeOfStateId":"state","$connId":"con_63","$id":"0c0474f1-f3c8-474e-ba94-0d82bbed4a47","conditions":[{"source":"context","comparison":"equals","values":["Sugest√µes"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"e1ec8e88-b921-498b-87c6-ef7caee990b3","typeOfStateId":"state","$connId":"con_68","$id":"fb36986e-4597-4673-b524-7139e9f9d32c","conditions":[{"source":"context","comparison":"equals","values":["Reclama√ß√µes"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': 'Eu trouxe aqui alguns assuntos que podem ajudar. üòÉ\\n{{n1}}Agora digite o n√∫mero da op√ß√£o que deseja:{{n2}}',\n    'options': [\"Informa√ß√µes\", \"D√∫vidas\", \"Reclama√ß√µes\", \"Elogios\", \"Sugest√µes\"],\n    'values': [\"Informa√ß√µes\", \"D√∫vidas\", \"Reclama√ß√µes\", \"Elogios\", \"Sugest√µes\"],\n    'description': [],\n    'itens': [\n      { name: ['Informa√ß√µes'] },\n      { name: ['D√∫vidas'] },\n      { name: ['Reclama√ß√µes'] },\n      { name: ['Elogios'] },\n      { name: ['Sugest√µes'] }\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${ i + 1 }`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": false,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": false,\n      \"defaultText\": true,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"19b44b1c-95c2-4d6f-be90-4d0f0d3f8a6e","$typeOfContent":"","type":"TrackEvent","$title":"menu principal oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"menu principal oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"df568ace-ba78-4a52-9b1f-95e2cbbdca70","$typeOfContent":"","type":"SetVariable","$title":"menu opcao escolhida","$invalid":false,"settings":{"variable":"menuOptEscolhido","value":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"ca0780fb-4590-4991-b281-fda1d115b2b6","$typeOfContent":"","type":"TrackEvent","$title":"menu principal oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"menu principal oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"source":"input","comparison":"exists","values":[]}]},{"$id":"66155932-cd0b-4c34-9628-39d25d459551","$typeOfContent":"","type":"TrackEvent","$title":"menu principal oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"menu principal oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"3bf5dbe0-4929-423e-a075-dcc5768a9460","$typeOfContent":"","type":"SetVariable","$title":"return - true","$invalid":false,"settings":{"variable":"return","value":"true"},"conditions":[]},{"$id":"5cfc6778-425f-413c-87b1-0b16b589ad5f","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - true","$invalid":false,"settings":{"variable":"privacyPolicy","value":"true"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"3b904cac-d437-46b1-8b32-fe2450a423d7","$title":"[BV.1.5.0] [MENU] Menu Principal","$position":{"top":"309.889px","left":"1029px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff"}},"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4":{"$contentActions":[{"action":{"$id":"ca9b5a0a-b2a8-478c-8bd2-973bfb4e9482","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"83c55b9c-30ae-4454-9bc3-e5ea17549121","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"83c55b9c-30ae-4454-9bc3-e5ea17549121","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f77d8144-fe5d-4bea-9047-c57a79088ac4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"03fb2c56-3d6f-4060-b629-7b0014fdabe6","type":"text/plain","content":"Ol√°! Eu sou Ol√≠via, seu contato inteligente do {{n1}}Al√¥ Oncocl√≠nicas!{{n2}} üòÑüíô","metadata":{}},"$cardContent":{"document":{"id":"03fb2c56-3d6f-4060-b629-7b0014fdabe6","type":"text/plain","content":"Ol√°! Eu sou Ol√≠via, seu contato inteligente do {{n1}}Al√¥ Oncocl√≠nicas!{{n2}} üòÑüíô"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_73","$id":"a1e3828d-a523-4265-9f16-f97b45ad097c","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"privacyPolicy"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6146ae07-d367-4b08-9daa-f2a8e356a3fc","$typeOfContent":"","type":"TrackEvent","$title":"retorno Exibicao","$invalid":false,"settings":{"extras":{},"category":"retorno Exibicao","action":"Exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"dacda750-a583-40dc-b5e2-110e2773b0a3","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4","$title":"[R.1.0.0] Retorno","$position":{"top":"316px","left":"341px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aebf3f0a-56ac-4466-b042-70cabc54dbf4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{returnBlockId}}","typeOfStateId":"variable","$id":"5a5e1d62-fe29-4e31-87f5-baa07e27c542","conditions":[{"source":"context","comparison":"notEquals","values":["ERROR"],"variable":"returnBlockId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ad440f48-87c3-4fa8-be77-43d1b0e5b835","$typeOfContent":"","type":"SetVariable","$title":"returnException","$invalid":false,"settings":{"variable":"returnException","value":"false"},"conditions":[]},{"$id":"c8ef55ca-3bf7-4e60-8e94-8a2a9ae327c5","$typeOfContent":"","type":"ExecuteScript","$title":"returnBlockId","$invalid":false,"settings":{"function":"run","source":"function run(exception) {\n  try {\n    exception = JSON.parse(exception)\n    const exceptionId = exception.id\n\n    const blockList = [\n      { exceptionId: \"BV130\", blockId: \"dacda750-a583-40dc-b5e2-110e2773b0a3\" },\n      { exceptionId: \"BV150\", blockId: \"3b904cac-d437-46b1-8b32-fe2450a423d7\" },\n      { exceptionId: \"BV161\", blockId: \"b8c2a447-77de-47b8-a210-6d60cf750791\" },\n      { exceptionId: \"BV162\", blockId: \"030ccb72-b7b1-4953-834d-8fe7954afacc\" },\n      { exceptionId: \"BV163\", blockId: \"7cd264c6-3f76-4f1e-8c8e-91425dacfe94\" },\n      { exceptionId: \"BV166\", blockId: \"fe2b6af2-1cd7-4eba-a508-03b506c2aca2\" },\n      { exceptionId: \"BV168\", blockId: \"c0ce1f3c-cb5f-4c11-a569-0b63a1a0fdc4\" },\n      { exceptionId: \"BV169\", blockId: \"2026e381-c994-4222-9e5b-125cb041f39c\" },\n      { exceptionId: \"BV220\", blockId: \"dd5e045e-f5ef-41bb-afc8-0e4da5ddcd56\" },\n    ]\n\n    let returnBlockId = \"\"\n\n    blockList.forEach(element => {\n      var find = exceptionId == element.exceptionId ? element.blockId : ''\n      if (find != '') {\n        returnBlockId = find\n      }\n    })\n\n    if (returnBlockId == \"\") {\n      returnBlockId = \"ERROR: COULDN'T MATCH EXCEPTION ID. DID YOU LINKED EXCEPTION ID TO BLOCK ID?\"\n    }\n\n    return returnBlockId\n  } catch (e) {\n    return \"ERROR: SCRIPT FAILURE\"\n  }\n}","inputVariables":["exception"],"outputVariable":"returnBlockId","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898","root":false,"$title":"Retorno Exce√ß√£o","$position":{"top":"114.25px","left":"344px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#eb9694","textColor":"#000000"}},"dacda750-a583-40dc-b5e2-110e2773b0a3":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_78","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"dd5e045e-f5ef-41bb-afc8-0e4da5ddcd56","typeOfStateId":"state","$connId":"con_83","$id":"3eff8c2b-4003-49f3-a732-5d56cd43750c","conditions":[{"source":"context","comparison":"equals","values":["N√£o","Nao","Menu"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","typeOfStateId":"state","$connId":"con_88","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': `Est√° de acordo com a nossa {{n1}}pol√≠tica de privacidade?{{n2}}`,\n    'options': [\"Sim\", \"N√£o\"],\n    'values': [\"Sim\", \"N√£o\"],\n    'description': [],\n    'itens': [\n      { name: ['Sim', 'sim', 's', 'ss', 'yes'] },\n      { name: ['N√£o', 'nao', 'no', 'n', 'nn', 'nope'] }\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": true,\n      \"blipchatMenu\": false,\n      \"defaultText\": false,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"quick reply politica oncoclinicas exibicao","$invalid":false,"settings":{"extras":{},"category":"quick reply politica oncoclinicas exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"quick reply politica oncoclinicas selecao","$invalid":false,"settings":{"extras":{},"category":"quick reply politica oncoclinicas selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"quick reply politica oncoclinicas input inesperado","$invalid":false,"settings":{"extras":{},"category":"quick reply politica oncoclinicas input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"3d1427d0-c66c-401a-881d-a0a24d2f50c2","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - false","$invalid":false,"settings":{"variable":"privacyPolicy","value":"false"},"conditions":[]},{"$id":"5eaca6c7-e5d3-4488-b214-205878c3a2d5","$typeOfContent":"","type":"TrackEvent","$title":"aceite politica privacidade relatorio","$invalid":false,"settings":{"extras":{},"category":"aceite politica privacidade relatorio","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"dacda750-a583-40dc-b5e2-110e2773b0a3","$title":"[BV.1.3.0] [MENU] - Politica de Priv","$position":{"top":"635px","left":"376px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dd5e045e-f5ef-41bb-afc8-0e4da5ddcd56":{"$contentActions":[{"action":{"$id":"84cf7ddb-643e-4d78-ab0b-f3fb747a21dd","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f507c664-198b-4ca0-9199-ceb3f3ce6f94","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f507c664-198b-4ca0-9199-ceb3f3ce6f94","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"461f2306-893d-4550-939f-081e0c3e71ef","$typeOfContent":"text","type":"SendMessage","settings":{"id":"59e519eb-6044-42ca-b033-a170594049b6","type":"text/plain","content":"Poxa...üòî\nDessa forma, n√£o conseguirei te ajudar...","metadata":{}},"$cardContent":{"document":{"id":"59e519eb-6044-42ca-b033-a170594049b6","type":"text/plain","content":"Poxa...üòî\nDessa forma, n√£o conseguirei te ajudar..."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_93","$id":"bae0f186-ad1c-4c77-9020-ded27eca92b5","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","typeOfStateId":"state","$connId":"con_98","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair","Encerrar","N√£o","Nao"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': `{{n1}}Deseja continuar aceitando nossos termos de privacidade?{{n2}}`,\n    'options': [\"Sim\", \"N√£o\"],\n    'values': [\"Sim\", \"N√£o\"],\n    'description': [],\n    'itens': [\n      { name: ['Sim', 'sim', 's', 'ss', 'yes'] },\n      { name: ['N√£o', 'nao', 'no', 'n', 'nn', 'nope'] }\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${ i + 1 }`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": true,\n      \"blipchatMenu\": false,\n      \"defaultText\": false,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"mensagem para ajudar exibicao","$invalid":false,"settings":{"extras":{},"category":"mensagem para ajudar exibicao","action":"Exibicao"},"conditions":[]},{"$id":"70f6a881-545f-44a8-982c-b131560937e0","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica exibicao","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica selecao","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica selecao","action":"{{validInputJs@input}}"},"conditions":[]},{"$id":"7ada7392-d912-455f-8396-b1527d5679c2","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica input inesperado","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"01b444aa-49cc-4cdc-80fd-3d2363e1dc62","$typeOfContent":"","type":"TrackEvent","$title":"aceite politica privacidade relatorio","$invalid":false,"settings":{"extras":{},"category":"aceite politica privacidade relatorio","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"06cf4b99-1cfd-46dd-a134-ee755448559e","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - false","$invalid":false,"settings":{"variable":"privacyPolicy","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"dd5e045e-f5ef-41bb-afc8-0e4da5ddcd56","$title":"[BV.2.2.0] [MENU] - Pol√≠tica de Priv N√£o","$position":{"top":"634px","left":"564px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d338f9e9-6010-4547-9d7f-1527381e3d57":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"493e83b7-831c-48d6-93fd-4a1477bc59ff","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$id":"a961affc-6c45-4d13-ab47-86175fe83a28","conditions":[{"source":"context","comparison":"equals","values":["WhatsApp"],"variable":"platform"}],"$invalid":false,"stateId":"35105fc7-fba2-4e8c-bd36-5676d1f317e9","$connId":"con_103"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"7757626a-5c2a-43f3-9535-61ae6f3a676a","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"d338f9e9-6010-4547-9d7f-1527381e3d57","root":false,"$title":"[Router] Pol√≠tica de Privacidade","$position":{"top":"444px","left":"160px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff"}},"7757626a-5c2a-43f3-9535-61ae6f3a676a":{"$contentActions":[{"action":{"$id":"9c4423a7-466f-455e-91d5-aa1952a832c4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"dcbff215-4dbc-49c7-82a7-11ce5fa7af1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"dcbff215-4dbc-49c7-82a7-11ce5fa7af1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0269d339-aec0-4753-bd76-5cd67be6ad72","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4fa4835d-7324-4a22-9136-522254c95852","type":"text/plain","content":"Mas antes, preciso saber se voc√™ est√° de acordo com a nossa {{n1}}pol√≠tica de privacidade{{n2}} no link abaixo:","metadata":{}},"$cardContent":{"document":{"id":"4fa4835d-7324-4a22-9136-522254c95852","type":"text/plain","content":"Mas antes, preciso saber se voc√™ est√° de acordo com a nossa {{n1}}pol√≠tica de privacidade{{n2}} no link abaixo:"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a97bb138-bb94-4c85-8080-400b575e7a69","$typeOfContent":"web-link","type":"SendMessage","settings":{"id":"69cfcb59-f81c-4e07-8451-7247f2d712a6","type":"application/vnd.lime.web-link+json","content":{"uri":"https://grupooncoclinicas.com/o-grupo/protecao-de-dados","target":"blank","title":"Pol√≠tica de Privacidade","text":"Oncocl√≠nicas","previewUri":""},"metadata":{}},"$cardContent":{"document":{"id":"69cfcb59-f81c-4e07-8451-7247f2d712a6","type":"application/vnd.lime.web-link+json","content":{"uri":"https://grupooncoclinicas.com/o-grupo/protecao-de-dados","target":"blank","title":"Pol√≠tica de Privacidade","text":"Oncocl√≠nicas","previewUri":""}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8d4a410a-05de-43ad-8498-76173ec459e3","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"dacda750-a583-40dc-b5e2-110e2773b0a3","typeOfStateId":"state","$connId":"con_108","$id":"cba9c751-692a-41bd-b2d0-07d2135c3961","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"37d8adb0-3f27-468b-8fb1-4f2b753c9396","$typeOfContent":"","type":"TrackEvent","$title":"politica de privacidade oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"politica de privacidade oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"dacda750-a583-40dc-b5e2-110e2773b0a3","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"7757626a-5c2a-43f3-9535-61ae6f3a676a","root":false,"$title":"[BV.1.2.0] Pol√≠tica de Privacidade [Default]","$position":{"top":"710px","left":"162px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"35105fc7-fba2-4e8c-bd36-5676d1f317e9":{"$contentActions":[{"action":{"$id":"4c92c09a-2df0-42ab-9b7c-a02500e5b307","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"48c58a25-33a0-4750-ada2-25f6e0be42f6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"48c58a25-33a0-4750-ada2-25f6e0be42f6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b50ec755-1c8c-455b-a2b7-38ee4255577c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"application/json","rawContent":"{\n    \"type\": \"template\",\n    \"template\": {\n        \"name\": \"privacypolicy2\",\n        \"language\": {\n            \"policy\": \"deterministic\",\n            \"code\": \"pt_BR\"\n        }\n    }\n}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"39ad8e73-725b-4fdd-8d0e-b2d2e4456e67","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"dacda750-a583-40dc-b5e2-110e2773b0a3","typeOfStateId":"state","$connId":"con_113","$id":"4bab57ef-17ff-4102-b377-b3feda901238","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fa5b5596-29d7-4e23-80f5-844952471f56","$typeOfContent":"","type":"TrackEvent","$title":"politica de privacidade oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"politica de privacidade oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"dacda750-a583-40dc-b5e2-110e2773b0a3","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"35105fc7-fba2-4e8c-bd36-5676d1f317e9","root":false,"$title":"[BV.1.2.0] Pol√≠tica de Privacidade [WhatsApp]","$position":{"top":"555px","left":"161px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8c2a447-77de-47b8-a210-6d60cf750791":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"nomePaciente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0","variable":"nomePaciente"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c3d0fb85-b44c-4a84-8806-7f9d0a43fed4","typeOfStateId":"state","$connId":"con_118","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false},{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_123","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = \"Por favor, digite {{n1}}o nome completo do paciente:{{n2}}\"\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"21616883-4e77-4809-a55c-704b4a177efc","$typeOfContent":"","type":"MergeContact","$title":"Nome [BlipChat]","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"platform","values":["BlipChat"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"b8c2a447-77de-47b8-a210-6d60cf750791","$title":"[BV.1.6.1] Nome do Paciente","$position":{"top":"1203.75px","left":"427.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c3d0fb85-b44c-4a84-8806-7f9d0a43fed4":{"$contentActions":[{"action":{"$id":"ab11f36c-9b7f-4198-aefc-d229f78f84db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Descreva em uma {{n1}}√∫nica mensagem a informa√ß√£o que gostaria,{{n2}} para que possamos agilizar seu atendimento. üëá","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Descreva em uma {{n1}}√∫nica mensagem a informa√ß√£o que gostaria,{{n2}} para que possamos agilizar seu atendimento. üëá"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_128","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_133","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"informacoes oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"informacoes oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"f9de14af-cf4a-4912-bef8-e11cc19dc7d7","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"2978b786-6870-4b2d-84d9-4660edc9d530","$typeOfContent":"","type":"TrackEvent","$title":"informacoes oncoclinicas sac input","$invalid":false,"settings":{"extras":{},"category":"informacoes oncoclinicas sac input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"c3d0fb85-b44c-4a84-8806-7f9d0a43fed4","$title":"[BV.1.7.0] Informa√ß√µes - Descri√ß√£o","$position":{"top":"1336px","left":"428.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f4e348c8-8177-452d-8e92-3d4fd9628aab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e5a8f9df-a63e-4da4-b387-3f28b5fb7781","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b8c2a447-77de-47b8-a210-6d60cf750791","typeOfStateId":"state","$connId":"con_138","$id":"51abb05d-efef-4d96-84fe-f2a7f4c8decd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b8c2a447-77de-47b8-a210-6d60cf750791","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"f4e348c8-8177-452d-8e92-3d4fd9628aab","root":false,"$title":"Informa√ß√µes","$position":{"top":"1118px","left":"427.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]}},"fa878c43-b5a2-4997-94a1-521013c240c8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fa5dfe1f-4ded-40d1-bb39-60cafdbd66b2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f4e348c8-8177-452d-8e92-3d4fd9628aab","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"fa878c43-b5a2-4997-94a1-521013c240c8","root":false,"$title":"[GO TO] Informa√ß√µes","$position":{"top":"456.333px","left":"936.111px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000"}},"c7bf6663-3c3c-408b-b353-6d3358fd45bf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"23db93b0-a85a-41fa-8b51-374afe7e7b68","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","root":false,"$title":"[GO TO] Finaliza√ß√£o [1]","$position":{"top":"1263.75px","left":"1249.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"23db93b0-a85a-41fa-8b51-374afe7e7b68":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Finalizar","$invalid":false,"settings":{"context":{"type":"text/plain","value":"finalizacao"},"address":"sacfinalizacao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"23db93b0-a85a-41fa-8b51-374afe7e7b68","root":false,"$title":"[REDIRECT TO] Finaliza√ß√£o","$position":{"top":"173.857px","left":"1902px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]}},"3b3a1408-7f24-45dc-b193-40fe62bb4fd7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Transbordo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"transbordo"},"address":"sactransbordo"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"3b3a1408-7f24-45dc-b193-40fe62bb4fd7","root":false,"$title":"[REDIRECT TO] Transbordo","$position":{"top":"302.143px","left":"1901.57px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]}},"f0de626a-0987-43b6-b464-8a35c9532cf6":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e5a8f9df-a63e-4da4-b387-3f28b5fb7781","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"030ccb72-b7b1-4953-834d-8fe7954afacc","typeOfStateId":"state","$connId":"con_143","$id":"51abb05d-efef-4d96-84fe-f2a7f4c8decd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"030ccb72-b7b1-4953-834d-8fe7954afacc","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"f0de626a-0987-43b6-b464-8a35c9532cf6","root":false,"$title":"D√∫vidas","$position":{"top":"1117px","left":"626px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]}},"030ccb72-b7b1-4953-834d-8fe7954afacc":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"nomePaciente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0","variable":"nomePaciente"},"$invalid":false}],"$conditionOutputs":[{"stateId":"fd9e53a1-984b-41a9-8d61-82a25e5cf9c3","typeOfStateId":"state","$connId":"con_148","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false},{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_153","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = \"Por favor, digite {{n1}}o nome completo do paciente:{{n2}}\"\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"c4c3e06e-33ec-4799-bf35-6ca76475686d","$typeOfContent":"","type":"MergeContact","$title":"Nome [BlipChat]","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"platform","values":["BlipChat"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"030ccb72-b7b1-4953-834d-8fe7954afacc","$title":"[BV.1.6.2] Nome do Paciente","$position":{"top":"1202.33px","left":"624.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fd9e53a1-984b-41a9-8d61-82a25e5cf9c3":{"$contentActions":[{"action":{"$id":"ab11f36c-9b7f-4198-aefc-d229f78f84db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Por favor, descreva {{n1}}em um √∫nico texto qual a sua d√∫vida{{n2}}, para que possamos agilizar seu atendimento. üëá","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Por favor, descreva {{n1}}em um √∫nico texto qual a sua d√∫vida{{n2}}, para que possamos agilizar seu atendimento. üëá"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_158","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_163","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"duvidas oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"duvidas oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"56b5d4b1-ecbf-41da-8771-8640613eb3a7","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"fb82feb1-9803-4f02-85c7-5190bb402a1f","$typeOfContent":"","type":"TrackEvent","$title":"duvidas oncoclinicas sac input","$invalid":false,"settings":{"extras":{},"category":"duvidas oncoclinicas sac input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"fd9e53a1-984b-41a9-8d61-82a25e5cf9c3","$title":"[BV.1.8.0] D√∫vida - Descri√ß√£o","$position":{"top":"1341px","left":"623px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8aa46fdf-05cf-4b6a-b86d-e48fc4009bec":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e5a8f9df-a63e-4da4-b387-3f28b5fb7781","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c0ce1f3c-cb5f-4c11-a569-0b63a1a0fdc4","typeOfStateId":"state","$connId":"con_168","$id":"51abb05d-efef-4d96-84fe-f2a7f4c8decd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c0ce1f3c-cb5f-4c11-a569-0b63a1a0fdc4","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"8aa46fdf-05cf-4b6a-b86d-e48fc4009bec","root":false,"$title":"Elogios","$position":{"top":"1118px","left":"823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]}},"c0ce1f3c-cb5f-4c11-a569-0b63a1a0fdc4":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"nomePaciente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0","variable":"nomePaciente"},"$invalid":false}],"$conditionOutputs":[{"stateId":"45eacecc-05b1-4a28-b2c6-b1a1777e844a","typeOfStateId":"state","$connId":"con_173","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false},{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_178","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = \"Por favor, digite {{n1}}o nome completo do paciente:{{n2}}\"\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"348412e1-84fc-4d01-913b-5e3132f69eca","$typeOfContent":"","type":"MergeContact","$title":"Nome [BlipChat]","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"platform","values":["BlipChat"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"c0ce1f3c-cb5f-4c11-a569-0b63a1a0fdc4","$title":"[BV.1.6.8] Nome do Paciente","$position":{"top":"1206px","left":"823px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"45eacecc-05b1-4a28-b2c6-b1a1777e844a":{"$contentActions":[{"action":{"$id":"ab11f36c-9b7f-4198-aefc-d229f78f84db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Adoramos saber que est√° feliz com o nossos servi√ßos! \n{{n1}}Por favor, deixe seu elogio ou coment√°rio{{n2}} ü§©","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Adoramos saber que est√° feliz com o nossos servi√ßos! \n{{n1}}Por favor, deixe seu elogio ou coment√°rio{{n2}} ü§©"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_183","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_188","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"elogios oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"elogios oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"60951174-9efb-430e-ac07-ae51b60125f6","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"e44073df-23fa-48d3-93e5-c27142db5de9","$typeOfContent":"","type":"TrackEvent","$title":"elogios oncoclinicas sac input","$invalid":false,"settings":{"extras":{},"category":"elogios oncoclinicas sac input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"45eacecc-05b1-4a28-b2c6-b1a1777e844a","$title":"[BV.2.0.0] Elogios - Descri√ß√£o","$position":{"top":"1344px","left":"824px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5797fcf3-f0f7-4fb1-8730-4de36e215f62":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e5a8f9df-a63e-4da4-b387-3f28b5fb7781","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2026e381-c994-4222-9e5b-125cb041f39c","typeOfStateId":"state","$connId":"con_193","$id":"51abb05d-efef-4d96-84fe-f2a7f4c8decd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"2026e381-c994-4222-9e5b-125cb041f39c","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"5797fcf3-f0f7-4fb1-8730-4de36e215f62","root":false,"$title":"Sugest√µes","$position":{"top":"1119px","left":"1026px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]}},"2026e381-c994-4222-9e5b-125cb041f39c":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"nomePaciente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0","variable":"nomePaciente"},"$invalid":false}],"$conditionOutputs":[{"stateId":"9471cd1a-3dfe-4910-9d64-b8e510e51db1","typeOfStateId":"state","$connId":"con_198","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false},{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_203","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = \"Por favor, digite {{n1}}o nome completo do paciente:{{n2}}\"\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"e18b28e3-3127-441b-99f7-937be3dbfb9f","$typeOfContent":"","type":"MergeContact","$title":"Nome [BlipChat]","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"platform","values":["BlipChat"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"2026e381-c994-4222-9e5b-125cb041f39c","$title":"[BV.1.6.9] Nome do Paciente","$position":{"top":"1206px","left":"1030px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9471cd1a-3dfe-4910-9d64-b8e510e51db1":{"$contentActions":[{"action":{"$id":"ab11f36c-9b7f-4198-aefc-d229f78f84db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Adoramos ouvir sugest√µes e ideias! \n{{n1}}Digite sua sugest√£o ou um coment√°rio{{n2}} üòä","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Adoramos ouvir sugest√µes e ideias! \n{{n1}}Digite sua sugest√£o ou um coment√°rio{{n2}} üòä"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_208","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_213","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"sugestoes oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"sugestoes oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c756168c-db91-4999-b7ae-b5dc274a4bf9","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"54f143ab-769a-43c5-8896-55daa55eb0df","$typeOfContent":"","type":"TrackEvent","$title":"sugestoes oncoclinicas sac input","$invalid":false,"settings":{"extras":{},"category":"sugestoes oncoclinicas sac input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"9471cd1a-3dfe-4910-9d64-b8e510e51db1","$title":"[BV.2.1.0] Sugest√µes - Descri√ß√£o","$position":{"top":"1346px","left":"1031px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2e009768-50e9-4520-86e9-581a91352fcc":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fa5dfe1f-4ded-40d1-bb39-60cafdbd66b2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f0de626a-0987-43b6-b464-8a35c9532cf6","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"2e009768-50e9-4520-86e9-581a91352fcc","root":false,"$title":"[GO TO] D√∫vidas","$position":{"top":"568.222px","left":"938.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"68862337-f436-4b3e-83a2-c499a0cf0a8e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fa5dfe1f-4ded-40d1-bb39-60cafdbd66b2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"8aa46fdf-05cf-4b6a-b86d-e48fc4009bec","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"68862337-f436-4b3e-83a2-c499a0cf0a8e","root":false,"$title":"[GO TO] Elogios","$position":{"top":"453.778px","left":"1124.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"4d3926d6-006a-4325-b1ea-1a6b34e894fe":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fa5dfe1f-4ded-40d1-bb39-60cafdbd66b2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5797fcf3-f0f7-4fb1-8730-4de36e215f62","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"4d3926d6-006a-4325-b1ea-1a6b34e894fe","root":false,"$title":"[GO TO] Sugest√µes","$position":{"top":"566.667px","left":"1126.44px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"bdd1f709-5f80-4016-9243-3d770084d8dc":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"e5a8f9df-a63e-4da4-b387-3f28b5fb7781","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7cd264c6-3f76-4f1e-8c8e-91425dacfe94","typeOfStateId":"state","$connId":"con_218","$id":"51abb05d-efef-4d96-84fe-f2a7f4c8decd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"7cd264c6-3f76-4f1e-8c8e-91425dacfe94","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"bdd1f709-5f80-4016-9243-3d770084d8dc","root":false,"$title":"Reclama√ß√µes","$position":{"top":"1123.56px","left":"1740.89px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]}},"7cd264c6-3f76-4f1e-8c8e-91425dacfe94":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"31323ecc-b1cc-4a77-b541-fd14e6c9c597","typeOfStateId":"state","$connId":"con_223","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"fe2b6af2-1cd7-4eba-a508-03b506c2aca2","typeOfStateId":"state","$connId":"con_228","$id":"3eff8c2b-4003-49f3-a732-5d56cd43750c","conditions":[{"source":"context","comparison":"equals","values":["N√£o","Nao","Menu"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"c7bf6663-3c3c-408b-b353-6d3358fd45bf","typeOfStateId":"state","$connId":"con_233","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': `Deseja fazer o registro de sua reclama√ß√£o {{n1}}anonimamente?{{n2}}`,\n    'options': [\"Sim\", \"N√£o\"],\n    'values': [\"Sim\", \"N√£o\"],\n    'description': [],\n    'itens': [\n      { name: ['Sim', 'sim', 's', 'ss', 'yes'] },\n      { name: ['N√£o', 'nao', 'no', 'n', 'nn', 'nope'] }\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": true,\n      \"blipchatMenu\": false,\n      \"defaultText\": false,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"7cd264c6-3f76-4f1e-8c8e-91425dacfe94","$title":"[BV.1.6.3] [MENU] - Registro An√¥nimo","$position":{"top":"1214px","left":"1743px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"31323ecc-b1cc-4a77-b541-fd14e6c9c597":{"$contentActions":[{"action":{"$id":"ab11f36c-9b7f-4198-aefc-d229f78f84db","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e4ec0384-3140-4c60-8b88-c61d68c5265d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Entendi! Pode relaxar e contar conosco! üòä\n\nVoc√™ n√£o ser√° identificado(a) para fazer o registro dessa reclama√ß√£o.","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"Entendi! Pode relaxar e contar conosco! üòä\n\nVoc√™ n√£o ser√° identificado(a) para fazer o registro dessa reclama√ß√£o."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"10f02777-d695-491e-a2fb-2353ed9f7dcc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"96fc2d44-54eb-40d3-8347-a2df72726de4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"96fc2d44-54eb-40d3-8347-a2df72726de4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8d6e3f7e-bdec-4b1b-96d5-713b05a15fd2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"0933dc40-2cce-4202-8cb4-8d5268c3770f","type":"text/plain","content":"{{n1}}Agora digite a sua reclama√ß√£o em poucas palavras.{{n2}} Logo iremos agilizar o seu atendimento. üëá","metadata":{}},"$cardContent":{"document":{"id":"0933dc40-2cce-4202-8cb4-8d5268c3770f","type":"text/plain","content":"{{n1}}Agora digite a sua reclama√ß√£o em poucas palavras.{{n2}} Logo iremos agilizar o seu atendimento. üëá"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"129ad7ea-1a2a-4b50-965d-038c829f4c88","typeOfStateId":"state","$connId":"con_238","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_243","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac feeback para anonimato exibicao","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac feeback para anonimato exibicao","action":"Exibicao"},"conditions":[]},{"$id":"2dd46b24-cd6b-4dec-85de-d7b7778fec4b","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac para anonimo exibicao","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac para anonimo exibicao","action":"Exibicao"},"conditions":[]},{"$id":"277c7fe3-dc77-43db-9555-8e65d205e5e7","$typeOfContent":"","type":"MergeContact","$title":"Nome [An√¥nimo]","$invalid":false,"settings":{"extras":{},"name":"An√¥nimo"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c756168c-db91-4999-b7ae-b5dc274a4bf9","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"54f143ab-769a-43c5-8896-55daa55eb0df","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac para anonimo input","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac para anonimo input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"31323ecc-b1cc-4a77-b541-fd14e6c9c597","$title":"[BV.1.6.4] Reclama√ß√£o An√¥nima","$position":{"top":"1398px","left":"1646px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fe2b6af2-1cd7-4eba-a508-03b506c2aca2":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"nomePaciente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0","variable":"nomePaciente"},"$invalid":false}],"$conditionOutputs":[{"stateId":"abef76d9-9efb-465c-b22a-bff61cd916eb","typeOfStateId":"state","$connId":"con_248","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false},{"stateId":"129ad7ea-1a2a-4b50-965d-038c829f4c88","typeOfStateId":"state","$connId":"con_253","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = \"Por favor, digite {{n1}}o nome completo do paciente:{{n2}}\"\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac selecao","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"solicita nome completo oncoclinicas sac input inesperado","$invalid":false,"settings":{"extras":{},"category":"solicita nome completo oncoclinicas sac input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"a2a6e8eb-58ad-44e4-b72b-bf052f3baf8c","$typeOfContent":"","type":"MergeContact","$title":"Nome [BlipChat]","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"platform","values":["BlipChat"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"fe2b6af2-1cd7-4eba-a508-03b506c2aca2","$title":"[BV.1.6.6] Nome do Paciente","$position":{"top":"1397.5px","left":"1842.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"abef76d9-9efb-465c-b22a-bff61cd916eb":{"$contentActions":[{"action":{"$id":"10f02777-d695-491e-a2fb-2353ed9f7dcc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"96fc2d44-54eb-40d3-8347-a2df72726de4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"96fc2d44-54eb-40d3-8347-a2df72726de4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"8d6e3f7e-bdec-4b1b-96d5-713b05a15fd2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"0933dc40-2cce-4202-8cb4-8d5268c3770f","type":"text/plain","content":"Por favor, {{n1}}digite a sua reclama√ß√£o em poucas palavras.{{n2}} Logo iremos agilizar o seu atendimento. üëá","metadata":{}},"$cardContent":{"document":{"id":"0933dc40-2cce-4202-8cb4-8d5268c3770f","type":"text/plain","content":"Por favor, {{n1}}digite a sua reclama√ß√£o em poucas palavras.{{n2}} Logo iremos agilizar o seu atendimento. üëá"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"1:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"129ad7ea-1a2a-4b50-965d-038c829f4c88","typeOfStateId":"state","$connId":"con_258","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"b559fa39-9227-4994-98eb-fc81b75603f0","typeOfStateId":"state","$connId":"con_263","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac exibicao","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c756168c-db91-4999-b7ae-b5dc274a4bf9","$typeOfContent":"","type":"SetVariable","$title":"descricao","$invalid":false,"settings":{"variable":"descricao","value":"{{input.content}}"},"conditions":[]},{"$id":"54f143ab-769a-43c5-8896-55daa55eb0df","$typeOfContent":"","type":"TrackEvent","$title":"reclamacoes oncoclinicas sac inputreclamacoes oncoclinicas sac input","$invalid":false,"settings":{"extras":{},"category":"reclamacoes oncoclinicas sac inputreclamacoes oncoclinicas sac input","action":"{{descricao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"abef76d9-9efb-465c-b22a-bff61cd916eb","$title":"[BV.1.6.7] Reclama√ß√£o - Descri√ß√£o","$position":{"top":"1529px","left":"1843.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"129ad7ea-1a2a-4b50-965d-038c829f4c88":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"23db93b0-a85a-41fa-8b51-374afe7e7b68","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"129ad7ea-1a2a-4b50-965d-038c829f4c88","root":false,"$title":"[GO TO] Finaliza√ß√£o [2]","$position":{"top":"1536.33px","left":"1645.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"b559fa39-9227-4994-98eb-fc81b75603f0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"86b7b60a-47d2-4d1f-a971-77336a42e8f9","$typeOfContent":"","type":"MergeContact","$title":"SAC","$invalid":false,"settings":{"extras":{"SAC":"{{menuOptEscolhido}} | {{descricao}}"}},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3b3a1408-7f24-45dc-b193-40fe62bb4fd7","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"b559fa39-9227-4994-98eb-fc81b75603f0","root":false,"$title":"[GO TO] Transbordo [1]","$position":{"top":"1525.33px","left":"1265px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"e1ec8e88-b921-498b-87c6-ef7caee990b3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fa5dfe1f-4ded-40d1-bb39-60cafdbd66b2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"bdd1f709-5f80-4016-9243-3d770084d8dc","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"e1ec8e88-b921-498b-87c6-ef7caee990b3","root":false,"$title":"[GO TO] Reclama√ß√µes","$position":{"top":"678.25px","left":"1035px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}