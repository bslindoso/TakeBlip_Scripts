{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"1c27dfa3-2968-40a7-bb7d-e07499eda823","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f4078b7c-fd36-47ec-a5d6-57e5392cddaa","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"73px","left":"1064px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"707ddd82-ac70-4497-ac43-7bc2760e04ea","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","typeOfStateId":"state","$connId":"con_3","$id":"8be4dbc8-c01d-43cd-823b-a4f2f99fd33b","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"error","conditions":[{"source":"input","comparison":"exists","values":[]}],"$id":"2b261064-4ccb-44a4-ae37-67890ed2d033","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[{"$id":"b7d8a5e8-fe2c-4a36-827d-db4e935f9c3d","$typeOfContent":"","type":"ExecuteScript","$title":"exception","$invalid":false,"settings":{"function":"run","source":"function run(previousState, typeInput, previousId) {\n    try {\n        typeInput = JSON.parse(typeInput).input\n        let idFormated = previousState.split(' ');\n        idFormated = idFormated[0].replace(/\\[/g,'').replace(/\\]/g,'').replace(/\\./g,'');\n        const exception = {\n            id: `${idFormated}`,\n            input: '{{input.content}}',\n            redirectMenu: `${typeInput}`,\n            blockId: previousId\n        }\n        return exception\n    }\n    catch (e) {\n        return 'error'\n    }\n}","inputVariables":["state.previous.name","validInputJs","state.previous.id"],"outputVariable":"exception","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"45px","left":"2201.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"action":{"$id":"bd3723bc-57d6-4c11-a044-91124ea4b164","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e36a0bc8-ec21-4a6a-a9b3-7838123a8871","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e36a0bc8-ec21-4a6a-a9b3-7838123a8871","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"86ef009e-9cbb-4a58-84cb-de8b9c2979c2","$typeOfContent":"text","type":"SendMessage","settings":{"id":"61b62d37-b294-4964-bf03-5fca0311b128","type":"text/plain","content":"Seja bem-vindo(a)! üë©\n\n{{n1}}Eu sou a assistente virtual da Care Plus Clinic.{{n2}} Posso ajudar voc√™ com:\n\n‚û°Ô∏è Agendamento;\n‚û°Ô∏è Reagendamento;\n‚û°Ô∏è Informa√ß√µes sobre nossas unidades;\n‚û°Ô∏è Informa√ß√µes sobre nossos servi√ßos;\n‚û°Ô∏è Informa√ß√µes sobre parcerias;\n‚û°Ô∏è e muito mais!","metadata":{}},"$cardContent":{"document":{"id":"61b62d37-b294-4964-bf03-5fca0311b128","type":"text/plain","content":"Seja bem-vindo(a)! üë©\n\n{{n1}}Eu sou a assistente virtual da Care Plus Clinic.{{n2}} Posso ajudar voc√™ com:\n\n‚û°Ô∏è Agendamento;\n‚û°Ô∏è Reagendamento;\n‚û°Ô∏è Informa√ß√µes sobre nossas unidades;\n‚û°Ô∏è Informa√ß√µes sobre nossos servi√ßos;\n‚û°Ô∏è Informa√ß√µes sobre parcerias;\n‚û°Ô∏è e muito mais!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"name"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"name","expiration":"2:0"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_13","$id":"0f6b1bf2-43e1-4b21-aec9-0306cd16646e","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"privacyPolicy"}],"$invalid":false},{"stateId":"5c234a8d-7660-4245-858f-f8867217bdf1","typeOfStateId":"state","$connId":"con_18","$id":"983c6c1b-8062-44c8-abdd-72d9c2cece0c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6146ae07-d367-4b08-9daa-f2a8e356a3fc","$typeOfContent":"","type":"TrackEvent","$title":"saudacao exibicao","$invalid":false,"settings":{"extras":{},"category":"saudacao exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"956fc0bd-1e9d-4582-8f5b-5454b8aff552","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"welcome","$title":"[S.0.0.0] Apresenta√ß√£o","$position":{"top":"277px","left":"1065px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fbf92afc-a1bf-400c-8e40-22d772bf16fa","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"66b8efe1-ec32-419c-976e-462c8dfa7384","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Exce√ß√µes","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{exception}}"},"address":"{{resource.serviceList@excecao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"error","$title":"[REDIRECT TO] Exce√ß√µes","$position":{"top":"33px","left":"2406px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"f4078b7c-fd36-47ec-a5d6-57e5392cddaa":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d177afe0-1fc9-47f7-8d6d-a8888d6c114c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c0dc0550-84da-4028-ba67-457020c2a070","typeOfStateId":"state","$connId":"con_23","$id":"5469df0b-52a7-46d7-8ecc-541a1f726046","conditions":[{"source":"input","comparison":"equals","values":["voltar ao menu"]}],"$invalid":false},{"stateId":"15015b8f-d406-4f25-b7e6-9d6c10f3ae39","typeOfStateId":"state","$connId":"con_28","$id":"cd712838-f30e-4aa1-a3cf-0788a7f03719","conditions":[{"source":"input","comparison":"startsWith","values":["MENU"]}],"$invalid":false},{"stateId":"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898","typeOfStateId":"state","$connId":"con_33","$id":"a67efdf5-bbfd-4800-b030-2378aacdf05f","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"returnException"}],"$invalid":false},{"stateId":"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4","typeOfStateId":"state","$connId":"con_38","$id":"fa13524c-248a-4362-bcc7-65086296e4a3","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"return"}],"$invalid":false},{"stateId":"welcome","typeOfStateId":"state","$connId":"con_43","$id":"6a92a1c2-2268-4114-a92e-ee5f30f5a409","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"98c87606-f80d-41c9-85b9-ba045acd21be","$typeOfContent":"","type":"SetVariable","$title":"SERVICE","$invalid":false,"settings":{"variable":"service","value":"boasvindas"},"conditions":[]},{"$id":"d3a5114c-7cef-4f0d-af4a-31e3c74f7d07","$typeOfContent":"","type":"ExecuteScript","$title":"GET PLATFORM","$invalid":false,"settings":{"function":"run","source":"function run(contactIdentity) {\n    return getUserChannel(contactIdentity);\n}\n\nfunction getUserChannel(contactIdentity) {\n    const DEFAULT_CHANNEL = 'default';\n    const CHANNEL_INDEX = 1;\n\n    const CHANNEL_IDENTIFIERS = {\n        'wa.gw.msging.net': 'WhatsApp',\n        '0mn.io': 'BlipChat',\n        'take.io': 'TakeSMS',\n        'messenger.gw.msging.net': 'Messenger',\n        'instagram.gw.msging.net': 'Instagram',\n        'abs.gw.msging.net': 'Teams',\n        'businessmessages.gw.msging.net': 'gbm',\n        'skype.gw.msging.net': 'Skype',\n        'telegram.gw.msging.net': 'Telegram',\n        'workplace.gw.msging.net': 'Workplace',\n        'mailgun.gw.msging.net': 'Email',\n        'pagseguro.gw.msging.net': 'PageSeguro'\n    };\n\n    let contactChannelId = contactIdentity.split('@')[CHANNEL_INDEX];\n\n    return CHANNEL_IDENTIFIERS[contactChannelId] || DEFAULT_CHANNEL;\n}","inputVariables":["contact.identity"],"outputVariable":"platform","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"1e0a12c3-3bd0-45b8-9592-898a0d17fb7a","$typeOfContent":"","type":"ExecuteScript","$title":"CHANNEL TAGS","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\nfunction run(platform) {\n  return channelTags(platform);\n}","inputVariables":["platform"],"outputVariable":"channelTags","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c185e811-51f6-4036-bb91-b84d8a08be1e","$typeOfContent":"","type":"ExecuteScript","$title":"Whatsapp Number","$invalid":false,"settings":{"function":"run","source":"function run(contact) {\n    \n    // Sem o c√≥digo do pa√≠s         \n    // let phone = contact.split(\"@\")[0].replace(\"55\", \"\");   \n\n    // Com o c√≥digo do pa√≠s\n    let phone = contact.split(\"@\")[0];   \n    let tamanho = phone.length;\n\n\n    if(tamanho == 10){\n        \n        let telefone = phone.split('').join().replace(/\\D/g, '');\n        let math = Math.floor(telefone.length - 8 ); \n        let concat = telefone.substr(0,math)+\"9\"+telefone.substr(math);\n        let retorno = concat;\n\n        return retorno;\n    } else {\n        \n        let retorno = phone\n        return retorno;\n    }\n\n}","inputVariables":["contact.identity"],"outputVariable":"wanumber","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]}]},{"$id":"b2c53651-fb9e-4163-b77e-5ffa56265b07","$typeOfContent":"","type":"MergeContact","$title":"Telefone: WhatsApp","$invalid":false,"settings":{"extras":{},"phoneNumber":"{{wanumber}}"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]},{"source":"context","comparison":"exists","values":[],"variable":"wanumber"}]},{"$id":"2b67cddf-03af-41f5-a723-07176d8344eb","$typeOfContent":"","type":"ProcessHttp","$title":"GET Whatsapp Information","$invalid":false,"settings":{"headers":{"Authorization":"{{resource.keyRouterBlip}}","Content-Type":"application/json"},"method":"POST","body":"{\n\"id\": \"{{$guid}}\",\n\"to\": \"postmaster@wa.gw.msging.net\",\n\"method\": \"get\",\n\"uri\": \"lime://wa.gw.msging.net/accounts/{{wanumber}}\"\n}","uri":"https://http.msging.net/commands","responseStatusVariable":"statusWppInfo","responseBodyVariable":"responseWppInfo"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["WhatsApp"]}]},{"$id":"ce22a169-7f63-4bd6-b375-ace0b1246918","$typeOfContent":"","type":"MergeContact","$title":"SET Whatsapp Full Name","$invalid":false,"settings":{"extras":{},"name":"{{responseWppInfo@resource.fullName}}"},"conditions":[{"source":"context","comparison":"equals","variable":"platform","values":["Whatsapp"]}]},{"$id":"9723fb17-392b-4ef1-ab2d-d6fa1757bb60","$typeOfContent":"","type":"SetVariable","$title":"openBold","$invalid":false,"settings":{"variable":"n1","value":"{{channelTags@bold.open}}","expiration":null},"conditions":[]},{"$id":"d6ecf2df-35e3-47bc-9895-c41306197d45","$typeOfContent":"","type":"SetVariable","$title":"closeBold","$invalid":false,"settings":{"variable":"n2","value":"{{channelTags@bold.close}}"},"conditions":[]},{"$id":"9149107e-580b-4eb3-8eb9-165b47482575","$typeOfContent":"","type":"SetVariable","$title":"openItalic","$invalid":false,"settings":{"variable":"i1","value":"{{channelTags@italic.open}}"},"conditions":[]},{"$id":"56e47675-bdb9-4f24-bd2e-83ce80b7c6c0","$typeOfContent":"","type":"SetVariable","$title":"closeItalic","$invalid":false,"settings":{"variable":"i2","value":"{{channelTags@italic.close}}"},"conditions":[]},{"$id":"bdb84258-dd8b-45a5-a69c-3a169bebf84e","$typeOfContent":"","type":"SetVariable","$title":"italicValue","$invalid":false,"settings":{"variable":"italicValue","value":"{{channelTags@italic}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-d2f6d32a-8f3d-ae80-2164-881f1467e0ac","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"id":"f4078b7c-fd36-47ec-a5d6-57e5392cddaa","root":false,"$title":"[REQUIREMENTS]","$position":{"top":"162px","left":"1065px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#000000","textColor":"#ffffff","commentsIdList":[]}},"3b904cac-d437-46b1-8b32-fe2450a423d7":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"06df1fa4-e643-463d-96ca-411ca4313aa9","typeOfStateId":"state","$connId":"con_48","$id":"91f8823d-95f0-4e50-b19b-ab291c87fb0d","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    text: 'Para qual de nossas √°reas voc√™ deseja atendimento? ü§î',\n    options: [\"Dermatologia\", \"Odontologia\"],\n    values: [\"Dermatologia\", \"Odontologia\"],\n    description: [],\n    itens: [\n      { name: ['Dermatologia', 'dermato'] },\n      { name: ['Odontologia', 'odonto'] }\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": false\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Certo! Selecione a seguir como eu posso te ajudar hoje. üëá'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = []\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objMenu = {\n      'type': `text/plain`,\n      'content' : geraMenuNumerico(menu)\n    }\n    return objMenu\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"19b44b1c-95c2-4d6f-be90-4d0f0d3f8a6e","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento paciente exibicao","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento paciente exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"092f69c0-91e0-4bf9-9a50-a6217e8ae04d","$typeOfContent":"","type":"ExecuteScript","$title":"destination","$invalid":false,"settings":{"function":"run","source":"function run(validInput) {\n  let input = JSON.parse(validInput).input\n\n  getOptionSelected = (input) => {\n      const optionList = {\n          'Dermatologia': 'dermato',\n          'Odontologia': 'odonto'\n      }\n\n      return optionList[input] || 'ERROR: NO MATCH'\n  }\n\n  return getOptionSelected(input);\n}","inputVariables":["validInputJs"],"outputVariable":"destination","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]},{"$id":"df568ace-ba78-4a52-9b1f-95e2cbbdca70","$typeOfContent":"","type":"SetVariable","$title":"menuOptEscolhida","$invalid":false,"settings":{"variable":"menuOptEscolhida","value":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"ca0780fb-4590-4991-b281-fda1d115b2b6","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento paciente selecao","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento paciente selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"source":"input","comparison":"exists","values":[]}]},{"$id":"66155932-cd0b-4c34-9628-39d25d459551","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento paciente inesperado","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento paciente inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"7e8a0258-b590-4e06-89f5-389601bc1300","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"3b904cac-d437-46b1-8b32-fe2450a423d7","$title":"[S.0.0.4] √Årea Atendimento - Sim","$position":{"top":"1048px","left":"791px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff"}},"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4":{"$contentActions":[{"action":{"$id":"06ead6ca-1a30-4b6e-9f98-2ad6052c7294","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3a6735d0-8420-488b-aaea-cb5858ded83c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3a6735d0-8420-488b-aaea-cb5858ded83c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"71ee7cdb-f07b-4c32-baee-01443f122c9c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7f2b7c9f-dfcf-4ec9-a857-1673c289a939","type":"text/plain","content":"Seja bem-vindo(a)! üë©\n\nPara relembrar, {{n1}}eu sou a Concierge Digital da CarePlus{{n2}}, posso te ajudar com:\n\n‚û°Ô∏è Agendamento;\n‚û°Ô∏è Reagendamento;\n‚û°Ô∏è Informa√ß√µes sobre nossas unidades;\n‚û°Ô∏è Informa√ß√µes sobre nossos servi√ßos;\n‚û°Ô∏è Informa√ß√µes sobre parcerias;\n‚û°Ô∏è e muito mais!","metadata":{}},"$cardContent":{"document":{"id":"7f2b7c9f-dfcf-4ec9-a857-1673c289a939","type":"text/plain","content":"Seja bem-vindo(a)! üë©\n\nPara relembrar, {{n1}}eu sou a Concierge Digital da CarePlus{{n2}}, posso te ajudar com:\n\n‚û°Ô∏è Agendamento;\n‚û°Ô∏è Reagendamento;\n‚û°Ô∏è Informa√ß√µes sobre nossas unidades;\n‚û°Ô∏è Informa√ß√µes sobre nossos servi√ßos;\n‚û°Ô∏è Informa√ß√µes sobre parcerias;\n‚û°Ô∏è e muito mais!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"de21b7df-ee8a-42fa-ab0b-b46ca83d8e68","typeOfStateId":"state","$connId":"con_53","$id":"5ec64ce6-97ae-4f1c-b638-3e9e685bab68","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6146ae07-d367-4b08-9daa-f2a8e356a3fc","$typeOfContent":"","type":"TrackEvent","$title":"retorno exibicao","$invalid":false,"settings":{"extras":{},"category":"retorno exibicao","action":"Exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]}],"$leavingCustomActions":[{"$id":"76f9df67-5706-47f9-baa2-6f6c173a6452","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"de21b7df-ee8a-42fa-ab0b-b46ca83d8e68","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"id":"blip-tag-d2fad23e-0ffd-4ff0-98c5-c3845d204031","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"9ac915cd-e394-4f79-b59e-b1e1a66dcfb4","$title":"[R.0.0.0] Retorno","$position":{"top":"162.571px","left":"639.429px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aebf3f0a-56ac-4466-b042-70cabc54dbf4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{exception@blockId}}","typeOfStateId":"variable","$id":"9fcf28e8-21b8-40dd-8bdd-a90433c7f180","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ad440f48-87c3-4fa8-be77-43d1b0e5b835","$typeOfContent":"","type":"SetVariable","$title":"returnException","$invalid":false,"settings":{"variable":"returnException","value":"false"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"a9bb41ca-9bef-4b1d-a5ca-a3688ef77898","root":false,"$title":"Retorno Exce√ß√£o","$position":{"top":"40.25px","left":"1294px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#eb9694","textColor":"#000000"}},"23db93b0-a85a-41fa-8b51-374afe7e7b68":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Finalizar","$invalid":false,"settings":{"context":{"type":"text/plain","value":"finalizacao"},"address":"{{resource.serviceList@finalizacao}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"23db93b0-a85a-41fa-8b51-374afe7e7b68","root":false,"$title":"[REDIRECT TO] Finaliza√ß√£o","$position":{"top":"163px","left":"2406px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]}},"3b3a1408-7f24-45dc-b193-40fe62bb4fd7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Transbordo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"transbordo"},"address":"{{resource.serviceList@transbordo}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"3b3a1408-7f24-45dc-b193-40fe62bb4fd7","root":false,"$title":"[REDIRECT TO] Transbordo","$position":{"top":"291px","left":"2406px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]}},"ace2c0c3-a756-49af-8d76-fe30066ba1ed":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fbf92afc-a1bf-400c-8e40-22d772bf16fa","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"79147ef0-0323-461d-a640-5f3f410eda53","$typeOfContent":"","type":"ExecuteScript","$title":"goToService","$invalid":false,"settings":{"function":"run","source":"function run(serviceList, destination) {\n\n\tserviceList = JSON.parse(serviceList)\n\t\n\treturn serviceList[destination] || 'ERROR: NO MATCH'\n\n}\n\n","inputVariables":["resource.serviceList","destination"],"outputVariable":"goToService","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"7d31e570-2f6e-4693-9895-eb1669fe5c4d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Service","$invalid":false,"settings":{"context":{"type":"text/plain","value":"boasvindas"},"address":"{{goToService}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false}],"id":"ace2c0c3-a756-49af-8d76-fe30066ba1ed","$title":"[REDIRECT TO] Service","$position":{"top":"421.75px","left":"2406.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]}},"06df1fa4-e643-463d-96ca-411ca4313aa9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d7ada577-de41-4e50-9c12-2bfa85cc86ae","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ace2c0c3-a756-49af-8d76-fe30066ba1ed","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"06df1fa4-e643-463d-96ca-411ca4313aa9","root":false,"$title":"[GO TO] Service","$position":{"top":"1196.71px","left":"790.714px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000"}},"e7599a62-7568-4ff4-930e-b51716e74d60":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"c830acc1-058a-4a84-81c9-5fecab801097","typeOfStateId":"state","$connId":"con_58","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"f80ec11d-a4bc-4632-8af4-86e32ad89c20","typeOfStateId":"state","$connId":"con_63","$id":"3eff8c2b-4003-49f3-a732-5d56cd43750c","conditions":[{"source":"context","comparison":"equals","values":["N√£o","Nao","Menu"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"ffc9c039-0c20-4fd7-88e5-ddbd5186ee65","typeOfStateId":"state","$connId":"con_68","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Sair"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    'text': `Antes de continuarmos, voc√™ precisa conhecer a nossa Pol√≠tica de Privacidade:\n\nüìÑ {{n1}}Pol√≠tica:{{n2}} https://www.careplus.com.br/a-careplus/aviso-de-privacidade\n\n{{n1}}Voc√™ concordar em prosseguir conforme a nossa pol√≠tica?{{n2}}`,\n    'options': [\"Sim\", \"N√£o\"],\n    'values': [\"Sim\", \"N√£o\"],\n    'description': [],\n    'itens': [\n      { name: ['Sim', 'sim', 's', 'ss', 'yes'] },\n      { name: ['N√£o', 'nao', 'no', 'n', 'nn', 'nope'] }\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": true,\n      \"blipchatMenu\": false,\n      \"defaultText\": false\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs + '\\n\\n' + properties.text\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Ol√°! Seja bem-vindo(a) novamente! üòÑ'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = []\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"politica privacidade exibicao","$invalid":false,"settings":{"extras":{},"category":"politica privacidade exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            primeiroNome: false,\n            nomeCompleto: false,\n            email: false,\n            telefone: false,\n            cep: false,\n            data: false,\n            img: false,\n            imgTxt: false,\n            endereco: false,\n            moeda: false,\n            cpf: false,\n            cnpj: false,\n            cpfcnpj: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"politica privacidade selecao","$invalid":false,"settings":{"extras":{},"category":"politica privacidade selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"politica privacidade inesperado","$invalid":false,"settings":{"extras":{},"category":"politica privacidade inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"3d1427d0-c66c-401a-881d-a0a24d2f50c2","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - true","$invalid":false,"settings":{"variable":"privacyPolicy","value":"true"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@input","values":["Sim"]}]},{"$id":"5eaca6c7-e5d3-4488-b214-205878c3a2d5","$typeOfContent":"","type":"TrackEvent","$title":"aceite politica privacidade relatorio","$invalid":false,"settings":{"extras":{},"category":"aceite politica privacidade relatorio","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"f20f9d32-a48c-4b39-a2a6-59b3433cf402","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"e7599a62-7568-4ff4-930e-b51716e74d60","$title":"[S.0.0.1] [MENU] Politica de Priv","$position":{"top":"526px","left":"1069px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f80ec11d-a4bc-4632-8af4-86e32ad89c20":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"e7599a62-7568-4ff4-930e-b51716e74d60","typeOfStateId":"state","$connId":"con_73","$id":"bae0f186-ad1c-4c77-9020-ded27eca92b5","conditions":[{"source":"context","comparison":"equals","values":["Tentar novamente"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"ffc9c039-0c20-4fd7-88e5-ddbd5186ee65","typeOfStateId":"state","$connId":"con_78","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["Finalizar conversa ‚ùå"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"bfae4833-736b-41b5-93d8-98c7aa266cee","typeOfStateId":"state","$connId":"con_83","$id":"bbf9ee28-b216-448e-9a0b-d2acf5bb35b9","conditions":[{"source":"context","comparison":"equals","values":["Voltar"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    'text': `Neste caso, n√£o podemos prosseguir com o seu atendimento. üôÅ\n\nO aceite da pol√≠tica garante a seguran√ßa dos seus dados junto a {{n1}}Care Plus Clinic{{n2}}. üîí\n\n{{n1}}O que deseja fazer agora?{{n2}}`,\n    'options': [\"Tentar novamente\", \"Finalizar conversa ‚ùå\", 'Voltar'],\n    'values': [\"Tentar novamente\", \"Finalizar conversa ‚ùå\", 'Voltar'],\n    'description': [],\n    'itens': [\n      { name: ['Tentar novamente', 'tentar novamente','novamente', 'denovo'] },\n      { name: ['Finalizar conversa ‚ùå', 'finalizar', 'sair', 'encerrar'] },\n      { name: ['Voltar', 'voltar'] },\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": false\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs + '\\n\\n{{n1}}Deseja continuar aceitando nossos termos de privacidade?{{n2}}'\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Ol√°! Seja bem-vindo(a) novamente! üòÑ'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"mensagem para ajudar exibicao","$invalid":false,"settings":{"extras":{},"category":"mensagem para ajudar exibicao","action":"Exibicao"},"conditions":[]},{"$id":"70f6a881-545f-44a8-982c-b131560937e0","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica exibicao","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            primeiroNome: false,\n            nomeCompleto: false,\n            email: false,\n            telefone: false,\n            cep: false,\n            data: false,\n            img: false,\n            imgTxt: false,\n            endereco: false,\n            moeda: false,\n            cpf: false,\n            cnpj: false,\n            cpfcnpj: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica selecao","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica selecao","action":"{{validInputJs@input}}"},"conditions":[]},{"$id":"7ada7392-d912-455f-8396-b1527d5679c2","$typeOfContent":"","type":"TrackEvent","$title":"quick reply comfirmar politica input inesperado","$invalid":false,"settings":{"extras":{},"category":"quick reply comfirmar politica input inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"ab02ac53-2265-4711-b224-d4a10c2d7f14","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - true","$invalid":false,"settings":{"variable":"privacyPolicy","value":"true"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@input","values":["Sim"]}]},{"$id":"06cf4b99-1cfd-46dd-a134-ee755448559e","$typeOfContent":"","type":"SetVariable","$title":"privacyPolicy - false","$invalid":false,"settings":{"variable":"privacyPolicy","value":"false"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@input","values":["N√£o"]}]},{"$id":"a1f8e20c-9e9e-4935-97cc-692fac010eee","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]},{"$id":"9d400bb8-5ef7-44cc-a598-55ce82ad30b0","$typeOfContent":"","type":"TrackEvent","$title":"aceite politica privacidade relatorio","$invalid":false,"settings":{"extras":{},"category":"aceite politica privacidade relatorio","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@input","values":["Sim"]},{"source":"input","comparison":"exists","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"f80ec11d-a4bc-4632-8af4-86e32ad89c20","$title":"[S.0.0.5] [MENU] Pol√≠tica de Priv N√£o","$position":{"top":"730.571px","left":"1180px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ffc9c039-0c20-4fd7-88e5-ddbd5186ee65":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"23db93b0-a85a-41fa-8b51-374afe7e7b68","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"ffc9c039-0c20-4fd7-88e5-ddbd5186ee65","root":false,"$title":"[GO TO] Finaliza√ß√£o","$position":{"top":"636.5px","left":"1441px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]}},"5c234a8d-7660-4245-858f-f8867217bdf1":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"493e83b7-831c-48d6-93fd-4a1477bc59ff","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$id":"a961affc-6c45-4d13-ab47-86175fe83a28","conditions":[{"source":"context","comparison":"equals","values":["WhatsApp"],"variable":"platform"}],"$invalid":false,"stateId":"e7599a62-7568-4ff4-930e-b51716e74d60","$connId":"con_88"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"e7599a62-7568-4ff4-930e-b51716e74d60","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"5c234a8d-7660-4245-858f-f8867217bdf1","root":false,"$title":"[Router] Pol√≠tica de Privacidade","$position":{"top":"413px","left":"1065.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[],"shape":"50% 0 50% 0"}},"35760801-1aa0-4139-981f-485e87d536e3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"31495451-b2e5-4985-bd18-6b788b12598f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1049"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"54bac9bc-3520-4bba-b3f1-aba94f578e68","$typeOfContent":"","type":"ProcessHttp","$title":"Envio e-mail","$invalid":false,"settings":{"headers":{"Authorization":"{{resource.keyRouter}}"},"method":"POST","body":"{\r\n    \"to\": \"issantos%40mideacarrier.com@mailgun.gw.msging.net\",\r\n    \"type\": \"text/plain\",\r\n    \"content\": \"Produto n√£o dispon√≠vel no momento de consulta do cliente no cat√°logo, segue o detalhamento:\\n\\nNome: {{contact.name}};\\nTelefone: {{contact.phoneNumber}};\\nE-mail: {{contact.email}};\\n Produto escolhido: {{produtos}};\\nLoja escolhida: {{loja@nome}}\\n\\nEnviado para {{emailCoordenador}}\",\r\n    \"metadata\": {\r\n        \"mail.subject\": \"{{contact.identity}}: Produto Indispon√≠vel\"\r\n    }\r\n}","uri":"https://http.msging.net/messages","responseStatusVariable":"statusEmail","responseBodyVariable":"responseEmail"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#7762E3","label":"Process HTTP","id":"blip-tag-c7b12f14-9e61-564a-1387-a68670a2fc48","canChangeBackground":false},{"background":"#FF961E","label":"Execute script","id":"blip-tag-66af64ee-7730-269e-00a9-e0536b79c9c6","canChangeBackground":false}],"id":"35760801-1aa0-4139-981f-485e87d536e3","root":false,"$title":"Envio de EMAIL","$position":{"top":"0px","left":"2709px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000","commentsIdList":[]}},"f350d3c6-7c60-403c-a715-91cda0d40f09":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_93","$id":"a5f4b00d-953a-4ba3-b0bf-9741d8c7415a","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"483ace16-9308-4e85-b633-e8832eeed445","typeOfStateId":"state","$connId":"con_98","$id":"336b73fb-d02b-44e0-a83b-b2242947e8c3","conditions":[{"source":"context","comparison":"equals","values":["N√£o"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    'text': `Voc√™ j√° √© nosso paciente? ü§î`,\n    'options': [\"Sim\", \"N√£o\"],\n    'values': [\"Sim\", \"N√£o\"],\n    'description': [],\n    'itens': [\n      { name: ['Sim', 'sim','ss', 'ok', 'claro', 'certo', 'yes'] },\n      { name: ['N√£o', 'nao', 'negativo', 'no', 'nn'] }\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": true,\n      \"blipchatMenu\": false,\n      \"defaultText\": false\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs + '\\n\\n{{n1}}Deseja continuar aceitando nossos termos de privacidade?{{n2}}'\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Ol√°! Seja bem-vindo(a) novamente! üòÑ'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"selecao paciente exibicao","$invalid":false,"settings":{"extras":{},"category":"selecao paciente exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            primeiroNome: false,\n            nomeCompleto: false,\n            email: false,\n            telefone: false,\n            cep: false,\n            data: false,\n            img: false,\n            imgTxt: false,\n            endereco: false,\n            moeda: false,\n            cpf: false,\n            cnpj: false,\n            cpfcnpj: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ea151e15-9370-4b7b-bfb9-ec60aa4da8e1","$typeOfContent":"","type":"SetVariable","$title":"√â Cliente? (client)","$invalid":false,"settings":{"variable":"client","value":"{{validInputJs@input}}"},"conditions":[{"values":["success"],"source":"context","comparison":"equals","variable":"validInputJs@type"}]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"selecao paciente selecao","$invalid":false,"settings":{"extras":{},"category":"selecao paciente selecao","action":"{{validInputJs@input}}"},"conditions":[]},{"$id":"7ada7392-d912-455f-8396-b1527d5679c2","$typeOfContent":"","type":"TrackEvent","$title":"selecao paciente inesperado","$invalid":false,"settings":{"extras":{},"category":"selecao paciente inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"a1f8e20c-9e9e-4935-97cc-692fac010eee","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false}],"id":"f350d3c6-7c60-403c-a715-91cda0d40f09","$title":"[S.0.0.3] J√° √© paciente","$position":{"top":"879px","left":"958px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"c830acc1-058a-4a84-81c9-5fecab801097":{"$contentActions":[{"action":{"$id":"cf0c32a5-26c7-4059-84fc-ba8517e6b3e5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"29f433da-3ddb-4a29-a9d4-4432f06ec69d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"29f433da-3ddb-4a29-a9d4-4432f06ec69d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"55ec6b55-f441-45a2-9729-448326bcc5fc","$typeOfContent":"text","type":"SendMessage","settings":{"id":"da4d3e7a-b670-410b-b922-cda52be9e0ab","type":"text/plain","content":"Um aviso importante! üôã‚Äç‚ôÄÔ∏è\n\nVoc√™ pode falar com a nossa equipe de atendimento a qualquer momento digitando {{n1}}‚Äúatendimento‚Äù{{n2}}.","metadata":{}},"$cardContent":{"document":{"id":"da4d3e7a-b670-410b-b922-cda52be9e0ab","type":"text/plain","content":"Um aviso importante! üôã‚Äç‚ôÄÔ∏è\n\nVoc√™ pode falar com a nossa equipe de atendimento a qualquer momento digitando {{n1}}‚Äúatendimento‚Äù{{n2}}."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"15db5d0c-2df5-47ed-a934-0c5d29f3102b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"f350d3c6-7c60-403c-a715-91cda0d40f09","typeOfStateId":"state","$connId":"con_103","$id":"85c4e030-87d4-4826-9891-f3d61df2d878","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"44b08f42-997d-431a-b46f-b718a2c57b50","$typeOfContent":"","type":"TrackEvent","$title":"aviso termo atendimento exibicao","$invalid":false,"settings":{"extras":{},"category":"aviso termo atendimento exibicao","action":"exibicao"},"conditions":[]},{"$id":"087188ae-3635-4aa8-9859-ba508efebfb2","$typeOfContent":"","type":"SetVariable","$title":"return - true","$invalid":false,"settings":{"variable":"return","value":"true"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f350d3c6-7c60-403c-a715-91cda0d40f09","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"c830acc1-058a-4a84-81c9-5fecab801097","root":false,"$title":"[S.0.0.2] Aviso importante - Sim","$position":{"top":"738px","left":"956px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"de21b7df-ee8a-42fa-ab0b-b46ca83d8e68":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"1aa55fa9-6b42-49b9-b66a-77646d137c60","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"38195433-bacb-46d4-acb9-04cc0c1c14e5","typeOfStateId":"state","$connId":"con_108","$id":"8fce31e7-7db5-4c91-be58-af2b7659dea0","conditions":[{"source":"context","comparison":"equals","values":["DADOS COMPLETOS"],"variable":"validaRetorno"}],"$invalid":false},{"stateId":"461534c4-b5fa-4a2c-9808-824b4f124fa0","typeOfStateId":"state","$connId":"con_113","$id":"e13a8c55-b1b1-4ac0-9260-b92eb0c5b655","conditions":[{"source":"context","comparison":"startsWith","values":["DADOS AUSENTES"],"variable":"validaRetorno"},{"values":["Sim"],"source":"context","comparison":"equals","variable":"client"},{"values":[],"source":"context","comparison":"exists","variable":"lastStateWithContent"}],"$invalid":false},{"stateId":"c52876d4-c7b2-478e-a653-b7af71e3f92e","typeOfStateId":"state","$connId":"con_118","$id":"1663bb8d-7035-42fc-9721-6ac87862e0f3","conditions":[{"source":"context","comparison":"startsWith","values":["DADOS AUSENTES"],"variable":"validaRetorno"},{"values":["N√£o"],"source":"context","comparison":"equals","variable":"client"}],"$invalid":false},{"stateId":"3b904cac-d437-46b1-8b32-fe2450a423d7","typeOfStateId":"state","$connId":"con_123","$id":"79501cbc-a5d2-474c-98ef-fdc56a65f1c7","conditions":[{"source":"context","comparison":"startsWith","values":["DADOS AUSENTES"],"variable":"validaRetorno"},{"values":["Sim"],"source":"context","comparison":"equals","variable":"client"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"11394b65-b4fd-4493-9f3b-ad0cde68e311","$typeOfContent":"","type":"ExecuteScript","$title":"ValidaRetorno","$invalid":false,"settings":{"function":"run","source":"function run(nome, cpf, email, dataNascimento, telefone) {\n    try {\n        // Valida se o usu√°rio preencheu todos os dados        \n        if (!nome || nome == '' || nome == undefined || nome == 'undefined' || nome == 'null' || nome == null) {\n            return 'DADOS AUSENTES: NOME';\n        } else if (!cpf || cpf == '' || cpf == undefined || cpf == 'undefined' || cpf == 'null' || cpf == null) {\n            return 'DADOS AUSENTES: CPF';\n        } else if (!email || email == '' || email == undefined || email == 'undefined' || email == 'null' || email == null) {\n            return 'DADOS AUSENTES: EMAIL';\n        } else if (!dataNascimento || dataNascimento == '' || dataNascimento == undefined || dataNascimento == 'undefined' || dataNascimento == 'null' || dataNascimento == null) {\n            return 'DADOS AUSENTES: DATA NASCIMENTO';\n        } else if (!telefone || telefone == '' || telefone == undefined || telefone == 'undefined' || telefone == 'null' || telefone == null) {\n            return 'DADOS AUSENTES: TELEFONE';\n        } else {\n            // dados completos, ir para retorno padr√£o\n            return 'DADOS COMPLETOS'\n        }\n    } catch (e) {\n        // Aqui vai cair quando ultimoBlocoOndeParou n√£o existe, ou outro erro desconhecido.        \n        return 'ERRO DE SCRIPT';\n    }\n}","inputVariables":["contact.name","contact.extras.CPF","contact.email","contact.extras.DataDeNascimento","contact.phoneNumber"],"outputVariable":"validaRetorno","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"38195433-bacb-46d4-acb9-04cc0c1c14e5","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false}],"id":"de21b7df-ee8a-42fa-ab0b-b46ca83d8e68","root":false,"$title":"Valida dados coletados","$position":{"top":"306px","left":"639px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"shape":"50% 0 50% 0","backgroundColor":"#ffb74d","textColor":"#000000"}},"38195433-bacb-46d4-acb9-04cc0c1c14e5":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"98ce3a9f-aea4-4d95-9b05-c8abf9e91532","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"f350d3c6-7c60-403c-a715-91cda0d40f09","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"38195433-bacb-46d4-acb9-04cc0c1c14e5","root":false,"$title":"[GO TO] S.0.0.3","$position":{"top":"296px","left":"319px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000"}},"483ace16-9308-4e85-b633-e8832eeed445":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"00950521-1a51-45c9-af57-2fd71faf8e2e","typeOfStateId":"state","$connId":"con_128","$id":"91f8823d-95f0-4e50-b19b-ab291c87fb0d","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"values":["DADOS COMPLETOS"],"source":"context","comparison":"notEquals","variable":"validaRetorno"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    text: 'Para qual de nossas √°reas voc√™ deseja atendimento? ü§î',\n    options: [\"Dermatologia\", \"Odontologia\"],\n    values: [\"Dermatologia\", \"Odontologia\"],\n    description: [],\n    itens: [\n      { name: ['Dermatologia', 'dermato'] },\n      { name: ['Odontologia', 'odonto'] }\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": true\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Certo! Selecione a seguir como eu posso te ajudar hoje. üëá'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = []\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objMenu = {\n      'type': `text/plain`,\n      'content' : geraMenuNumerico(menu)\n    }\n    return objMenu\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"19b44b1c-95c2-4d6f-be90-4d0f0d3f8a6e","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento nao paciente exibicao","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento nao paciente exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"df568ace-ba78-4a52-9b1f-95e2cbbdca70","$typeOfContent":"","type":"SetVariable","$title":"menuOptEscolhida","$invalid":false,"settings":{"variable":"menuOptEscolhida","value":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"ca0780fb-4590-4991-b281-fda1d115b2b6","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento nao paciente selecao","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento nao paciente selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"source":"input","comparison":"exists","values":[]}]},{"$id":"66155932-cd0b-4c34-9628-39d25d459551","$typeOfContent":"","type":"TrackEvent","$title":"selecao area atendimento nao paciente inesperado","$invalid":false,"settings":{"extras":{},"category":"selecao area atendimento nao paciente inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"7e8a0258-b590-4e06-89f5-389601bc1300","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"483ace16-9308-4e85-b633-e8832eeed445","$title":"[S.0.0.6] √Årea Atendimento - N√£o","$position":{"top":"1053.29px","left":"1105.86px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]},"isAiGenerated":false},"00950521-1a51-45c9-af57-2fd71faf8e2e":{"$contentActions":[{"action":{"$id":"7a7a7fa8-1c88-47e2-952e-a68ff08a3513","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"53e495c4-f82e-44d2-b8ad-f846e183139a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"53e495c4-f82e-44d2-b8ad-f846e183139a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"f07954f4-8273-4e3e-872a-15911102d693","$typeOfContent":"text","type":"SendMessage","settings":{"id":"499220a0-24f2-460c-9cbe-dcc7759e091e","type":"text/plain","content":"Agora, {{n1}}vou precisar coletar alguns dados para realizar o seu cadastro neste canal.{{n2}} üòâ\n\n‚û°Ô∏è No total s√£o seis perguntas.\n‚û°Ô∏è N√£o se preocupe! Os dados ser√£o coletados somente uma vez.","metadata":{}},"$cardContent":{"document":{"id":"499220a0-24f2-460c-9cbe-dcc7759e091e","type":"text/plain","content":"Agora, {{n1}}vou precisar coletar alguns dados para realizar o seu cadastro neste canal.{{n2}} üòâ\n\n‚û°Ô∏è No total s√£o seis perguntas.\n‚û°Ô∏è N√£o se preocupe! Os dados ser√£o coletados somente uma vez."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"496253ce-b55a-485f-af30-597a09a9f14c","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"5834d714-7d4a-4fdc-8b71-1d01ec4a0ad1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7257c2d9-e63c-4091-b05a-32da27a38046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"7257c2d9-e63c-4091-b05a-32da27a38046","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"subflow:d541bbcf-12b4-419f-9780-83838c1265c5","typeOfStateId":"state","$connId":"con_133","$id":"52423549-1d5d-4d56-b4ab-7cf468f0b625","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0ac45c8c-38e8-45df-b9e6-858ee1ca6d33","$typeOfContent":"","type":"TrackEvent","$title":"aviso quantidade perguntas exibicao","$invalid":false,"settings":{"extras":{},"category":"aviso quantidade perguntas exibicao","action":"exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"00950521-1a51-45c9-af57-2fd71faf8e2e","root":false,"$title":"[S.0.0.7]","$position":{"top":"1215.71px","left":"1105.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"12196e65-94f0-4bcb-9f06-d886a7ce373c":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual o seu n¬∞ de telefone?{{n2}} üìû\n\nüü¶ Digite conforme o exemplo a seguir: 31 9 9596 7894`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            telefone: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone input","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Telefone","$invalid":false,"settings":{"extras":{},"phoneNumber":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"12196e65-94f0-4bcb-9f06-d886a7ce373c","$title":"[S.0.0.0] [INPUT] [CONTENT] Telefone","$position":{"top":"0px","left":"2895.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"461534c4-b5fa-4a2c-9808-824b4f124fa0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"26672a1b-08a8-431b-a80c-094e07bab486","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"af2f7070-ce02-44f3-b96c-567ab0237ab6","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"[goToBlock] retorno dados ausentes"},"address":"{{lastStateWithContent@service}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"461534c4-b5fa-4a2c-9808-824b4f124fa0","root":false,"$title":"[GO TO] Valida Cliente","$position":{"top":"468px","left":"469px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"c52876d4-c7b2-478e-a653-b7af71e3f92e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"db9a9f4a-7121-4436-aabf-570cb4dcddab","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{lastStateWithContent@id}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"c52876d4-c7b2-478e-a653-b7af71e3f92e","root":false,"$title":"[GO TO] N√£o Cliente","$position":{"top":"465.75px","left":"787px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000"}},"aba23a3e-9882-4701-afd6-600b21babfdf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d7ada577-de41-4e50-9c12-2bfa85cc86ae","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ace2c0c3-a756-49af-8d76-fe30066ba1ed","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"aba23a3e-9882-4701-afd6-600b21babfdf","root":false,"$title":"[GO TO] Service [1]","$position":{"top":"1093.89px","left":"1768.89px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#fff9c4","textColor":"#000000","commentsIdList":[]},"isAiGenerated":false},"d8e3a838-b4c4-471e-980b-12d9187b185b":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"aba23a3e-9882-4701-afd6-600b21babfdf","typeOfStateId":"state","$connId":"con_138","$id":"91f8823d-95f0-4e50-b19b-ab291c87fb0d","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run(hideInputText, sentenceOtherMistakesJs, returnJs) {\n\n  let properties = {\n    text: `{{n1}}Como posso te ajudar hoje?{{n2}} üòä\n\nüü¶ Digite o n√∫mero de uma das op√ß√µes a seguir:\n\n{{n1}}1.{{n2}} Quero agendar minha primeira consulta\n{{n1}}2.{{n2}} Quero conhecer as unidades e seus diferenciais\n{{n1}}3.{{n2}} Quero saber mais sobre os servi√ßos oferecidos\n{{n1}}4.{{n2}} Quero saber sobre servi√ßos online e facilidades`,\n    options: [\"Falar com atendente\", \"Finalizar conversa ‚ùå\"],\n    values: [\"Falar com atendente\", \"Finalizar conversa ‚ùå\"],\n    description: [],\n    itens: [\n      { name: ['Quero agendar minha primeira consulta'] },\n      { name: ['Quero conhecer as unidades e seus diferenciais'] },\n      { name: ['Quero saber mais sobre os servi√ßos oferecidos'] },\n      { name: ['Quero saber sobre servi√ßos online e facilidades'] },\n      { name: ['Falar com atendente', 'atendente', 'falar'] },\n      { name: ['Finalizar conversa ‚ùå', 'finalizar', 'sair', 'encerrar'] }\n    ],\n    menuScope: {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": true\n    }\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Exibe mensagem e exce√ß√£o no MENU\n  // if (hideInputText == 'true' || hideInputText == true) {\n  //   properties.text = sentenceOtherMistakesJs\n  // } else {\n  //   // Exibe mensagem de retorno\n  //   // if (returnJs == 'true' || returnJs == true) {\n  //   //   properties.text = 'Certo! Selecione a seguir como eu posso te ajudar hoje. üëá'\n  //   // }\n  // }\n  ////////////////////////////////////////////////////////////////////////////////\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = []\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${i + 1}`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":["hideInputText","sentenceOtherMistakesJs","return"],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objMenu = {\n      'type': `text/plain`,\n      'content' : geraMenuNumerico(menu)\n    }\n    return objMenu\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      ... menu.menuScope,\n      \"platform\": platform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"19b44b1c-95c2-4d6f-be90-4d0f0d3f8a6e","$typeOfContent":"","type":"TrackEvent","$title":"menu principal dermatologia nao paciente exibicao","$invalid":false,"settings":{"extras":{},"category":"menu principal dermatologia nao paciente exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO MENU HIBRIDO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c145f280-a16c-4442-b8cc-5d2946cb7715","$typeOfContent":"","type":"ExecuteScript","$title":"destination","$invalid":false,"settings":{"function":"run","source":"function run(validInput) {\n  let input = JSON.parse(validInput).input\n\n  getOptionSelected = (input) => {\n      const optionList = {\n          'Quero agendar minha primeira consulta': 'dermato_agendar_primeira_consulta',\n          'Quero conhecer as unidades e seus diferenciais': 'dermato_conhecer_as_unidades',\n          'Quero saber mais sobre os servi√ßos oferecidos': 'dermato_saber_sobre_servi√ßos_oferecidos',\n          'Quero saber sobre servi√ßos online e facilidades': 'dermato_saber_sobre_servi√ßos_online',\n          'Falar com atendente': 'transbordo',\n          'Finalizar conversa ‚ùå': 'finalizacao',\n      }\n\n      return optionList[input] || 'ERROR: NO MATCH'\n  }\n\n  return getOptionSelected(input);\n}","inputVariables":["validInputJs"],"outputVariable":"destination","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]},{"$id":"74a21830-32af-4d9b-a82c-574bf49eb04a","$typeOfContent":"","type":"SetVariable","$title":"menuDermoOdonto","$invalid":false,"settings":{"variable":"menuDermoOdonto","value":"{{validInputJs@input}}"},"conditions":[{"values":["success"],"source":"context","comparison":"equals","variable":"validInputJs@type"}]},{"$id":"ca0780fb-4590-4991-b281-fda1d115b2b6","$typeOfContent":"","type":"TrackEvent","$title":"menu principal dermatologia nao paciente selecao","$invalid":false,"settings":{"extras":{},"category":"menu principal dermatologia nao paciente selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"source":"input","comparison":"exists","values":[]}]},{"$id":"66155932-cd0b-4c34-9628-39d25d459551","$typeOfContent":"","type":"TrackEvent","$title":"menu principal dermatologia nao paciente inesperado","$invalid":false,"settings":{"extras":{},"category":"menu principal dermatologia nao paciente inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"7e8a0258-b590-4e06-89f5-389601bc1300","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"d8e3a838-b4c4-471e-980b-12d9187b185b","$title":"[S.0.0.0] MENU Principal","$position":{"top":"955.556px","left":"1768.44px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff","commentsIdList":[]},"isAiGenerated":false},"8524011e-7311-49f4-a54a-59c72724235d":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a8147e1a-91dd-4497-8864-7548156e6ea3","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-3bd66a4b-ba56-e3ff-bda5-086e2b1011ab","canChangeBackground":false},{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-d2f6d32a-8f3d-ae80-2164-881f1467e0ac","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#3A4A65","label":"GO TO","id":"blip-tag-2950aeab-5ffc-4bfb-8c0d-5677eb652059","canChangeBackground":false}],"id":"8524011e-7311-49f4-a54a-59c72724235d","root":false,"$title":"TAGS","$position":{"top":"0px","left":"423.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"15015b8f-d406-4f25-b7e6-9d6c10f3ae39":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a323a0a9-8a78-4591-a967-3ccac7a47902","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d8e3a838-b4c4-471e-980b-12d9187b185b","typeOfStateId":"state","$connId":"con_143","$id":"e7e449ea-3bd5-4824-a1da-0e11199ee369","conditions":[{"source":"input","comparison":"contains","values":["S.0.1.5"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"15015b8f-d406-4f25-b7e6-9d6c10f3ae39","root":false,"$title":"Retorno Menu Principal","$position":{"top":"411.333px","left":"1767.11px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:d541bbcf-12b4-419f-9780-83838c1265c5":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"7d1c360c-9ea2-4550-a3a6-24a5fc6522be","type":"text/plain","textContent":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d8e3a838-b4c4-471e-980b-12d9187b185b","typeOfStateId":"state","$connId":"con_148","$id":"99e88202-4494-4f34-9e5f-0343588a4f6a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9388b6bc-bdcb-4428-8cba-41ccc1384e62","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:d541bbcf-12b4-419f-9780-83838c1265c5","action":"Entering subflow - subflow:d541bbcf-12b4-419f-9780-83838c1265c5","subflowDefaultAction":true},"$invalid":false},{"$id":"7b7de6ab-6650-415a-b6a0-a6458b1a1574","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:d541bbcf-12b4-419f-9780-83838c1265c5"},"subflowDefaultAction":true},"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"subflow:d541bbcf-12b4-419f-9780-83838c1265c5","root":false,"shortNameOfSubflow":"capturadedados","$imageUri":"","$title":"Captura de dados","$position":{"top":"1345px","left":"1080px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a345360d-6162-41ff-8f90-ecb7167ea505":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ee681f32-1b8d-4c51-a978-089197beeab5","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c922b49c-8b40-467d-b5a4-319977980f1f","typeOfStateId":"state","$connId":"con_153","$id":"5e08e0de-9f8a-44b7-a231-7858246f90b5","conditions":[{"source":"context","comparison":"equals","values":["200","201"],"variable":"statusIdentity"},{"values":["200","201","202"],"source":"context","comparison":"equals","variable":"envioStatus"},{"values":["200","201"],"source":"context","comparison":"equals","variable":"direcionamentoStatus"},{"values":["200","201"],"source":"context","comparison":"equals","variable":"direcionamentoStatus"},{"values":["200","201"],"source":"context","comparison":"equals","variable":"blocoDesejadoStatus"},{"values":["200","201"],"source":"context","comparison":"equals","variable":"variaveisStatus"}],"$invalid":false},{"stateId":"ad241df9-dc4c-4236-86e7-2477eef7bd44","typeOfStateId":"state","$connId":"con_158","$id":"10834346-42ec-446c-9763-1dc578af5101","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2a14541f-6088-4d0a-837e-82fbdf2817f0","$typeOfContent":"","type":"ProcessHttp","$title":"Envio Mensagem","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"Key YXJhdWpvd2hhdHNhcHByb3V0ZXI6RjBKcjdmYlVGenN2YW5YR3V5VWg="},"method":"POST","body":"{\n    \"id\": \"1{{random.guid}}\",\n    \"to\": \"{{alternativeAccount}}\",\n    \"type\": \"application/json\",\n    \"content\":{\n  \"type\": \"template\",\n  \"template\": {\n    \"language\": {\n      \"policy\": \"deterministic\",\n      \"code\": \"pt_BR\"\n    },\n    \"name\": \"{{resource.activeMessages@templates.cliente_com_optin}}\",\n    \"components\": [\n      {\n        \"type\": \"body\",\n        \"parameters\": [\n          {\n            \"text\": \"{{contact.extras.nomeCliente}}\",\n            \"type\": \"text\"\n          }\n        ]\n      }\n    ]\n  }\n}\n}","uri":"https://drogariaaraujo.http.msging.net/messages","responseStatusVariable":"envioStatus","responseBodyVariable":"envioRes"},"conditions":[]},{"$id":"f7e1ac6c-ad8e-4c14-8928-5b19d668130b","$typeOfContent":"","type":"ProcessHttp","$title":"direcionamento","$invalid":false,"settings":{"headers":{"Authorization":"Key YXJhdWpvd2hhdHNhcHByb3V0ZXI6RjBKcjdmYlVGenN2YW5YR3V5VWg=","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"{{random.guid}}\",\n    \"to\": \"postmaster@msging.net\",\n    \"method\": \"set\",\n    \"uri\": \"/contexts/{{alternativeAccount}}/master-state\",\n    \"type\": \"text/plain\",\n    \"resource\": \"araujofluxonotificacao@msging.net\"\n}","uri":"https://drogariaaraujo.http.msging.net/commands","responseStatusVariable":"direcionamentoStatus","responseBodyVariable":"direcionamentoRes"},"conditions":[]},{"$id":"21b51bfe-f0a4-4b35-9257-2bc54df9d50d","$typeOfContent":"","type":"ProcessHttp","$title":"bloco desejado","$invalid":false,"settings":{"headers":{"Authorization":"Key YXJhdWpvd2hhdHNhcHByb3V0ZXI6RjBKcjdmYlVGenN2YW5YR3V5VWg=","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"{{random.guid}}\",\n    \"to\": \"postmaster@msging.net\",\n    \"method\": \"set\",\n    \"uri\": \"/contexts/{{alternativeAccount}}/stateid@9545f346-13eb-472e-9000-9dfd18ff1e44\",\n    \"type\": \"text/plain\",\n    \"resource\": \"9f8f9634-a8bc-4459-8d4d-7a8f30e17506\"\n}","uri":"https://drogariaaraujo.http.msging.net/commands","responseStatusVariable":"blocoDesejadoStatus","responseBodyVariable":"blocoDesejadoRes"},"conditions":[]},{"$id":"9e0bfe35-bdc4-4397-bb56-4114baa6c413","$typeOfContent":"","type":"ProcessHttp","$title":"atualizar vari√°veis","$invalid":false,"settings":{"headers":{"Authorization":"Key YXJhdWpvd2hhdHNhcHByb3V0ZXI6RjBKcjdmYlVGenN2YW5YR3V5VWg=","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"{{random.guid}}\",\n    \"method\": \"merge\",\n    \"type\": \"application/vnd.lime.contact+json\",\n    \"uri\": \"/contacts\",\n    \"resource\": {\n        \"identity\":\"{{alternativeAccount}}\",\n        \"name\": \"{{contact.extras.nomeCliente}}\",\n        \"extras\": {\n            \"medicamento\": \"{{medicamento}}\",\n            \"matricula\": \"{{matricula}}\",\n            \"loja\": \"{{loja}}\",\n            \"notificacao\":\"transbordoprovisorio\",\n            \"template\":\"{{resource.activeMessages@templates.cliente_com_optin}}\"\n        }\n    }\n}","uri":"https://drogariaaraujo.http.msging.net/commands","responseStatusVariable":"variaveisStatus","responseBodyVariable":"variaveisRes"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#7762E3","label":"Http Request","id":"blip-tag-d78f5258-83e9-d9cc-5158-0e059f1495cc","canChangeBackground":false},{"background":"#21CC79","label":"Tracking","id":"blip-tag-c395c2e1-cbfe-f40f-a7ee-5e556944735d","canChangeBackground":false}],"id":"a345360d-6162-41ff-8f90-ecb7167ea505","root":false,"$title":"Envio Mensagem Ativa","$position":{"top":"3.71429px","left":"3211.14px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000"}},"c922b49c-8b40-467d-b5a4-319977980f1f":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a8d3238a-8c31-4282-b47b-edecc22a2736","type":"text/plain","textContent":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"c922b49c-8b40-467d-b5a4-319977980f1f","root":false,"$title":"sucesso","$position":{"top":"164.286px","left":"3151.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ad241df9-dc4c-4236-86e7-2477eef7bd44":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"2faea334-2021-402b-a18a-281965b97e8e","type":"text/plain","textContent":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"ad241df9-dc4c-4236-86e7-2477eef7bd44","root":false,"$title":"erro api","$position":{"top":"161.143px","left":"3348.29px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db0f28a1-1a05-47fb-a802-625823b7971f":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"31495451-b2e5-4985-bd18-6b788b12598f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"54c9a1b3-99f4-43e8-9b7c-c8d4f6010efe","$typeOfContent":"","type":"ExecuteScript","$title":"ID E-mail","$invalid":false,"settings":{"function":"run","source":"function run (){\n    return (parseInt(Math.random() * 10 ** 8))\n}","inputVariables":[],"outputVariable":"idEmail","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"54bac9bc-3520-4bba-b3f1-aba94f578e68","$typeOfContent":"","type":"ProcessHttp","$title":"Envio e-mail","$invalid":false,"settings":{"headers":{"Authorization":"{{resource.keyRouter}}"},"method":"POST","body":"{\r\n    \"to\": \"{{regiao@email}}, {{regiao@emailGerente}}, {{regiao@emailCopiaTodos}}@mailgun.gw.msging.net\",\r\n    \"type\": \"text/plain\",\r\n    \"content\": \"Ol√°, voc√™ recebeu uma solicita√ß√£o de atendimento de {{firstName}}.\\n\\nSeguem dados:\\n\\nNome completo: {{nomeComp}}\\nE-mail: {{email}}\\nTelefone: {{telefone}}\",\r\n    \"metadata\": {\r\n        \"mail.subject\": \"{{idEmail}}: Nova solicita√ß√£o de {{firstName}}\"\r\n    }\r\n}","uri":"https://msging.net/messages","responseStatusVariable":"statusEmail","responseBodyVariable":"responseEmail"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#7762E3","label":"Process HTTP","id":"blip-tag-c7b12f14-9e61-564a-1387-a68670a2fc48","canChangeBackground":false},{"background":"#FF961E","label":"Execute script","id":"blip-tag-66af64ee-7730-269e-00a9-e0536b79c9c6","canChangeBackground":false}],"id":"db0f28a1-1a05-47fb-a802-625823b7971f","root":false,"$title":"API - Envio de EMAIL","$position":{"top":"157px","left":"2704px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#880e4f","textColor":"#ffffff","commentsIdList":[],"shape":"50% 0 50% 0"},"isAiGenerated":false},"bfae4833-736b-41b5-93d8-98c7aa266cee":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fbf92afc-a1bf-400c-8e40-22d772bf16fa","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7d31e570-2f6e-4693-9895-eb1669fe5c4d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] MENU ANTERIOR","$invalid":false,"settings":{"context":{"type":"text/plain","value":"voltar ao menu"},"address":"{{lastStateWithMenu@service}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false}],"id":"bfae4833-736b-41b5-93d8-98c7aa266cee","$title":"[REDIRECT TO] Voltar ao menu anterior","$position":{"top":"562.429px","left":"2406.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]},"isAiGenerated":false},"c0dc0550-84da-4028-ba67-457020c2a070":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ceccc324-c654-407d-b5b3-bbebd678b003","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{lastStateWithMenu@previousId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"c0dc0550-84da-4028-ba67-457020c2a070","root":false,"$title":"Voltar ao Menu","$position":{"top":"161px","left":"1612px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b476da42-cd34-4d21-9001-5e0bc0d470fc","$typeOfContent":"","type":"ExecuteScript","$title":"SET lastStateWithContent","$invalid":false,"settings":{"function":"run","source":"function run(stateName, stateId, previousStateName = null, previousStateId = null, service) {\n    return {\n        name: stateName,\n        id: stateId,\n        previousName: previousStateName,\n        previousId: previousStateId,\n        service: service\n    }\n}","inputVariables":["state.name","state.id","state.previous.name","state.previous.id","service"],"outputVariable":"lastStateWithContent"},"conditions":[{"$$hashKey":"object:17508","values":["[CONTENT]"],"source":"context","comparison":"contains","variable":"state.name"}]},{"$id":"478a4133-dea6-444f-b7fd-5dc9e1325d09","$typeOfContent":"","type":"ExecuteScript","$title":"SET lastStateWithMenu","$invalid":false,"settings":{"function":"run","source":"function run(stateName, stateId, previousStateName = null, previousStateId = null, service) {\n    return {\n        name: stateName,\n        id: stateId,\n        previousName: previousStateName,\n        previousId: previousStateId,\n        service: service\n    }\n}","inputVariables":["state.nam","state.id","state.previous.name","state.previous.id","service"],"outputVariable":"lastStateWithMenu"},"conditions":[{"$$hashKey":"object:2004","values":["[MENU]"],"source":"context","comparison":"contains","variable":"state.name"}]}],"$leavingCustomActions":[{"$id":"6599441d-0eaa-401e-b8af-549895c6e7f8","$typeOfContent":"","type":"ExecuteScript","$title":"SET lastStateWithInput","$invalid":false,"settings":{"function":"run","source":"function run(stateName, stateId, previousStateName = null, previousStateId = null, service) {\n    return {\n        name: stateName,\n        id: stateId,\n        previousName: previousStateName,\n        previousId: previousStateId,\n        service: service\n    }\n}","inputVariables":["state.name","state.id","state.previous.name","state.previous.id","service"],"outputVariable":"lastStateWithInput"},"conditions":[{"$$hashKey":"object:18509","values":["[INPUT]"],"source":"context","comparison":"contains","variable":"state.name"}]},{"$id":"0651141f-1ba6-487d-88e3-c6f625e9e566","$typeOfContent":"","type":"SetVariable","$title":"hideInputText [false]","$invalid":false,"settings":{"variable":"hideInputText","value":"false"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflows":[{"shortName":"capturadedados","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"892fb13a-ee12-41d9-aca2-fecfaff542ec","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59a73dcc-1d95-4f55-8ced-06a546482639","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"03c0de05-e447-4c8d-aad9-8065f0e25e7b","$connId":"con_3","$invalid":false,"typeOfStateId":"state"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"59a73dcc-1d95-4f55-8ced-06a546482639","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"onboarding","root":true,"$title":"In√≠cio","$position":{"top":"238px","left":"641px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"1b9cc8bc-5aec-41c2-8aa9-8e12c08fa5dd","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"36b68048-3089-4f8b-9863-a6332a041dc0","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"fa03c64c-bb36-47dd-8f0b-7c02de346ae7","$connId":"con_8","$invalid":false,"typeOfStateId":"state"}],"$enteringCustomActions":[{"$id":"08fa2486-c99b-41a6-a4e5-8724510d1fe6","$typeOfContent":"","type":"ExecuteScript","$title":"exception","$invalid":false,"settings":{"function":"run","source":"function run(previousState, typeInput, previousId) {\n    try {\n        typeInput = JSON.parse(typeInput).input\n        let idFormated = previousState.split(' ');\n        idFormated = idFormated[0].replace(/\\[/g,'').replace(/\\]/g,'').replace(/\\./g,'');\n        const exception = {\n            id: `${idFormated}`,\n            input: '{{input.content}}',\n            redirectMenu: `${typeInput}`,\n            blockId: previousId\n        }\n        return exception\n    }\n    catch (e) {\n        return 'error'\n    }\n}","inputVariables":["state.previous.name","validInputJs","state.previous.id"],"outputVariable":"exception","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"fallback","$title":"Exce√ß√µes","$position":{"top":"238px","left":"1309px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5f0148d6-84f3-4cef-8a18-e42a43d186bd","type":"text/plain"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"Fim","$position":{"top":"1233px","left":"640px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5646ddb-a50b-4729-a526-86b69f4b7ab9":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"ae7d854b-74e0-4633-b3c9-8106b51b130f","typeOfStateId":"state","$connId":"con_13","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta cpf input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta cpf input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual o seu CPF?{{n2}} üî¢\n\nüü¶ Digite 11 n√∫meros.`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            cpf: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta cpf input","$invalid":false,"settings":{"extras":{},"category":"coleta cpf input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta cpf inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta cpf inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Extras: CPF","$invalid":false,"settings":{"extras":{"CPF":"{{validInputJs@input}}"}},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"d5646ddb-a50b-4729-a526-86b69f4b7ab9","$title":"[S.0.0.9] [INPUT] [CONTENT] CPF","$position":{"top":"492px","left":"638px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"ae7d854b-74e0-4633-b3c9-8106b51b130f":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"bc88cabf-69c5-4e7f-9b6d-4c858cf29bd0","typeOfStateId":"state","$connId":"con_18","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta email input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta email input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual o seu e-mail?{{n2}} üìß\n\nüü¶ Digite conforme o exemplo a seguir: chatbot@dentalprime.com.br`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            email: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta email input","$invalid":false,"settings":{"extras":{},"category":"coleta email input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta email inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta email inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Email","$invalid":false,"settings":{"extras":{},"email":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"ae7d854b-74e0-4633-b3c9-8106b51b130f","$title":"[S.0.1.0] [INPUT] [CONTENT] Email","$position":{"top":"635px","left":"639px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"bc88cabf-69c5-4e7f-9b6d-4c858cf29bd0":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"ee370300-95f4-4e21-b933-401599307f85","typeOfStateId":"state","$connId":"con_23","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta data nascimento input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta data nascimento input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual a sua data de nascimento?{{n2}} üìÖ\n\nüü¶ Digite conforme o exemplo a seguir: 30/09/2000`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta data nascimento input","$invalid":false,"settings":{"extras":{},"category":"coleta data nascimento input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta data nascimento inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta data nascimento inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Extras: Data de Nascimento","$invalid":false,"settings":{"extras":{"DataDeNascimento":"{{validInputJs@input}}"}},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"bc88cabf-69c5-4e7f-9b6d-4c858cf29bd0","$title":"[S.0.1.1] [INPUT] [CONTENT] Data de Nascimento","$position":{"top":"779px","left":"641px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"ee370300-95f4-4e21-b933-401599307f85":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"f44ff8c2-36a0-4d21-bcfd-cededcab8543","typeOfStateId":"state","$connId":"con_28","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual o seu n¬∞ de telefone?{{n2}} üìû\n\nüü¶ Digite conforme o exemplo a seguir: 31 9 9596 7894`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            telefone: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone input","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta numero telefone inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta numero telefone inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Telefone","$invalid":false,"settings":{"extras":{},"phoneNumber":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"ee370300-95f4-4e21-b933-401599307f85","$title":"[S.0.1.2] [INPUT] [CONTENT] Telefone","$position":{"top":"946px","left":"637px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"f44ff8c2-36a0-4d21-bcfd-cededcab8543":{"$contentActions":[{"action":{"$id":"c172d3f4-40a5-4c1d-b649-82c9d16378dc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2276456d-51c1-4226-8c4b-939f28d3cc15","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"2276456d-51c1-4226-8c4b-939f28d3cc15","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"0423c1af-928a-47fb-a1c4-268bb1f9ebf6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d6176981-9b11-4fda-b6ec-89a7d53c7985","type":"text/plain","content":"Agrade√ßo pelas informa√ß√µes. üòÄ","metadata":{}},"$cardContent":{"document":{"id":"d6176981-9b11-4fda-b6ec-89a7d53c7985","type":"text/plain","content":"Agrade√ßo pelas informa√ß√µes. üòÄ"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c494fe4b-809a-4403-9505-10623ef0c1f2","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"end","typeOfStateId":"state","$connId":"con_33","$id":"db34bdf7-2b8b-40ae-92ac-19ec357fc9c8","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bcc8bbfc-738c-4439-8c35-c27a2a7b3df2","$typeOfContent":"","type":"TrackEvent","$title":"agradecimento informacoes exibicao","$invalid":false,"settings":{"extras":{},"category":"agradecimento informacoes exibicao","action":"exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false}],"id":"f44ff8c2-36a0-4d21-bcfd-cededcab8543","root":false,"$title":"[S.0.1.3]","$position":{"top":"1110px","left":"640px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59a73dcc-1d95-4f55-8ced-06a546482639":{"$contentActions":[{"action":{"$id":"3ca20bf5-40b6-43ab-bdf0-1d594d0cbcb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}","metadata":{}},"$cardContent":{"document":{"id":"2c1de04e-6b5b-453d-b775-c507cf8118f6","type":"text/plain","content":"{{inputText}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"d5646ddb-a50b-4729-a526-86b69f4b7ab9","typeOfStateId":"state","$connId":"con_38","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"coleta nome input exibicao","$invalid":false,"settings":{"extras":{},"category":"coleta nome input exibicao","action":"Exibicao"},"conditions":[]},{"$id":"93a648f3-3678-416d-ba61-3a39fe322fb7","$typeOfContent":"","type":"ExecuteScript","$title":"InputText","$invalid":false,"settings":{"function":"run","source":"function run(hide) {\n\n    let inputText = `{{n1}}Qual o seu nome?{{n2}} üë§\n\nüü¶ Digite apenas texto.`\n\n    if (hide == true || hide == \"true\") {\n        return \"\";\n    } else  {\n        return inputText\n    }\n}","inputVariables":["hideInputText"],"outputVariable":"inputText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = false;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            nomeCompleto: true\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        // if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'SAIR'\n        //     return JSON.stringify(processedInput)\n        // } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n        //     processedInput.type = 'reserved'\n        //     processedInput.input = 'MENU'\n        //     return JSON.stringify(processedInput)\n        // }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"coleta nome input","$invalid":false,"settings":{"extras":{},"category":"coleta nome input","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"cfe5c70b-82e5-495a-8660-9a3a92d3890f","$typeOfContent":"","type":"TrackEvent","$title":"coleta nome inesperado","$invalid":false,"settings":{"extras":{},"category":"coleta nome inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"notEquals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"9bed6ee2-713f-4a07-8526-4498e2c417b1","$typeOfContent":"","type":"MergeContact","$title":"Nome","$invalid":false,"settings":{"extras":{},"name":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-a531197d-5d28-c5d7-2b51-dff025e28b80","canChangeBackground":false}],"id":"59a73dcc-1d95-4f55-8ced-06a546482639","$title":"[S.0.0.8] [INPUT] [CONTENT] Nome","$position":{"top":"338px","left":"640px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"isAiGenerated":false},"36b68048-3089-4f8b-9863-a6332a041dc0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fbf92afc-a1bf-400c-8e40-22d772bf16fa","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-31fd5180-97e8-b29a-b296-110803b6277e","canChangeBackground":false}],"id":"36b68048-3089-4f8b-9863-a6332a041dc0","$title":"[REDIRECT TO] Exce√ß√µes","$position":{"top":"227px","left":"1505px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000","commentsIdList":[]},"isAiGenerated":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}}]}