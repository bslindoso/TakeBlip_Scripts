{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a5f855b2-7344-44ad-bf8b-75bccd63d288","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right"},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"c6fde1c4-1481-4d06-ad78-0804bbf76a92","conditions":[{"source":"input","comparison":"exists","values":[]}],"$connId":"con_3","$invalid":false,"$id":"35d42520-8a51-4415-83eb-c220e382bdeb","typeOfStateId":"state"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c6fde1c4-1481-4d06-ad78-0804bbf76a92","$invalid":false,"typeOfStateId":"state"},"id":"onboarding","root":true,"$position":{"top":"38px","left":"389px"},"$title":"In√≠cio","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"$tags":[]},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"95b10ba8-e351-4d16-9b10-ce14961cb1fd","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"0a53ade3-d1bb-4793-9cf6-0055bf68ab2a","typeOfStateId":"state","$connId":"con_8","$id":"f881585b-aa9f-46d8-9786-e5d3b59ca872","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"0a53ade3-d1bb-4793-9cf6-0055bf68ab2a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$connId":"con_93","$invalid":false,"$id":"61d23b1d-0f2a-481a-8554-9551b2c3fcb9","typeOfStateId":"state"}],"$enteringCustomActions":[{"$id":"90a5e836-dc7d-487d-b736-66543e28fc0d","$typeOfContent":"","type":"ExecuteScript","$title":"exception","$invalid":false,"settings":{"function":"run","source":"function run(previousState, typeInput) {\n    let idFormated = previousState.split(\" \")\n    idFormated = idFormated[0].replace(\"[\",\"\").replace(\"]\",\"\")\n    const exception = {\n        id: `${idFormated}`,\n        input: '{{input.content}}',\n        redirectMenu: typeInput\n    }\n\n\n    return exception\n}","inputVariables":["state.previous.name","validInputJs"],"outputVariable":"exception","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"id":"fallback","$position":{"top":"16px","left":"1408px"},"$title":"Exce√ß√µes","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"$tags":[{"background":"#FF961E","label":"executeScript","id":"blip-tag-a1578857-f2c5-9986-b4db-67b36b5956a3","canChangeBackground":false}]},"desk:b69ef3a2-9983-48f8-9d40-16bad478a460":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b04c3ac0-5b0c-4f61-ade4-9adbd31ae1fc","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false,"expiration":"2:0"},"$invalid":false}],"$conditionOutputs":[{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant"]}],"$invalid":false,"stateId":"9246bdf4-fb98-49ff-a094-db97fd381a1e","$connId":"con_18","$id":"fec13811-ae23-4a84-9b95-48797852a14d"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClient"]}],"$invalid":false,"stateId":"9246bdf4-fb98-49ff-a094-db97fd381a1e","$connId":"con_98","$id":"1f73d79b-1c17-4afd-b8f0-a46d516e9133"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClientInactivity"]}],"$invalid":false,"stateId":"9753b927-d8ab-444a-b996-02459c301f32","$connId":"con_28","$id":"d8139e7e-144b-44ce-b2d4-3ee87cba01fb"}],"$enteringCustomActions":[{"type":"ExecuteScript","$title":"GetEncodedContactIdentity","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:b69ef3a2-9983-48f8-9d40-16bad478a460"]}],"settings":{"function":"run","source":"function run(identity) {\n return (identity !== undefined) ? encodeURIComponent(identity) : identity;\n}","inputVariables":["input.message.fromidentity"],"outputVariable":"helpDeskEncodedFromIdentity","LocalTimeZoneEnabled":false}},{"type":"ProcessCommand","$title":"GetOpenTicket","conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:b69ef3a2-9983-48f8-9d40-16bad478a460"]}],"settings":{"from":"{{application.identifier}}@{{application.domain}}","to":"postmaster@desk.msging.net","method":"get","uri":"/tickets?$filter=customerIdentity%20eq%20%27{{helpDeskEncodedFromIdentity}}%27%20and%20%28status%20eq%20%27Open%27%20or%20status%20eq%20%27Waiting%27%20or%20status%20eq%20%27Assigned%27%29","variable":"helpDeskGetOpenTicketCommandResponse"},"$invalid":false},{"type":"ExecuteScript","$title":"TreatGetOpenTicketResponse","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:b69ef3a2-9983-48f8-9d40-16bad478a460"]}],"settings":{"function":"run","source":"function run(commandResponse) {\n    var response = JSON.parse(commandResponse)\n    var ticketExists = (response && response.resource && response.resource.items && response.resource.items.length > 0);\n  return ticketExists ? \"true\" : \"false\";\n}","inputVariables":["helpDeskGetOpenTicketCommandResponse"],"outputVariable":"helpDeskHasTicket","LocalTimeZoneEnabled":false}},{"type":"ProcessCommand","$title":"OpenTicketIfNotFound","conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"notEquals","values":["true"]}],"settings":{"from":"{{application.identifier}}@{{application.domain}}","to":"postmaster@desk.msging.net","method":"set","uri":"/tickets/{{helpDeskEncodedFromIdentity}}","variable":"helpDeskOpenTicketCommandResponse","type":"text/plain","resource":"{{input.content}}","metadata":{"server.shouldStore":true}},"$invalid":false},{"type":"ExecuteScript","$title":"TreatOpenTicketResponse","$invalid":false,"conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"notEquals","values":["true"]}],"settings":{"function":"run","source":"function run(commandResponse) {\n    var response = commandResponse ? JSON.parse(commandResponse) : {}\n    var ticketExists = response && response.type === \"application/vnd.iris.ticket+json\" && response.resource \n    return ticketExists ? \"true\" : \"false\";\n}","inputVariables":["helpDeskOpenTicketCommandResponse"],"outputVariable":"helpDeskHasTicket","LocalTimeZoneEnabled":false}},{"type":"ForwardMessageToDesk","settings":{},"$invalid":false}],"$leavingCustomActions":[{"type":"SetVariable","$title":"ResetHasTicket","settings":{"$invalid":false,"variable":"helpDeskHasTicket","value":"false"},"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant","ClosedClient","ClosedClientInactivity"]}],"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$invalid":false},"id":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","deskStateVersion":"2.0.1","root":false,"$title":"Atendimento humano","$position":{"top":"264px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#0d47a1","textColor":"#ffffff"}},"ea376d2d-7e6e-45e3-b5b3-3c0d713e7b11":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"71666f38-879c-488e-bd29-5593e19aae4b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"65d944f7-4106-4315-8b5e-967f690dfae9","$typeOfContent":"","type":"Redirect","$title":"[GO TO] NPS Humano","$invalid":false,"settings":{"context":{"type":"text/plain","value":"csat"},"address":"saccsat"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-180bb99d-115a-1424-84e0-1190407e09c0","canChangeBackground":false}],"id":"ea376d2d-7e6e-45e3-b5b3-3c0d713e7b11","root":false,"$title":"[GO TO] CSAT","$position":{"top":"147px","left":"1607px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"bce95b9d-28db-4c2d-beb9-8deaca4b7f92":{"$contentActions":[{"action":{"$id":"62b5a087-279b-4b0e-bf14-baf72443b60f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"acd256df-e4ae-4dca-a8c2-04ae0371d7ea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"Um momento, por favor... ‚åõ\n\nEstou verificando se nossa equipe de atendimento est√° dispon√≠vel...","metadata":{}},"$cardContent":{"document":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"Um momento, por favor... ‚åõ\n\nEstou verificando se nossa equipe de atendimento est√° dispon√≠vel..."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b59d9b72-bca1-4f3e-b52c-c5207542c3d9","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","typeOfStateId":"state","$connId":"con_33","$id":"785e17e1-a3e1-44e9-98c9-86167165e3e2","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"waitingTickets"}],"$invalid":false},{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","typeOfStateId":"state","$connId":"con_103","$id":"9d1ea57d-32b8-475f-b5d6-3514061bfce7","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"waitingTickets"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1449df08-ee96-4475-962b-f739555801de","$typeOfContent":"","type":"TrackEvent","$title":"transbordo verificacao disponibilidade exibicao","$invalid":false,"settings":{"extras":{},"category":"transbordo verificacao disponibilidade exibicao","action":"Exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"bce95b9d-28db-4c2d-beb9-8deaca4b7f92","root":false,"$title":"[T.1.3.0] Verifica Disponibilidade Atendente","$position":{"top":"93px","left":"853.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a5c2fb0-2409-4c7b-b66e-2cf8bb645cb2":{"$contentActions":[{"action":{"$id":"62b5a087-279b-4b0e-bf14-baf72443b60f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"acd256df-e4ae-4dca-a8c2-04ae0371d7ea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"No momento todos os nossos atendentes est√£o ocupados...\n\nPor favor, aguarde que logo iremos te atender! ‚è≥","metadata":{}},"$cardContent":{"document":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"No momento todos os nossos atendentes est√£o ocupados...\n\nPor favor, aguarde que logo iremos te atender! ‚è≥"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b59d9b72-bca1-4f3e-b52c-c5207542c3d9","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","typeOfStateId":"state","$connId":"con_43","$id":"785e17e1-a3e1-44e9-98c9-86167165e3e2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1449df08-ee96-4475-962b-f739555801de","$typeOfContent":"","type":"TrackEvent","$title":"transbordo atendente indisponivel exibicao","$invalid":false,"settings":{"extras":{},"category":"transbordo atendente indisponivel exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"0a5c2fb0-2409-4c7b-b66e-2cf8bb645cb2","root":false,"$title":"[T.1.7.0] Atendente Ocupado","$position":{"top":"411.111px","left":"506.222px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9753b927-d8ab-444a-b996-02459c301f32":{"$contentActions":[{"action":{"$id":"3c18348a-725d-41f7-9ac6-0561efe36dab","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a6a2203f-29c0-44b4-adb6-d2b8831a770a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a6a2203f-29c0-44b4-adb6-d2b8831a770a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"609d5e1b-6140-47a5-b087-623cdf764ad4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"6298d58b-6bf5-4c5f-8fd4-03b348525de0","type":"text/plain","content":"Seu atendimento foi encerrado por {{n1}}inatividade{{n2}}.","metadata":{}},"$cardContent":{"document":{"id":"6298d58b-6bf5-4c5f-8fd4-03b348525de0","type":"text/plain","content":"Seu atendimento foi encerrado por {{n1}}inatividade{{n2}}."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a527de49-507e-4a85-86df-0f2139d60056","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"e2e403e5-f15e-4d29-9844-745ec9fcdf4e","$typeOfContent":"","type":"TrackEvent","$title":"atendimento encerrado por inatividade exibicao","$invalid":false,"settings":{"extras":{},"category":"atendimento encerrado por inatividade exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"9753b927-d8ab-444a-b996-02459c301f32","root":false,"$title":"Inatividade","$position":{"top":"370px","left":"851px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c6fde1c4-1481-4d06-ad78-0804bbf76a92":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"dbe0f7fa-9ba6-450f-89eb-d8029824743b","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1047"}],"$conditionOutputs":[{"stateId":"7a85e3ec-3d22-4efc-ac09-36db04ded992","typeOfStateId":"state","$connId":"con_118","$id":"6e2ed3fb-25ae-4329-a337-ca9e8aa7ecf1","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:1055"}],"$invalid":false,"$$hashKey":"object:1049"}],"$enteringCustomActions":[{"$id":"cd2a17cd-740c-4c7f-8775-69b6c6c6545e","$typeOfContent":"","type":"SetVariable","$title":"service","$invalid":false,"settings":{"variable":"service","value":"sactransbordo"},"conditions":[]},{"$id":"2b94ab8e-d556-4a91-a5e5-9b181982730a","$typeOfContent":"","type":"ProcessHttp","$title":"GET Waiting Tickets","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"{{$guid}}\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"method\": \"get\",\n    \"uri\": \"/monitoring/tickets\"\n}","uri":"{{config.urlBlip}}","responseStatusVariable":"statusWaiting","responseBodyVariable":"responseWaiting"},"conditions":[]},{"$id":"8c3f9622-2714-4bd7-b121-eaaba67daf6f","$typeOfContent":"","type":"ProcessHttp","$title":"GET Online Attendant","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n   \"id\": \"{{$guid}}\",\n   \"to\": \"postmaster@desk.msging.net\",\n   \"method\": \"get\",\n   \"uri\": \"/attendants\"\n }","uri":"{{config.urlBlip}}","responseStatusVariable":"statusOnlineAttendant","responseBodyVariable":"responseOnlineAttendant"},"conditions":[]},{"$id":"c9e44f54-988f-482f-84a3-cee3a421f1ca","$typeOfContent":"","type":"MergeContact","$title":"Time","$invalid":false,"settings":{"extras":{"Team":"Fila Unica"}},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"7a85e3ec-3d22-4efc-ac09-36db04ded992","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#FF961E","label":"executeScript","id":"blip-tag-a1578857-f2c5-9986-b4db-67b36b5956a3","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-0b488f20-3494-a80c-e63c-d05d80fe4a4a","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-5673e590-3e8b-161c-883c-12340bcae7d5","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-6e13007c-716c-6d50-68aa-0efb8b4afb47","canChangeBackground":false}],"id":"c6fde1c4-1481-4d06-ad78-0804bbf76a92","$title":"[REQUIREMENTS]","$position":{"top":"141px","left":"388px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#000000","textColor":"#ffffff"}},"a4425c36-b361-4363-97cc-0bb558f88edf":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Finalizar","$invalid":false,"settings":{"context":{"type":"text/plain","value":"finalizacao"},"address":"sacfinalizacao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-180bb99d-115a-1424-84e0-1190407e09c0","canChangeBackground":false}],"id":"a4425c36-b361-4363-97cc-0bb558f88edf","root":false,"$title":"[REDIRECT TO] Finalizar","$position":{"top":"260px","left":"1606px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"0a53ade3-d1bb-4793-9cf6-0055bf68ab2a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f4a76ec3-f892-4cad-ad43-60297c09eb7b","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3fb7ef00-299c-4276-8405-acb5cf3a78a4","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Exce√ß√µes","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{exception}}"},"address":"sacexcessao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-180bb99d-115a-1424-84e0-1190407e09c0","canChangeBackground":false}],"id":"0a53ade3-d1bb-4793-9cf6-0055bf68ab2a","$title":"[REDIRECT TO] Exce√ß√µes","$position":{"top":"15px","left":"1606px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"9246bdf4-fb98-49ff-a094-db97fd381a1e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"77651b7b-346e-4277-8d19-4cfa5f84b06b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"addd8fd2-1f30-4774-96b8-17dc3bdf2eda","typeOfStateId":"state","$connId":"con_53","$id":"8feb250b-faeb-4d97-a770-7720ce20d851","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"32b48d03-32d0-4f5b-94a8-1a10c85edd16","type":"ExecuteScript","$title":"Get agentIdentity","$invalid":false,"settings":{"function":"run","source":"\nfunction run(input) {\n    let ticketData = JSON.parse(input);\n    return encodeURI(ticketData.agentIdentity);\n}\n","inputVariables":["input.content"],"outputVariable":"agentIdentity","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ff1d7797-15b2-4904-8366-88e29ace31c7","$typeOfContent":"","type":"ProcessHttp","$title":"Agent Data","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n  \"id\": \"db42d9df-a77e-42cf-9e17-9d97213eda47\",\n  \"to\": \"postmaster@desk.msging.net\",\n  \"method\": \"get\",\n  \"uri\": \"/attendants?$filter=(identity%20eq%20'{{agentidentity}}')\"\n}","uri":"https://msging.net/commands","responseStatusVariable":"statusAgentData","responseBodyVariable":"agentData"},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"agentIdentity"}]},{"$id":"7994a4ad-c51e-4e4b-944d-9730de6d4f67","type":"ExecuteScript","$title":"Get agentName","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    try{\n        let agenteId = JSON.parse(input);\n        return agenteId.resource.items[0].fullName;\n    } \n    catch(e)\n    {\n        return \"\";\n    }\n}","inputVariables":["agentData"],"outputVariable":"agentName","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c6413aa4-9998-44d3-b5c0-b07e21389031","$typeOfContent":"","type":"SetVariable","$title":"Ticket ID","$invalid":false,"settings":{"variable":"ticket","value":"{{input.content@sequentialId}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"addd8fd2-1f30-4774-96b8-17dc3bdf2eda"},"$tags":[{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-d2974ed4-d8d9-0d87-6153-fbed3205d146","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-5673e590-3e8b-161c-883c-12340bcae7d5","canChangeBackground":false}],"id":"9246bdf4-fb98-49ff-a094-db97fd381a1e","root":false,"$title":"Informa√ß√£o Atendimento","$position":{"top":"242px","left":"1098px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000"}},"addd8fd2-1f30-4774-96b8-17dc3bdf2eda":{"$contentActions":[{"action":{"$id":"33dc68fc-4b13-40c2-b0b5-7db20015574f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bd9ec309-499c-4ca6-a5f2-beeef3796bdd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bd9ec309-499c-4ca6-a5f2-beeef3796bdd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"2951ab09-7a7b-4f02-b593-6235e5708e47","$typeOfContent":"text","type":"SendMessage","settings":{"id":"13b6d242-d5d8-422e-a5a1-8750dd4a837d","type":"text/plain","content":"Atendimento encerrado! ‚úÖ","metadata":{}},"$cardContent":{"document":{"id":"13b6d242-d5d8-422e-a5a1-8750dd4a837d","type":"text/plain","content":"Atendimento encerrado! ‚úÖ"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1fc232be-dfa0-4ecb-a3f8-614ccf9bf9e8","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ea376d2d-7e6e-45e3-b5b3-3c0d713e7b11","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"addd8fd2-1f30-4774-96b8-17dc3bdf2eda","root":false,"$title":"[T.1.5.0] Atendimento Encerrado","$position":{"top":"380px","left":"1100px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fd8ad553-3790-4dc0-bec4-1eb6182132b4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2a07a4d7-0658-43a2-a65f-2f6649fb7f5d","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"14d35e19-b98e-4d50-8174-225cd636f8e6","typeOfStateId":"state","$connId":"con_58","$id":"64019d8f-12a2-468f-bc6f-18ba1ab5ae38","conditions":[{"source":"context","comparison":"equals","values":["feriado"],"variable":"validDataTimeJs"},{"source":"context","comparison":"equals","variable":"onlineAttendant","values":["true"]}],"$invalid":false},{"stateId":"0a5c2fb0-2409-4c7b-b66e-2cf8bb645cb2","typeOfStateId":"state","$connId":"con_63","$id":"37cead16-ee63-48d0-891d-e603ee4ea9ff","conditions":[{"source":"context","comparison":"equals","values":["feriado"],"variable":"validDataTimeJs"},{"source":"context","comparison":"equals","variable":"onlineAttendant","values":["false","error"]}],"$invalid":false},{"stateId":"11fbd976-75e3-4ade-a5c7-d91b38fcdda2","typeOfStateId":"state","$connId":"con_68","$id":"276299e0-4da9-4a34-9bab-d082f386904c","conditions":[{"source":"context","comparison":"equals","values":["feriado fora de hora"],"variable":"validDataTimeJs"}],"$invalid":false},{"stateId":"aa1df4ca-9aab-4214-9e5a-b91015f89950","typeOfStateId":"state","$connId":"con_73","$id":"e41e0a98-aaac-4a7d-8e88-64e1c21a0e74","conditions":[{"source":"context","comparison":"equals","values":["fora de hora"],"variable":"validDataTimeJs"}],"$invalid":false},{"stateId":"bce95b9d-28db-4c2d-beb9-8deaca4b7f92","typeOfStateId":"state","$connId":"con_78","$id":"06ca0325-905b-41fb-8f9a-1d6edc578b2d","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"onlineAttendant"},{"source":"context","comparison":"equals","variable":"validDataTimeJs","values":["true"]}],"$invalid":false},{"stateId":"0a5c2fb0-2409-4c7b-b66e-2cf8bb645cb2","typeOfStateId":"state","$connId":"con_108","$id":"daebba73-1ab4-46d3-a3fc-bf90331972ac","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5c94d8d7-6d51-4144-97ff-32ed125c6b9a","$typeOfContent":"","type":"TrackEvent","$title":"transbordo verificacao exibicao","$invalid":false,"settings":{"extras":{},"category":"transbordo verificacao exibicao","action":"exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]},{"$id":"906f4adc-2d80-4fed-9374-9f5bf0a75114","$typeOfContent":"","type":"ExecuteScript","$title":"validDataTimeJs","$invalid":false,"settings":{"function":"run","source":"function run(holiday, workTime) {\n  try {\n    let holidayJS = JSON.parse(holiday)\n    let workTimeJS = JSON.parse(workTime)\n    let date = `${new Date().getMonth() + 1}-${new Date().getDate()}`\n    let weekdays = new Date().getDay()\n    let hour = new Date().getHours()\n    let minutes = getMinutes();\n    let time = `${hour}${minutes}`\n    time = parseInt(time)\n\n\n    for (let i = 0; i < holidayJS.length; i++) {\n      if (holidayJS[i] == date) {\n\n        //VALIDA SE O FERIADO TA DENTRO DO HORARIO\n        for (let i = 0; i < workTimeJS.weekdays.length; i++) {\n\n          if (workTimeJS.weekdays[i].id && weekdays == 0) {\n            //DOMINGO\n            return `feriado fora de hora`\n          } else if (workTimeJS.weekdays[i].id == weekdays) {\n            //DIAS DE SEMANA E SABADO            \n            let hourStart = parseInt(workTimeJS.weekdays[i].hourStart)\n            let hourEnd = parseInt(workTimeJS.weekdays[i].hourEnd)\n\n            if (time < hourStart || time > hourEnd) {\n              return `feriado fora de hora`\n            }\n          }\n        }\n        return 'feriado'\n      }\n    }\n\n    for (let i = 0; i < workTimeJS.weekdays.length; i++) {\n\n      if (workTimeJS.weekdays[i].id && weekdays == 0) {\n        return `fora de hora`\n      }\n      else if (workTimeJS.weekdays[i].id == weekdays) {\n        let hourStart = parseInt(workTimeJS.weekdays[i].hourStart)\n        let hourEnd = parseInt(workTimeJS.weekdays[i].hourEnd)\n        if (time < hourStart || time > hourEnd) {\n          return `fora de hora`\n        }\n      }\n    }\n\n    return true\n  }\n  catch (e) {\n    return 'ERROR: SCRIPT FAILURE'\n  }\n}\n\n// FUN√á√ïES AUXILIARES\nfunction getMinutes() {\n  let minutes = new Date().getMinutes();\n  minutes = parseInt(minutes)\n  if (minutes < 9) {\n    return \"0\" + minutes.toString();\n  } else {\n    return minutes.toString();\n  }\n}","inputVariables":["resource.holiday","resource.workTime"],"outputVariable":"validDataTimeJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3054c8e1-4331-4740-bb64-fc535400f385","$typeOfContent":"","type":"ExecuteScript","$title":"waitingTickets","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        response = JSON.parse(response)\n        let waiting = response.resource.waiting\n\n        if (waiting == 0) {\n            return false\n        }\n\n        return true\n    }\n    catch (e) {\n        return 'error'\n    }\n}","inputVariables":["responseWaiting"],"outputVariable":"waitingTickets","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b1d8326e-6f87-478d-a70c-af926db522fb","$typeOfContent":"","type":"ExecuteScript","$title":"onlineAttendant","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        response = JSON.parse(response)\n        let attendant = response.resource.items\n\n        for (let i = 0; i < attendant.length; i++) {\n            if (attendant[i].status == \"Online\") {\n                return true\n            }\n        }\n\n        return false\n    }\n    catch (e) {\n        return 'error'\n    }\n\n}","inputVariables":["responseOnlineAttendant"],"outputVariable":"onlineAttendant","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"0a5c2fb0-2409-4c7b-b66e-2cf8bb645cb2","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false},{"background":"#FF961E","label":"executeScript","id":"blip-tag-a1578857-f2c5-9986-b4db-67b36b5956a3","canChangeBackground":false}],"id":"fd8ad553-3790-4dc0-bec4-1eb6182132b4","root":false,"$title":"[T.1.0.0] Valida Feriado e Atendente","$position":{"top":"252.889px","left":"388px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"11fbd976-75e3-4ade-a5c7-d91b38fcdda2":{"$contentActions":[{"action":{"$id":"610908fc-1f20-4b53-a694-97772644eecc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3cb96e72-49d9-4ad5-bbd6-aea9281abf07","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3cb96e72-49d9-4ad5-bbd6-aea9281abf07","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cf44fcf6-ac57-4a93-9ce6-0ecb99b94edf","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a75973e-82eb-45ce-b09e-40b9d59fbd97","type":"text/plain","content":"Infelizmente, nossa equipe de atendimento n√£o est√° dispon√≠vel neste feriado.\n\nPor favor, retorne dentro do nosso hor√°rio comercial üòä","metadata":{}},"$cardContent":{"document":{"id":"4a75973e-82eb-45ce-b09e-40b9d59fbd97","type":"text/plain","content":"Infelizmente, nossa equipe de atendimento n√£o est√° dispon√≠vel neste feriado.\n\nPor favor, retorne dentro do nosso hor√°rio comercial üòä"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6b5a8cf9-99a9-42d9-8ac2-816ae755c240","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"25ca7336-0578-4523-adc9-82d66c021f9e","$typeOfContent":"","type":"TrackEvent","$title":"indisponibilidade no atendimento exibicao","$invalid":false,"settings":{"extras":{},"category":"indisponibilidade no atendimento exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"11fbd976-75e3-4ade-a5c7-d91b38fcdda2","root":false,"$title":"[T.1.2.0] Feriado - Fora de Hor√°rio","$position":{"top":"549.444px","left":"271px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"14d35e19-b98e-4d50-8174-225cd636f8e6":{"$contentActions":[{"action":{"$id":"62b5a087-279b-4b0e-bf14-baf72443b60f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b15090e5-f76b-4146-a08b-6081e8674e1c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"acd256df-e4ae-4dca-a8c2-04ae0371d7ea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"Em alguns instantes voc√™ ser√° atendido(a) por nossa equipe. üòä\n\nAguarde s√≥ mais alguns instantes...","metadata":{}},"$cardContent":{"document":{"id":"70fd1d3d-2801-4189-8d0f-aa965c200680","type":"text/plain","content":"Em alguns instantes voc√™ ser√° atendido(a) por nossa equipe. üòä\n\nAguarde s√≥ mais alguns instantes..."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b59d9b72-bca1-4f3e-b52c-c5207542c3d9","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","typeOfStateId":"state","$connId":"con_88","$id":"785e17e1-a3e1-44e9-98c9-86167165e3e2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1449df08-ee96-4475-962b-f739555801de","$typeOfContent":"","type":"TrackEvent","$title":"atendente disponivel exibicao","$invalid":false,"settings":{"extras":{},"category":"atendente disponivel exibicao","action":"Exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"14d35e19-b98e-4d50-8174-225cd636f8e6","root":false,"$title":"[T.1.4.0] Atendente Disponivel [Feriado]","$position":{"top":"412.333px","left":"270.778px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"aa1df4ca-9aab-4214-9e5a-b91015f89950":{"$contentActions":[{"action":{"$id":"610908fc-1f20-4b53-a694-97772644eecc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3cb96e72-49d9-4ad5-bbd6-aea9281abf07","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3cb96e72-49d9-4ad5-bbd6-aea9281abf07","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"cf44fcf6-ac57-4a93-9ce6-0ecb99b94edf","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4a75973e-82eb-45ce-b09e-40b9d59fbd97","type":"text/plain","content":"Estamos indispon√≠veis no momento...\nNosso {{n1}}atendimento{{n2}} √© de {{n1}}segunda √† sexta das 09:00 √†s 18:00.{{n2}}\n\nPor favor, retorne dentro do nosso hor√°rio comercial üòä","metadata":{}},"$cardContent":{"document":{"id":"4a75973e-82eb-45ce-b09e-40b9d59fbd97","type":"text/plain","content":"Estamos indispon√≠veis no momento...\nNosso {{n1}}atendimento{{n2}} √© de {{n1}}segunda √† sexta das 09:00 √†s 18:00.{{n2}}\n\nPor favor, retorne dentro do nosso hor√°rio comercial üòä"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6b5a8cf9-99a9-42d9-8ac2-816ae755c240","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"25ca7336-0578-4523-adc9-82d66c021f9e","$typeOfContent":"","type":"TrackEvent","$title":"transbordo fora do horario sem atendentes exibicao","$invalid":false,"settings":{"extras":{},"category":"transbordo fora do horario sem atendentes exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a4425c36-b361-4363-97cc-0bb558f88edf","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-71cc8925-4712-543a-feb5-058475fd59db","canChangeBackground":false}],"id":"aa1df4ca-9aab-4214-9e5a-b91015f89950","root":false,"$title":"[T.1.8.0] Fora de Hor√°rio","$position":{"top":"548.111px","left":"508.111px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"427e4798-f475-4a5d-ac9b-2755c6687d01":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"dbe0f7fa-9ba6-450f-89eb-d8029824743b","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2615"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"cd2a17cd-740c-4c7f-8775-69b6c6c6545e","$typeOfContent":"","type":"SetVariable","$title":"service","$invalid":false,"settings":{"variable":"service","value":"sactransbordo"},"conditions":[]},{"$id":"55a837f9-800b-4b75-9d66-3c2a35d7aa41","$typeOfContent":"","type":"MergeContact","$title":"Set contact","$invalid":false,"settings":{"extras":{"Team":"{{team}}"}},"conditions":[]},{"$id":"491401ee-410f-4309-ba51-37c6309634e8","$typeOfContent":"","type":"ProcessCommand","$title":"Merge das Informa√ß√µes extras","$invalid":false,"settings":{"to":"postmaster@msging.net","method":"merge","resource":"{\"identity\":\"{{tunnel.identity}}\",\"source\":\"{{contact.source}}\",\"extras\":{\"team\":\"{{team}}\"}}","type":"application/vnd.lime.contact","uri":"/contacts","variable":"statusMergeContact"},"conditions":[]},{"$id":"ab9663cb-fa6f-4a6b-9264-ec2ead9cc485","$typeOfContent":"","type":"ExecuteScript","$title":"bodyExtrasJs","$invalid":false,"settings":{"function":"run","source":"function run(contact, id){\n    obj = JSON.parse(contact)\n    obj.identity = id\n\n    request = {\n        \"id\": \"{{$guid}}\",\n        \"method\": \"set\",\n        \"uri\": \"/contacts\",\n        \"type\": \"application/vnd.lime.contact+json\",\n        \"resource\": obj\n    }\n    return request\n}","inputVariables":["contact.serialized","tunnel.identity"],"outputVariable":"bodyExtrasJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"da6ae3dd-a400-4051-9a62-0c693a67fc70","$typeOfContent":"","type":"ProcessHttp","$title":"updateExtras","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{{bodyExtrasJs}}","uri":"{{config.urlBlip}}","responseStatusVariable":"statusUpdateExtras","responseBodyVariable":"responseUpdateExtras"},"conditions":[]},{"$id":"2b94ab8e-d556-4a91-a5e5-9b181982730a","$typeOfContent":"","type":"ProcessHttp","$title":"GET Waiting Tickets","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"{{$guid}}\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"method\": \"get\",\n    \"uri\": \"/monitoring/tickets\"\n}","uri":"{{config.urlBlip}}","responseStatusVariable":"statusWaiting","responseBodyVariable":"responseWaiting"},"conditions":[]},{"$id":"8c3f9622-2714-4bd7-b121-eaaba67daf6f","$typeOfContent":"","type":"ProcessHttp","$title":"GET Online Attendant","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n   \"id\": \"{{$guid}}\",\n   \"to\": \"postmaster@desk.msging.net\",\n   \"method\": \"get\",\n   \"uri\": \"/attendants\"\n }","uri":"{{config.urlBlip}}","responseStatusVariable":"statusOnlineAttendant","responseBodyVariable":"responseOnlineAttendant"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF961E","label":"executeScript","id":"blip-tag-a1578857-f2c5-9986-b4db-67b36b5956a3","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-0b488f20-3494-a80c-e63c-d05d80fe4a4a","canChangeBackground":false},{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-5673e590-3e8b-161c-883c-12340bcae7d5","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-6e13007c-716c-6d50-68aa-0efb8b4afb47","canChangeBackground":false}],"id":"427e4798-f475-4a5d-ac9b-2755c6687d01","$title":"[REQUIREMENTS] [EXTRAS UPDATE]","$position":{"top":"0px","left":"2135px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#000000","textColor":"#ffffff","commentsIdList":[]}},"9872e4ab-fa98-4af2-9d89-529a7bdeb264":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cf8c9892-92a7-4a39-b169-9b8f5f7ef7a4","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$invalid":false,"$$hashKey":"object:1612"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"7a2604a8-d8b0-4412-8023-11b4e48e81dc","$typeOfContent":"","type":"MergeContact","$title":"Op√ß√£o Menu - Rule Team e Links Pai/Filho","$invalid":false,"settings":{"extras":{"ruleTeam":"{{ruleTeam}}","link_Caso_Pai":"{{linkCasoPai}}","link_Caso_Filho":"{{linkCasoFilho}}"}},"conditions":[]},{"$id":"52b81cd5-d235-496f-8f0b-5e45aab5e8fd","$typeOfContent":"","type":"ProcessCommand","$title":"Merge das informa√ß√µes","$invalid":false,"settings":{"to":"postmaster@msging.net","method":"merge","resource":{"identity":"{{tunnel.identity}}","source":"{{contact.source}}","extras":{"ruleTeam":"{{ruleTeam}}","link_Caso_Pai":"{{contact.extras.link_Caso_Pai}}","link_Caso_Filho":"{{contact.extras.link_Caso_Filho}}"}},"type":"application/vnd.lime.contact+json","uri":"/contacts","variable":"statusMergeContact"},"conditions":[]},{"$id":"16ddcd53-4c20-4a6c-94b6-aacb9d235770","$typeOfContent":"","type":"ExecuteScript","$title":"Body","$invalid":false,"settings":{"function":"run","source":"function run(contact, id){\n    obj = JSON.parse(contact)\n    obj.identity = id\n\n    request = {\n        \"id\": \"{{$guid}}\",\n        \"method\": \"set\",\n        \"uri\": \"/contacts\",\n        \"type\": \"application/vnd.lime.contact+json\",\n        \"resource\": obj\n    }\n    return request\n}","inputVariables":["contact.serialized","tunnel.identity"],"outputVariable":"contactData","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dbe3b51c-28d1-4078-a330-61f6702f59cf","$typeOfContent":"","type":"ProcessHttp","$title":"Update","$invalid":false,"settings":{"headers":{"Authorization":"Key {{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{{contactData}}","uri":"https://http.msging.net/commands","responseStatusVariable":"contactsUpdateStatus","responseBodyVariable":"contactsUpdateResponse"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"onboarding"},"id":"9872e4ab-fa98-4af2-9d89-529a7bdeb264","$position":{"top":"136px","left":"2137.5px"},"$title":"Extras Update","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"$tags":[{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-5673e590-3e8b-161c-883c-12340bcae7d5","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-d2974ed4-d8d9-0d87-6153-fbed3205d146","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-6e13007c-716c-6d50-68aa-0efb8b4afb47","canChangeBackground":false}],"invalidOutputs":true,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000"}},"31441b74-e258-4b74-9447-937e509bfccd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2408e195-b7d8-4066-9814-0615f894c32f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2071"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"8d05636a-968f-4d8d-a902-8f9347d0879b","$typeOfContent":"","type":"SetVariable","$title":"ticketId","$invalid":false,"settings":{"variable":"ticketId","value":"{{helpdeskopenticketcommandresponse@resource.id}}"},"conditions":[]},{"$id":"833b5974-8de4-4f95-be6b-7026f5dc4720","$typeOfContent":"","type":"ProcessHttp","$title":"Change Status","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"{{config.token}}"},"method":"POST","body":"{\n    \"id\": \"{{$guid}}\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"method\": \"set\",\n    \"uri\": \"/tickets/change-status\",\n    \"type\": \"application/vnd.iris.ticket+json\",\n    \"resource\": {\n        \"id\": \"{{ticketId}}\",\n        \"status\": \"ClosedClient\"\n    }\n}","uri":"https://ccrriosp.http.msging.net/commands","responseStatusVariable":"statusClose","responseBodyVariable":"responseClose"},"conditions":[]},{"$id":"78b1a880-3f31-47a9-983a-41b1b8a3876d","$typeOfContent":"","type":"ProcessHttp","$title":"Fechar Ticket","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"44ffea8b-2a9a-43bb-b6e0-617c17955f4e\",\n    \"method\": \"set\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"uri\": \"/tickets/{{ticketId}}/close\",\n    \"type\": \"application/vnd.iris.ticket+json\",\n    \"resource\": {\n        \"closedBy\": \"agent%40email.net@blip.ai\",\n        \"tags\": [\n            \"Encerrado pelo Cliente\"\n        ]\n    }\n}","uri":"https://ccrriosp.http.msging.net/commands","responseStatusVariable":"fecharTicketStatus","responseBodyVariable":"fecharTicketResponse"},"conditions":[]},{"$id":"68371608-82da-4584-97ed-65b0a141871e","$typeOfContent":"","type":"MergeContact","$title":"Reset \"Team\"","$invalid":false,"settings":{"extras":{"Team":"-"}},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contact.extras.Team","$$hashKey":"object:2269"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-5673e590-3e8b-161c-883c-12340bcae7d5","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-0b488f20-3494-a80c-e63c-d05d80fe4a4a","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-6e13007c-716c-6d50-68aa-0efb8b4afb47","canChangeBackground":false}],"id":"31441b74-e258-4b74-9447-937e509bfccd","root":false,"$title":"Close a Ticket as a user [API]","$position":{"top":"249.5px","left":"2138px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000","commentsIdList":[]}},"7a85e3ec-3d22-4efc-ac09-36db04ded992":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cf8c9892-92a7-4a39-b169-9b8f5f7ef7a4","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$invalid":false,"$$hashKey":"object:1253"}],"$conditionOutputs":[{"stateId":"fd8ad553-3790-4dc0-bec4-1eb6182132b4","typeOfStateId":"state","$connId":"con_123","$id":"6dbd13db-e059-4ad2-bfb0-fb54d97f04e2","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:1261"}],"$invalid":false,"$$hashKey":"object:1255"}],"$enteringCustomActions":[{"$id":"52b81cd5-d235-496f-8f0b-5e45aab5e8fd","$typeOfContent":"","type":"ProcessCommand","$title":"Merge das informa√ß√µes","$invalid":false,"settings":{"to":"postmaster@msging.net","method":"merge","resource":{"identity":"{{tunnel.identity}}","source":"{{contact.source}}","name":"{{contact.name}}","extras":{"SAC":"{{ruleTeam}}"}},"type":"application/vnd.lime.contact+json","uri":"/contacts","variable":"statusMergeContact"},"conditions":[]},{"$id":"16ddcd53-4c20-4a6c-94b6-aacb9d235770","$typeOfContent":"","type":"ExecuteScript","$title":"Body","$invalid":false,"settings":{"function":"run","source":"function run(contact, id){\n    obj = JSON.parse(contact)\n    obj.identity = id\n\n    request = {\n        \"id\": \"{{$guid}}\",\n        \"method\": \"set\",\n        \"uri\": \"/contacts\",\n        \"type\": \"application/vnd.lime.contact+json\",\n        \"resource\": obj\n    }\n    return request\n}","inputVariables":["contact.serialized","tunnel.identity"],"outputVariable":"contactData","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dbe3b51c-28d1-4078-a330-61f6702f59cf","$typeOfContent":"","type":"ProcessHttp","$title":"Update","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{{contactData}}","uri":"https://http.msging.net/commands","responseStatusVariable":"contactsUpdateStatus","responseBodyVariable":"contactsUpdateResponse"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"fd8ad553-3790-4dc0-bec4-1eb6182132b4"},"id":"7a85e3ec-3d22-4efc-ac09-36db04ded992","$position":{"top":"176.5px","left":"152px"},"$title":"Atualiza extras [Active]","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"$tags":[{"background":"#FF1E90","label":"HTTP Request","id":"blip-tag-d2f6d32a-8f3d-ae80-2164-881f1467e0ac","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#7762E3","label":"Set Contact","id":"blip-tag-34536386-696f-5928-5ea7-4c06b8dfb34e","canChangeBackground":false}],"invalidOutputs":true,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000","commentsIdList":[]}}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}