{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"be3d3246-157a-4b28-aa7d-90af07455e51","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"d6c106f7-8bbd-411d-b155-7921b83cfe42","$connId":"con_3","$id":"3e0403e5-63c5-4ea6-b6a1-6e3856b80425","conditions":[{"source":"context","comparison":"equals","values":["transbordo"],"variable":"objExcecao@origin"}],"$invalid":false},{"stateId":"welcome","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"62fe768c-c34f-4f31-95b9-5b5171b86434","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"onboarding","root":true,"$title":"In√≠cio","$position":{"top":"79px","left":"1397px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"315198f0-d588-4e7f-b1a7-7a9e1944f26a","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"e9bf25fd-8831-49fc-b59c-bee9160e4a2b","$connId":"con_13","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[],"id":"fallback","$title":"Exce√ß√µes","$position":{"top":"224px","left":"185px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b7c6b9e6-c0be-4eb0-b8ea-fa82b4761c06","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"ca6eebf4-d25f-45e0-af59-1c706a4d7e28","typeOfStateId":"state","$connId":"con_18","$id":"94b362ef-021e-46d4-a007-15e9b2e2b605","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9f7cd6fc-bb7d-4bf0-aad0-919bb126f51e","$typeOfContent":"","type":"TrackEvent","$title":"Transbordo inicio aguarde exibicao","$invalid":false,"settings":{"extras":{},"category":"Transbordo inicio aguarde exibicao","action":"Exibicao"},"conditions":[]},{"$id":"62af5848-eab2-4812-990c-76fe1b5639da","$typeOfContent":"","type":"MergeContact","$title":"Definir actualConcessionary","$invalid":false,"settings":{"extras":{"actualConcessionary":"{{resource.actualConcessionary}}"}},"conditions":[]},{"$id":"db152380-3423-4044-9707-aaff1d54064e","$typeOfContent":"","type":"MergeContact","$title":"Definir equipe","$invalid":false,"settings":{"extras":{"Equipe":"-"}},"conditions":[{"source":"context","comparison":"notExists","values":[],"variable":"contact.extras.Equipe"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ca6eebf4-d25f-45e0-af59-1c706a4d7e28","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false},{"background":"#4F0E87","label":"SetContact","id":"blip-tag-f9943d94-9a3b-d32b-4181-d3fead0d17be","canChangeBackground":false}],"id":"welcome","$title":"[REQUIREMENTS]","$position":{"top":"68px","left":"1207px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8ae30a3b-2f45-4a9f-bd0a-4457bb2f6f35","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"686160de-8345-4385-8bb4-de9ae1521925","$typeOfContent":"","type":"ExecuteScript","$title":"OBJEXCECAO","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetRedirectMessage}}\n\nconst run = (processedInput, lastStateWithInput, countException) => {\n    const destination = \"excecao\";\n    const origin = \"saudacao\";\n    return getRedirectMessage(destination, origin, processedInput, lastStateWithInput, countException);\n};","inputVariables":["processedInput","lastStateWithInput","countException"],"outputVariable":"objExcecao","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"938e439a-6de6-4319-b782-68fb370d7459","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false}],"id":"error","$title":"[SET] Object Exception","$position":{"top":"322px","left":"184px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"edc60f7c-28df-4f21-88b8-ca6088286e7d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b7c6b9e6-c0be-4eb0-b8ea-fa82b4761c06","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF1E90","label":"Http","id":"blip-tag-aefc1f19-48e4-67a4-2d7d-c973d302eaf5","canChangeBackground":false},{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false},{"background":"#4F0E87","label":"SetContact","id":"blip-tag-f9943d94-9a3b-d32b-4181-d3fead0d17be","canChangeBackground":false},{"background":"#61D36F","label":"Redirect","id":"blip-tag-faafc359-f558-6880-b0c8-a73f06d80bcb","canChangeBackground":false},{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false},{"background":"#B2B229","label":"Menu","id":"blip-tag-e3d38186-9649-bb13-1c3c-4a1a2ca8c911","canChangeBackground":false},{"background":"#FFEC03","label":"GoTo","id":"blip-tag-acaeeeb9-8edb-b4f6-18b1-3ec3103da0c2","canChangeBackground":false},{"background":"#CC99FF","label":"UserInput","id":"blip-tag-a135d488-0fbf-29bd-714f-f3388ee2d198","canChangeBackground":false},{"background":"#6E7B91","label":"Medias","id":"blip-tag-fb3882d7-1587-f159-082b-d51beea5cced","canChangeBackground":false},{"background":"#0747A6","label":"ContentAssistant","id":"blip-tag-05e38f88-08c5-6e43-5646-40b1300a7a93","canChangeBackground":false},{"background":"#000000","label":"Mask","id":"blip-tag-29ea3b19-027a-d79e-1c03-75d083143911","canChangeBackground":false}],"id":"edc60f7c-28df-4f21-88b8-ca6088286e7d","$title":"Tags","$position":{"top":"49px","left":"180px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"569fa51e-a644-4391-b5be-8f80b31cc1f8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53b7b68d-9d3e-4a40-8f8e-237865176108","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"54588fe9-f78f-4e46-a91d-c93fc64f2c5d","$typeOfContent":"","type":"TrackEvent","$title":"Exibicao","$invalid":false,"settings":{"extras":{},"category":"Exibicao","action":"Exibicao"},"conditions":[]},{"$id":"2179ef58-8150-40a1-917d-5efba8017c85","$typeOfContent":"","type":"ProcessContentAssistant","$title":"Consultar Assistente de conte√∫do","$invalid":false,"settings":{"outputVariable":"contentAssistant","text":"{{input.content}}","score":"50"},"conditions":[]},{"$id":"632e55c3-d7e1-456a-921b-97d81e69ade9","$typeOfContent":"","type":"ExecuteScript","$title":"PROCESS INPUT","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetOptionSelected}}\n\nconst run = (selected, inputType, intent, platform, apiName, contentAssistant) => {\n    intent = (typeof intent !== 'undefined') ? intent : 'None';\n    platform = (typeof platform !== 'undefined') ? platform : 'BlipChat';\n    apiName = (typeof apiName !== 'undefined') ? apiName : false;\n    contentAssistant = (typeof contentAssistant !== 'undefined') ? contentAssistant : null;\n\n    const itens = [\n        {\n            name: [],\n        },\n    ];\n\n    let validation = {\n        'menuDinamic': true,\n        'isInputNoValidate': false,\n        'isTrueFalse': false,\n        'textLong': false,\n        'intentValidate': false,\n        'isIntent': false,\n        'isOptionMenu': false,\n        'contentAssistant': false,\n        'shortcutMenu': false,\n        'shortcut': false,\n        'badWord': false,\n        'NPS': false,\n        'Email': false,\n        'Cep': false,\n        'Telefone': false,\n        'Celular': false,\n        'CNPJ': false,\n        'CNPJValido': false,\n        'CPF': false,\n        'CPFValido': false,\n        'Quantidade': false,\n        'Data': false,\n        'Numero': false,\n        'Nome': false,\n        'Serial': false,\n        'Pedido': false,\n        'Id': false\n    };\n\n    if (platform === 'WhatsApp') {\n        validation.menuDinamic = false;\n    }\n\n    const mainMenus = [\n        {\n            name: [],\n        },\n    ];\n\n    const shortcuts = [\n        {\n            name: [],\n        },\n    ];\n\n    const selectResponse = getOptionSelected(\n        selected,\n        inputType,\n        itens,\n        validation,\n        intent,\n        mainMenus,\n        shortcuts,\n        apiName,\n        contentAssistant\n    );\n\n    return selectResponse;\n};","inputVariables":["input.content","input.type","input.intent.name","platform"],"outputVariable":"processedInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"13ee6d22-d016-43d5-b2a2-b8bfd5f9a2e7","$typeOfContent":"","type":"ExecuteScript","$title":"LAST STATE WITH INPUT","$invalid":false,"settings":{"function":"run","source":"{{resource.utilGetLastStateWithInput}}\n\nfunction run(stateName, stateId, lastStateWithInputCurrent) {\n    return getLastStateWithInput(stateName, stateId, lastStateWithInputCurrent);\n}","inputVariables":["state.name","state.id","lastStateWithInput"],"outputVariable":"lastStateWithInput","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"notEquals","variable":"state.id","values":["onboarding"]}]},{"$id":"15571201-6177-4b06-aba5-6b01ad89700b","$typeOfContent":"","type":"ExecuteScript","$title":"COUNT EXCEPTION","$invalid":false,"settings":{"function":"run","source":"{{resource.utilGetCountException}}\n\nfunction run(countExceptionCurrent, lastStateWithInput) {\n    return getCountException(countExceptionCurrent, lastStateWithInput);\n}","inputVariables":["countException","lastStateWithInput"],"outputVariable":"countException","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"notEquals","variable":"state.id","values":["onboarding"]}]}],"$leavingCustomActions":[{"$id":"abbfe83f-66e6-4606-8d9a-c8a8ec60f400","$typeOfContent":"","type":"SetVariable","$title":"Definir vari√°vel","$invalid":false,"settings":{"variable":"nomeDesejado","value":"{{processedInput@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["menu_return"]}]},{"$id":"ce4c3837-16cd-4d83-8657-621d532cc7e3","$typeOfContent":"","type":"MergeContact","$title":"Definir contato","$invalid":false,"settings":{"extras":{}},"conditions":[]},{"$id":"bc625da4-a3a1-4fb6-b42b-42cb2a9969b5","$typeOfContent":"","type":"TrackEvent","$title":"selecao","$invalid":false,"settings":{"extras":{},"category":"selecao","action":"{{processedInput@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["menu_return"]}]},{"$id":"3960ef51-a52f-409d-8f25-e50cb9b26bd6","$typeOfContent":"","type":"TrackEvent","$title":"inesperado","$invalid":false,"settings":{"extras":{},"category":"inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["block_return"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false},{"background":"#4F0E87","label":"SetContact","id":"blip-tag-f9943d94-9a3b-d32b-4181-d3fead0d17be","canChangeBackground":false},{"background":"#0747A6","label":"ContentAssistant","id":"blip-tag-05e38f88-08c5-6e43-5646-40b1300a7a93","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false}],"id":"569fa51e-a644-4391-b5be-8f80b31cc1f8","root":false,"$title":"[Val]","$position":{"top":"56px","left":"565px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"eb08415f-fd9e-4d4f-8953-24feb9b24e63":{"$contentActions":[{"action":{"$id":"00899f32-1a74-42c0-aed9-cbbafd963333","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"25bb9af9-ef7c-43ab-a3a5-b3b2044ced08","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"25bb9af9-ef7c-43ab-a3a5-b3b2044ced08","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"4a1fae49-0bb7-42cd-ac6c-803dee364593","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0a31399a-672b-40ef-99f3-bebd69f7649a","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:20"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"a8a4954c-54c7-46e6-abc9-ffc1e93ba3ed","$typeOfContent":"","type":"ExecuteScript","$title":"DEFINIR MENU","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, boldValue, italicValue) => {\n    let convertPlatform = platform.toLowerCase();\n    let convertBold = boldValue;\n    if (typeof boldValue === typeof toString()) {\n        convertBold = JSON.parse(boldValue);\n    }\n    let convertItalic = italicValue;\n    if (typeof italicValue === typeof toString()) {\n        convertItalic = JSON.parse(italicValue);\n    }\n\n    const default_msg = {\n        \"whatsapp\": {\n            \"button\": {\n                \"active\": false,\n                \"header\": '',\n                \"body\": '',\n                \"options\": [],\n                \"footer\": ''\n            },\n            \"list\": {\n                \"active\": false,\n                \"header\": '',\n                \"body\": '',\n                \"button\": '',\n                \"title\": '',\n                \"options\": [],\n                \"description\": [],\n                \"footer\": ''\n            },\n            \"template\": {\n                \"active\": false,\n                \"codeTemplate\": \"\",\n                \"nameTemplate\": \"\",\n                \"idiomTemplate\": \"pt_BR\"\n            },\n            \"image\": {\n                \"active\": false,\n                \"url\": '',\n                \"body\": '',\n                \"options\": [],\n                \"footer\": ''\n            }\n        },\n        \"blipchat\": {\n            \"quickReplay\": {\n                \"active\": false,\n                \"addNumber\": false,\n                \"separated\": \"\",\n                \"text\": '',\n                \"options\": [],\n                \"values\": []\n            },\n            \"menu\": {\n                \"active\": false,\n                \"addNumber\": false,\n                \"separated\": \"\",\n                \"text\": '',\n                \"options\": [],\n                \"values\": []\n            }\n        },\n        \"default\": {\n            \"text\": {\n                \"active\": false,\n                \"addNumber\": true,\n                \"separated\": \"\",\n                \"text\": '',\n                \"options\": []\n            },\n            \"textMenu\": {\n                \"active\": false,\n                \"addNumber\": true,\n                \"separated\": \"\",\n                \"text\": '',\n                \"init\": 0,\n                \"subMenuModValue\": false,\n                \"subMenuValues\": [],\n                \"options\": [],\n                \"subMenu\": []\n            }\n        },\n        \"config\": {\n            \"platform\": convertPlatform,\n            \"activeBold\": false,\n            \"boldValue\": convertBold,\n            \"activereplaceBold\": false,\n            \"replaceBold\": {\n                \"open\": \"%%%\",\n                \"close\": \"@@@\"\n            },\n            \"activeItalic\": false,\n            \"italicValue\": convertItalic,\n            \"activereplaceItalic\": false,\n            \"replaceItalic\": {\n                \"open\": \"###\",\n                \"close\": \"&&&\"\n            },\n            \"BreakLine\": '\\n',\n            \"replaceBreakLine\": '---',\n            \"replaceToBreakLine\": '___'\n        }\n    };\n\n    return getMenuForPlatform(default_msg);\n};","inputVariables":["platform","boldValue","italicValue"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#B2B229","label":"Menu","id":"blip-tag-e3d38186-9649-bb13-1c3c-4a1a2ca8c911","canChangeBackground":false},{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#CC99FF","label":"UserInput","id":"blip-tag-a135d488-0fbf-29bd-714f-f3388ee2d198","canChangeBackground":false}],"id":"eb08415f-fd9e-4d4f-8953-24feb9b24e63","root":false,"$title":"MENU","$position":{"top":"54px","left":"375px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"664a3e2b-386b-4b5d-837d-2c30f115f814":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8d988df5-379e-4cb6-b19c-bc898e85ad9b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c4d58110-eea2-406c-a3a6-12fe4fa88165","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"address":"{{redirectMenu}}","context":{"type":"text/plain","value":"{{redirectMessage}}"}},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#61D36F","label":"Redirect","id":"blip-tag-faafc359-f558-6880-b0c8-a73f06d80bcb","canChangeBackground":false}],"id":"664a3e2b-386b-4b5d-837d-2c30f115f814","root":false,"$title":"[REDIRECT TO] Redirect Solution","$position":{"top":"657px","left":"176px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"938e439a-6de6-4319-b782-68fb370d7459":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"633bba87-2411-4a81-a17d-7391a9f2fcba","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"980460e5-0a9f-4ae4-be2a-c91f3ec1c94e","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{objExcecao}}"},"address":"excecao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#61D36F","label":"Redirect","id":"blip-tag-faafc359-f558-6880-b0c8-a73f06d80bcb","canChangeBackground":false}],"id":"938e439a-6de6-4319-b782-68fb370d7459","root":false,"$title":"[REDIRECT TO] excecao","$position":{"top":"459px","left":"184px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d6c106f7-8bbd-411d-b155-7921b83cfe42":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea21f780-9489-42f1-8289-59fe2b89bf53","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"a63e6dd9-fd44-4354-870c-b5febeb92af9","$typeOfContent":"","type":"SetVariable","$title":"DESTINO","$invalid":false,"settings":{"variable":"destino","expiration":40,"value":"{{objExcecao@stateOrigin}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"6f85b71e-6d33-4139-aee3-f5e7a6a69cb7","$typeOfContent":"","type":"ExecuteScript","$title":"objExcecao","$invalid":false,"settings":{"function":"run","source":"const run = () => {\n    return {     \n        'destination': \"\",     \n        'origin': \"\",     \n        'inputContent': \"\",     \n        'inputType': \"\",     \n        'stateDestination': \"\",     \n        'stateOrigin': \"\"   \n    }\n}","inputVariables":[],"outputVariable":"objExcecao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false},{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false}],"id":"d6c106f7-8bbd-411d-b155-7921b83cfe42","root":false,"$title":"Return Exception","$position":{"top":"71px","left":"1590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"26ad46ae-40e9-467f-9e8a-74f534e5a14d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4af926a2-ee8b-4cef-8c89-b39aabb52753","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FFEC03","label":"GoTo","id":"blip-tag-acaeeeb9-8edb-b4f6-18b1-3ec3103da0c2","canChangeBackground":false}],"id":"26ad46ae-40e9-467f-9e8a-74f534e5a14d","root":false,"$title":"[GO TO]","$position":{"top":"56px","left":"752px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f8889c55-0477-4464-a0a6-1141f90e1cb4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4af926a2-ee8b-4cef-8c89-b39aabb52753","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"2ed26fcb-c649-43c5-8dc8-845c29b174ac","$typeOfContent":"","type":"SetVariable","$title":"Redirect Solution","$invalid":false,"settings":{"variable":"redirectMenu"},"conditions":[]},{"$id":"4119bb17-1735-4d67-a58b-46e216376921","$typeOfContent":"","type":"SetVariable","$title":"Redirect Message","$invalid":false,"settings":{"variable":"redirectMessage"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"664a3e2b-386b-4b5d-837d-2c30f115f814","$invalid":false},"$tags":[{"background":"#FFEC03","label":"GoTo","id":"blip-tag-acaeeeb9-8edb-b4f6-18b1-3ec3103da0c2","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false}],"id":"f8889c55-0477-4464-a0a6-1141f90e1cb4","root":false,"$title":"[GO TO]","$position":{"top":"168px","left":"752px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"da9c0ab0-b985-4135-869e-9578b86ea177":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8d988df5-379e-4cb6-b19c-bc898e85ad9b","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c4d58110-eea2-406c-a3a6-12fe4fa88165","$typeOfContent":"","type":"Redirect","$title":"Redirecionar a um servi√ßo","$invalid":false,"settings":{"address":"{{redirectMenu}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#61D36F","label":"Redirect","id":"blip-tag-faafc359-f558-6880-b0c8-a73f06d80bcb","canChangeBackground":false}],"id":"da9c0ab0-b985-4135-869e-9578b86ea177","root":false,"$title":"[REDIRECT TO] Redirect Solution Principal","$position":{"top":"794px","left":"175px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bcba8755-4417-4ea3-be43-1abe7856b176":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"53b7b68d-9d3e-4a40-8f8e-237865176108","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"d3b7c802-1dc6-4a2a-8b09-78302093870b","$typeOfContent":"","type":"TrackEvent","$title":"Exibicao","$invalid":false,"settings":{"extras":{},"category":"Exibicao","action":"Exibicao"},"conditions":[]},{"$id":"1b3f17bb-aa6c-4aa8-b2d0-f6263ba724ee","$typeOfContent":"","type":"ProcessContentAssistant","$title":"Consultar Assistente de conte√∫do","$invalid":false,"settings":{"text":"{{input.content}}","outputVariable":"contentAssistant","score":"50"},"conditions":[]},{"$id":"632e55c3-d7e1-456a-921b-97d81e69ade9","$typeOfContent":"","type":"ExecuteScript","$title":"PROCESS INPUT","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetOptionSelected}}\n\nconst run = (selected, inputType, intent, platform, apiName, contentAssistant) => {\n    intent = (typeof intent !== 'undefined') ? intent : 'None';\n    platform = (typeof platform !== 'undefined') ? platform : 'BlipChat';\n    apiName = (typeof apiName !== 'undefined') ? apiName : false;\n    contentAssistant = (typeof contentAssistant !== 'undefined') ? contentAssistant : null;\n\n    const itens = [\n        {\n            name: [],\n        },\n    ];\n\n    let validation = {\n        'menuDinamic': true,\n        'isInputNoValidate': false,\n        'isTrueFalse': false,\n        'textLong': false,\n        'intentValidate': false,\n        'isIntent': false,\n        'isOptionMenu': false,\n        'contentAssistant': false,\n        'shortcutMenu': false,\n        'shortcut': false,\n        'badWord': false,\n        'NPS': false,\n        'Email': false,\n        'Cep': false,\n        'Telefone': false,\n        'Celular': false,\n        'CNPJ': false,\n        'CNPJValido': false,\n        'CPF': false,\n        'CPFValido': false,\n        'Quantidade': false,\n        'Data': false,\n        'Numero': false,\n        'Nome': false,\n        'Serial': false,\n        'Pedido': false,\n        'Id': false\n    };\n\n    if (platform === 'WhatsApp') {\n        validation.menuDinamic = false;\n    }\n\n    const mainMenus = [\n        {\n            name: [],\n        },\n    ];\n\n    const shortcuts = [\n        {\n            name: [],\n        },\n    ];\n\n    const selectResponse = getOptionSelected(\n        selected,\n        inputType,\n        itens,\n        validation,\n        intent,\n        mainMenus,\n        shortcuts,\n        apiName,\n        contentAssistant\n    );\n\n    return selectResponse;\n};","inputVariables":["input.content","input.type","input.intent.name","platform"],"outputVariable":"processedInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"13ee6d22-d016-43d5-b2a2-b8bfd5f9a2e7","$typeOfContent":"","type":"ExecuteScript","$title":"LAST STATE WITH INPUT","$invalid":false,"settings":{"function":"run","source":"{{resource.utilGetLastStateWithInput}}\n\nfunction run(stateName, stateId, lastStateWithInputCurrent) {\n    return getLastStateWithInput(stateName, stateId, lastStateWithInputCurrent);\n}","inputVariables":["state.name","state.id","lastStateWithInput"],"outputVariable":"lastStateWithInput","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"notEquals","variable":"state.id","values":["onboarding"]}]},{"$id":"15571201-6177-4b06-aba5-6b01ad89700b","$typeOfContent":"","type":"ExecuteScript","$title":"COUNT EXCEPTION","$invalid":false,"settings":{"function":"run","source":"{{resource.utilGetCountException}}\n\nfunction run(countExceptionCurrent, lastStateWithInput) {\n    return getCountException(countExceptionCurrent, lastStateWithInput);\n}","inputVariables":["countException","lastStateWithInput"],"outputVariable":"countException","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"notEquals","variable":"state.id","values":["onboarding"]}]}],"$leavingCustomActions":[{"$id":"b8dc3b43-4249-4e0e-b1db-fb0e2dea7e85","$typeOfContent":"","type":"ExecuteScript","$title":"APPLY MASK","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionMaskFormat}}\n\nconst run = (input) => {\n    const validacao = {\n        \"Cep\": false,\n        \"Telefone\": false,\n        \"Celular\": false,\n        \"CNPJ\": false,\n        \"CPF\": false,\n        \"Data\": false,\n        \"Hora\": false,\n        \"Numero\": false,\n        \"Placa\": false\n    };\n\n    return setMaskFormat(input, validacao);\n};","inputVariables":["input.content"],"outputVariable":"maskInput"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["no_validation"]}]},{"$id":"208ff8fa-24cd-4411-889d-8e9a0ef13b7a","$typeOfContent":"","type":"SetVariable","$title":"Save Data Mask","$invalid":false,"settings":{"value":"{{maskInput}}","variable":"nome"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["no_validation"]}]},{"$id":"106e11ab-2dae-4290-b9b1-da2a4485a0e7","$typeOfContent":"","type":"TrackEvent","$title":"selecao","$invalid":false,"settings":{"extras":{},"category":"selecao","action":"{{processedInput@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["menu_return"]}]},{"$id":"44e2491f-7af6-44bc-841b-eb0daa1384e5","$typeOfContent":"","type":"TrackEvent","$title":"inesperado","$invalid":false,"settings":{"extras":{},"category":"inesperado","action":"{{input.content}}"},"conditions":[{"source":"context","comparison":"equals","variable":"processedInput@inputRecognized","values":["block_return"]}]},{"$id":"dac5e96e-26c0-47e7-ae52-1b26c5636828","$typeOfContent":"","type":"MergeContact","$title":"Definir contato","$invalid":false,"settings":{"extras":{}},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false},{"background":"#000000","label":"Mask","id":"blip-tag-29ea3b19-027a-d79e-1c03-75d083143911","canChangeBackground":false},{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false},{"background":"#4F0E87","label":"SetContact","id":"blip-tag-f9943d94-9a3b-d32b-4181-d3fead0d17be","canChangeBackground":false},{"background":"#0747A6","label":"ContentAssistant","id":"blip-tag-05e38f88-08c5-6e43-5646-40b1300a7a93","canChangeBackground":false}],"id":"bcba8755-4417-4ea3-be43-1abe7856b176","root":false,"$title":"[Val] [MASK]","$position":{"top":"166px","left":"566px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bed3fe99-6aad-43be-a0fa-6e0d8640a006":{"$contentActions":[{"action":{"$id":"1d526f7e-42f3-48b1-9fe8-e2d5cfa2b4da","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbdcd378-4676-4a03-9795-599dab4eeb0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbdcd378-4676-4a03-9795-599dab4eeb0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"9745033f-05f0-4595-bf56-f59bf328e997","$typeOfContent":"text","type":"SendMessage","settings":{"id":"72080bd5-62b6-4694-b4e5-cba972e5c0e5","type":"text/plain","content":"Some text"},"$cardContent":{"document":{"id":"72080bd5-62b6-4694-b4e5-cba972e5c0e5","type":"text/plain","content":"Some text"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"b5e80ff0-be30-4c1a-b51e-636f52362c6d","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:20"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#CC99FF","label":"UserInput","id":"blip-tag-a135d488-0fbf-29bd-714f-f3388ee2d198","canChangeBackground":false}],"id":"bed3fe99-6aad-43be-a0fa-6e0d8640a006","root":false,"$title":"Input","$position":{"top":"165px","left":"378px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ca6eebf4-d25f-45e0-af59-1c706a4d7e28":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c6bae0c9-5b1f-4a30-a9be-67ff26089e2a","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"70431174-90ab-4d78-bb6e-1e7d06b4db84","typeOfStateId":"state","$connId":"con_23","$id":"60e74614-53de-4b70-aae1-cb0a6cf8725d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f04e3fdc-86ea-4e12-9ec6-e94e46a811fc","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO INICIO AGUARDE EXIBICAO","$invalid":false,"settings":{"extras":{},"category":"Transbordo inicio aguarde exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"70431174-90ab-4d78-bb6e-1e7d06b4db84","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"ca6eebf4-d25f-45e0-af59-1c706a4d7e28","root":false,"$title":"T.1.0.0 - S√≥ um instante que vou chamar algu√©m","$position":{"top":"183px","left":"1207px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"70431174-90ab-4d78-bb6e-1e7d06b4db84":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"0f6f505a-a71d-4739-b5b2-17712ce2c271","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"5ec12e40-8dbf-46d5-a8ad-4a33eab0b1f9","typeOfStateId":"state","$connId":"con_28","$id":"8a161a9f-2c20-4c03-b7df-6772ecb5a67a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"5ec12e40-8dbf-46d5-a8ad-4a33eab0b1f9","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"70431174-90ab-4d78-bb6e-1e7d06b4db84","root":false,"$title":"T.2.0.0 - Verifica Hor√°rio Atendimento","$position":{"top":"340px","left":"1207px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5ec12e40-8dbf-46d5-a8ad-4a33eab0b1f9":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"62de2a74-5798-4c50-bf0a-d07a5d86df30","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"38fd4bf5-fb1f-408e-a4a0-cb67558dc043","typeOfStateId":"state","$connId":"con_33","$id":"b7adc646-f1c1-40b6-a378-475c22b5050e","conditions":[{"source":"context","comparison":"equals","variable":"contact.extras.Equipe","values":["acordoevasao"]}],"$invalid":false},{"stateId":"b59f8cb3-55a0-4cb6-887a-55db507c2f59","typeOfStateId":"state","$connId":"con_38","$id":"5ea2b5e4-e11d-45f7-90ef-ae2b1438a87f","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"attendance@available"}],"$invalid":false},{"stateId":"d7bd60f7-5cb8-40da-8e7a-57b4f602cbb2","typeOfStateId":"state","$connId":"con_43","$id":"c55d5714-3770-4bb8-a51c-2bef4d4be72a","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"attendance@available"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"1181746e-99a4-4fc7-ab4a-9a27ddde878c","$typeOfContent":"","type":"ExecuteScript","$title":"CHECK ATTENDANCE AVAILABILITY","$invalid":false,"settings":{"function":"run","source":"function run(ativarTransbordo) {\n    try {\n        if (\n            ativarTransbordo == null ||\n            ativarTransbordo == undefined ||\n            ativarTransbordo.toUpperCase() != \"SIM\"\n        ) {\n            return false;\n        }\n        return true;\n        \n    } catch (e) {\n        return false;\n    }\n}","inputVariables":["resource.AtivarTransbordo"],"outputVariable":"isAttendanceAvailable","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5cf0adfe-2c02-4760-9729-220ca4ffc716","$typeOfContent":"","type":"ProcessHttp","$title":"CHECKAGENTSAVAILABILITY","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"{{config.token}}"},"method":"POST","body":"{\n  \"id\": \"{{random.guid}}\",\n  \"from\": \"{{application.identifier}}@{{application.domain}}\",\n  \"to\": \"postmaster@desk.msging.net\",\n  \"method\": \"get\",\n  \"uri\": \"/teams/agents-online\"\n}","uri":"https://grupoccr.http.msging.net/commands","responseStatusVariable":"statusAttendanceAvailabilityObj","responseBodyVariable":"responseAttendanceAvailabilityObj"},"conditions":[{"source":"context","comparison":"equals","variable":"isAttendanceAvailable","values":["true"]}]},{"$id":"80e1937e-0a07-4e40-9445-94d5de31a4f5","$typeOfContent":"","type":"ExecuteScript","$title":"PROCESS \"ATTENDANCEOBJ\"","$invalid":false,"settings":{"function":"run","source":"const run = (response_attendance_availability, team_service) => {\n    response_attendance_availability = JSON.parse(response_attendance_availability);\n\n    let attendance = {\n        \"available\": false,\n        \"tracking\": \"Nao\"\n    }\n    let has_attendant = false;\n\n    if(response_attendance_availability.resource && response_attendance_availability.resource.total >= 1){\n        has_attendant = response_attendance_availability.resource.items.find((item) => \n            item.name.toLowerCase() == team_service.toLowerCase() && item.agentsOnline > 0) ? attendance.available = true : attendance.available = false\n    }\n\n    if(attendance.available){\n        attendance.tracking = \"Sim\";\n    }\n    \n    return attendance;\n}","inputVariables":["responseAttendanceAvailabilityObj","resource.actualConcessionary"],"outputVariable":"attendance","LocalTimeZoneEnabled":false},"conditions":[{"source":"context","comparison":"equals","variable":"isAttendanceAvailable","values":["true"]}]}],"$leavingCustomActions":[{"$id":"66d132bd-4ae1-4934-910c-9eaada20b6ca","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO VALIDACAO DE ATENDENTE","$invalid":false,"settings":{"extras":{},"category":"Transbordo validacao de atendente","action":"{{attendance@tracking}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"b59f8cb3-55a0-4cb6-887a-55db507c2f59","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#FF1E90","label":"Http","id":"blip-tag-aefc1f19-48e4-67a4-2d7d-c973d302eaf5","canChangeBackground":false},{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"5ec12e40-8dbf-46d5-a8ad-4a33eab0b1f9","root":false,"$title":"T.3.0.0 - Verifica Disponibilidade Atendentes","$position":{"top":"451px","left":"1208.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed97c101-39e0-422d-abff-8aa5103198eb":{"$contentActions":[{"action":{"$id":"8df39481-8838-4240-9af7-421796744f6c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b9611c03-c2b6-451f-9ce5-834503fffd0c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b9611c03-c2b6-451f-9ce5-834503fffd0c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a10d86f6-cd54-46ca-ae84-45567fa3a610","$typeOfContent":"text","type":"SendMessage","settings":{"id":"d5f40910-5722-41d7-89be-58255a66fa6a","type":"text/plain","content":"‚è∞Nosso atendimento √©:\n\n{{boldTags@open}}24 horas{{boldTags@close}} personalizado e gratuito\n\nVoc√™ pode ligar no {{boldTags@open}}Disque CCR{{boldTags@close}}\n\n{{boldTags@open}}{{resource.TransbordoTelefone}}{{boldTags@close}}","metadata":{}},"$cardContent":{"document":{"id":"d5f40910-5722-41d7-89be-58255a66fa6a","type":"text/plain","content":"‚è∞Nosso atendimento √©:\n\n{{boldTags@open}}24 horas{{boldTags@close}} personalizado e gratuito\n\nVoc√™ pode ligar no {{boldTags@open}}Disque CCR{{boldTags@close}}\n\n{{boldTags@open}}{{resource.TransbordoTelefone}}{{boldTags@close}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7295c8b0-a602-4fd4-916f-604ec4579681","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"aa20e325-115e-4056-86ba-1eb3c70534f8","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO FORA DO HORARIO EXIBICAO","$invalid":false,"settings":{"extras":{},"category":"Transbordo fora do horario exibicao","action":"Exibicao"},"conditions":[]},{"$id":"a2b21b62-99e1-4c19-8807-9a07e096ecae","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO FORA DO HORARIO USERID","$invalid":false,"settings":{"extras":{},"category":"Transbordo fora do horario userid","action":"{{contact.identity}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"64868335-c67e-474c-8efc-1987910db37b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"ed97c101-39e0-422d-abff-8aa5103198eb","root":false,"$title":"T.2.0.1 - Fora do horario","$position":{"top":"191px","left":"1396px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"96d2e95b-4db2-4e66-823b-4b257102d925":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4af926a2-ee8b-4cef-8c89-b39aabb52753","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"2ed26fcb-c649-43c5-8dc8-845c29b174ac","$typeOfContent":"","type":"SetVariable","$title":"Redirect Solution","$invalid":false,"settings":{"variable":"redirectMenu","value":"nps"},"conditions":[]},{"$id":"4119bb17-1735-4d67-a58b-46e216376921","$typeOfContent":"","type":"SetVariable","$title":"Redirect Message","$invalid":false,"settings":{"variable":"redirectMessage","value":"nps"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"664a3e2b-386b-4b5d-837d-2c30f115f814","$invalid":false},"$tags":[{"background":"#FFEC03","label":"GoTo","id":"blip-tag-acaeeeb9-8edb-b4f6-18b1-3ec3103da0c2","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false}],"id":"96d2e95b-4db2-4e66-823b-4b257102d925","root":false,"$title":"[GO TO] NPS","$position":{"top":"956px","left":"1202px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b59f8cb3-55a0-4cb6-887a-55db507c2f59":{"$contentActions":[{"action":{"$id":"d79dfbc4-d57b-4904-8a54-99fa5c632e4c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9d653fc1-b061-4985-90c1-b48b9e30e875","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9d653fc1-b061-4985-90c1-b48b9e30e875","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"71acc207-c2fb-455f-916c-9f2f83c5d20f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"8e95f245-e6ed-4bb1-95e2-8f06cb988272","type":"text/plain","content":"A nossa equipe para o atendimento neste canal, se encontra indispon√≠vel no momento üòï\n\nSe for urg√™ncia voc√™ pode ligar para\n{{n1}}0800 017 35 36{{n2}}","metadata":{}},"$cardContent":{"document":{"id":"8e95f245-e6ed-4bb1-95e2-8f06cb988272","type":"text/plain","content":"A nossa equipe para o atendimento neste canal, se encontra indispon√≠vel no momento üòï\n\nSe for urg√™ncia voc√™ pode ligar para\n{{n1}}0800 017 35 36{{n2}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6ce6402a-0146-4c51-b2f5-e114cbfb88df","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"4161c5d9-19eb-4437-bdc3-8eecf330f757","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO SEM ATENDENTE EXIBICAO","$invalid":false,"settings":{"extras":{},"category":"Transbordo sem atendente exibicao","action":"Exibicao"},"conditions":[]},{"$id":"a2cc79de-d925-400e-88f5-440d48ba9a7a","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO SEM ATENDENTE USERID","$invalid":false,"settings":{"extras":{},"category":"Transbordo sem atendente userid","action":"{{contact.identity}}"},"conditions":[]},{"$id":"1865b23d-bf04-45fc-981a-b256cc689897","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO VALIDACAO DE ATENDENTE","$invalid":false,"settings":{"extras":{},"category":"Transbordo validacao de atendente","action":"Nao"},"conditions":[]},{"$id":"7398585a-77af-488a-a2e4-a687c3df7400","$typeOfContent":"","type":"ExecuteScript","$title":"Executar script","$invalid":false,"settings":{"function":"run","source":"/**\n            * All input variables needs to be passed as function param;\n            * Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n            * Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n            **/\n            function run(concessionary) {\n                var message = \"\";\n\n                switch (concessionary) {\n                    case 'NovaDutra':\n                    message = \"\";\n                    break;\n                    case 'AutoBAn':\n                    message = \"ou em um dos nossos telefones de emerg√™ncia, localizados a cada quil√¥metro das rodovias.\";\n                    break;\n                    case 'Ponte':\n                    message = \"\";\n                    break;\n                    case 'ViaLagos':\n                    message = \"\";\n                    break;\n                    case 'ViaOeste':\n                    message = \"ou em um dos nossos telefones de emerg√™ncia, localizados a cada quil√¥metro das rodovias.\";\n                    break;\n                    case 'SPVias':\n                    message = \"\";\n                    break;\n                    case 'RodoAnel':\n                    message = \"ou em um dos nossos telefones de emerg√™ncia, localizados a cada quil√¥metro das rodovias.\";\n                    break;\n                    case 'RodoNorte':\n                    message = \"\";\n                    break;\n                    case 'MSVia':\n                    message = \"\";\n                    break;\n                    case 'ViaSul':\n                    message = \"\";\n                    break;\n                    case 'ViaCosteira':\n                    message = \"\";\n                    break;\n                }\n\n                return message;\n            }","inputVariables":["actualConcessionary"],"outputVariable":"msgSA","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"64868335-c67e-474c-8efc-1987910db37b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"b59f8cb3-55a0-4cb6-887a-55db507c2f59","root":false,"$title":"T.3.0.1 - Sem atendentes","$position":{"top":"367px","left":"1440px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9":{"$contentActions":[{"input":{"bypass":false,"conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"equals","values":["true"]}],"$cardContent":{"document":{"id":"d12a529f-2c9f-44f7-8c66-4546fcbff12a","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e1a07d70-0531-4a74-b6e5-9256fbf03fc3","typeOfStateId":"state","$connId":"con_48","$id":"a65a5d36-2e6b-4d78-ad47-8a9a11994e35","conditions":[{"source":"input","comparison":"contains","values":["Cancelar consulta"]}],"$invalid":false},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant"]}],"$invalid":false,"stateId":"ca264d13-1328-4a85-b54f-f8bde19458ac","$connId":"con_53","$id":"3498ccfd-12b6-4348-a78a-41f6f23cf90a"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClient"]}],"$invalid":false,"stateId":"ca264d13-1328-4a85-b54f-f8bde19458ac","$connId":"con_83","$id":"4fe8edfd-10b6-4039-b168-1bfcfb195580"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClientInactivity"]}],"$invalid":false,"stateId":"4a7ffd37-6a59-4213-85ca-2cc001d8cf90","$connId":"con_63","$id":"ba286730-b057-45f0-8a78-b5385507e251"}],"$enteringCustomActions":[{"$id":"74e1bb96-e91f-47fb-b017-81944a87334e","$typeOfContent":"","type":"ExecuteScript","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:8d8d079e-0173-4af2-bcf1-28050e50baa9"]},{"source":"context","variable":"tunnel.identity","comparison":"exists","values":[]}],"settings":{"function":"run","source":"function run(contact, tunnel_identity) {\n    contact = JSON.parse(contact);\n    contact.identity = tunnel_identity;\n    return contact;\n}","inputVariables":["contact.serialized","tunnel.identity"],"outputVariable":"deskUpdateTunnelContactBody","LocalTimeZoneEnabled":false}},{"$id":"4795a4dd-408c-472d-b72c-dc8dcc493fb2","$typeOfContent":"","type":"ProcessCommand","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:8d8d079e-0173-4af2-bcf1-28050e50baa9"]},{"source":"context","variable":"tunnel.identity","comparison":"exists","values":[]}],"settings":{"to":"postmaster@msging.net","from":"{{application.identity}}","method":"merge","uri":"/contacts","type":"application/vnd.lime.contact+json","resource":"{{deskUpdateTunnelContactBody}}","variable":"mergeRouterContactWithTunnelCommandResponse"}},{"$id":"39680e04-8d96-4b2c-abe3-3c735458efd0","$typeOfContent":"","type":"ExecuteScript","$title":"GetEncodedContactIdentity","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:8d8d079e-0173-4af2-bcf1-28050e50baa9"]}],"settings":{"function":"run","source":"function run(identity) {\n return (identity !== undefined) ? encodeURIComponent(identity) : identity;\n}","inputVariables":["input.message.fromidentity"],"outputVariable":"helpDeskEncodedFromIdentity","LocalTimeZoneEnabled":false}},{"$id":"61c26e40-ae30-4175-8cf1-c9a4041ecd92","$typeOfContent":"","type":"ProcessCommand","$title":"GetOpenTicket","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:8d8d079e-0173-4af2-bcf1-28050e50baa9"]}],"settings":{"from":"{{application.identifier}}@{{application.domain}}","to":"postmaster@desk.msging.net","method":"get","uri":"/tickets?$filter=customerIdentity%20eq%20%27{{helpDeskEncodedFromIdentity}}%27%20and%20%28status%20eq%20%27Open%27%20or%20status%20eq%20%27Waiting%27%20or%20status%20eq%20%27Assigned%27%29","metadata":{"server.shouldStore":true},"variable":"helpDeskGetOpenTicketCommandResponse"}},{"$id":"b99fddcb-f0ca-4c45-b7fd-46fbffab59a2","$typeOfContent":"","type":"ExecuteScript","$title":"TreatGetOpenTicketResponse","$invalid":false,"conditions":[{"source":"context","variable":"state.previous.id","comparison":"notEquals","values":["desk:8d8d079e-0173-4af2-bcf1-28050e50baa9"]}],"settings":{"function":"run","source":"function run(commandResponse) {\n    var response = JSON.parse(commandResponse)\n    var ticketExists = (response && response.resource && response.resource.items && response.resource.items.length > 0);\n  return ticketExists ? \"true\" : \"false\";\n}","inputVariables":["helpDeskGetOpenTicketCommandResponse"],"outputVariable":"helpDeskHasTicket","LocalTimeZoneEnabled":false}},{"$id":"7ab26d4b-5bd1-4534-b504-eb544cb9a47b","$typeOfContent":"","type":"ProcessCommand","$title":"OpenTicketIfNotFound","$invalid":false,"conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"notEquals","values":["true"]}],"settings":{"from":"{{application.identifier}}@{{application.domain}}","to":"postmaster@desk.msging.net","method":"set","uri":"/tickets/{{helpDeskEncodedFromIdentity}}","variable":"helpDeskOpenTicketCommandResponse","type":"text/plain","resource":"{{input.content}}","metadata":{"server.shouldStore":true}}},{"$id":"577696ac-f6ac-453d-91e1-8ad5ed263f68","$typeOfContent":"","type":"ExecuteScript","$title":"TreatOpenTicketResponse","$invalid":false,"conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"notEquals","values":["true"]}],"settings":{"function":"run","source":"function run(commandResponse) {\n    var response = commandResponse ? JSON.parse(commandResponse) : {}\n    var ticketExists = response && response.type === \"application/vnd.iris.ticket+json\" && response.resource \n    return ticketExists ? \"true\" : \"false\";\n}","inputVariables":["helpDeskOpenTicketCommandResponse"],"outputVariable":"helpDeskHasTicket","LocalTimeZoneEnabled":false}},{"$id":"330c4a15-64d9-4951-a940-659c536a51fc","$typeOfContent":"","type":"ForwardMessageToDesk","conditions":[{"source":"context","variable":"helpDeskHasTicket","comparison":"equals","values":["true"]}],"settings":{},"$invalid":false}],"$leavingCustomActions":[{"$id":"46834bd2-9dbe-4d60-aef5-95776d886545","$typeOfContent":"","type":"SetVariable","$title":"ResetHasTicket","$invalid":false,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant","ClosedClient","ClosedClientInactivity"]}],"settings":{"variable":"helpDeskHasTicket","value":"false","$invalid":false}}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9","$invalid":false},"$tags":[],"id":"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9","deskStateVersion":"2.00","root":false,"$title":"Atendimento humano","$position":{"top":"751px","left":"1199px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ca264d13-1328-4a85-b54f-f8bde19458ac":{"$contentActions":[{"action":{"$id":"e955887e-a7ae-47b5-b9e4-0564d167e678","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"826406d8-a632-4cff-b54c-dbadbf4ee16b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"826406d8-a632-4cff-b54c-dbadbf4ee16b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"a2306aaf-43ca-4f22-9557-734fba73e435","$typeOfContent":"text","type":"SendMessage","settings":{"id":"070a4f39-cc1c-44d3-bd02-daedb1bd159b","type":"text/plain","content":"Atendimento finalizado!\n\nTicket de atendimento: \n{{n1}}{{numTicket}}{{n2}}","metadata":{}},"$cardContent":{"document":{"id":"070a4f39-cc1c-44d3-bd02-daedb1bd159b","type":"text/plain","content":"Atendimento finalizado!\n\nTicket de atendimento: \n{{n1}}{{numTicket}}{{n2}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6e08080e-afb9-45a4-b58c-0c42cd9544cf","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"c2d2a1e3-57fd-4efb-b64b-ac49ea845bd4","$typeOfContent":"","type":"ExecuteScript","$title":"PROCESS \"CONTENTMSG\"","$invalid":false,"settings":{"function":"run","source":"function run(mainSubject){\n    \nconst VEHICLE_ASSISTANCE = 'Solicitar auxilio';\nconst defaultMsg = {\n        \"itemType\": \"text/plain\",\n        \"items\": [\n            \"Agradecemos a informa√ß√£o. Enviaremos uma viatura at√© o local. \"\n        ]\n    };\n\ntry{\n\n    if(mainSubject == VEHICLE_ASSISTANCE){\n        return {\n            \"itemType\": \"text/plain\",\n            \"items\": [\n                \"Agradecemos a informa√ß√£o! ‚ÄãNossa equipe est√° a caminho.\"\n            ]\n        };\n    }\n\n}catch(error){\n    return defaultMsg;\n}\nreturn defaultMsg;\n}","inputVariables":["mainSubject"],"outputVariable":"contentMsg","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"84d7379b-34cb-4901-86a7-fa37eed02121","$typeOfContent":"","type":"SetVariable","$title":"SET ATTENDANCEINFO","$invalid":false,"settings":{"variable":"attendanceInfo","value":"{{input.content}}"},"conditions":[]},{"$id":"252f34c0-b004-4072-8b6e-aa2931331593","$typeOfContent":"","type":"ExecuteScript","$title":"NUMBER TICKET","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    const num = JSON.parse(input).sequentialId;\n\n    return num;\n}","inputVariables":["input.content"],"outputVariable":"numTicket","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c69b71d7-459d-4ce3-a882-4dc600fdec9f","$typeOfContent":"","type":"TrackEvent","$title":"Event - tipoEmergencia - Input","$invalid":false,"settings":{"extras":{},"category":"tipoEmergencia","action":"{{emergencia}} - {{attendanceInfo@tags}}"},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"attendanceInfo"},{"source":"context","comparison":"equals","values":["Emerg√™ncia Sim"],"variable":"emergencia"}]},{"$id":"74af6cd3-11dc-4f9e-87a1-9c6778440cef","$typeOfContent":"","type":"MergeContact","$title":"Reset \"equipe\"","$invalid":false,"settings":{"extras":{"Equipe":"-"}},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contact.extras.Equipe"}]},{"$id":"fc88fdb4-6973-40ce-b52a-bb3951a20f24","$typeOfContent":"","type":"ExecuteScript","$title":"Tag Atendimento","$invalid":false,"settings":{"function":"run","source":"function run(inputContent) {\n\n    inputContent = JSON.parse(inputContent)\n\n    if (inputContent.hasOwnProperty(\"tags\")) {\n        let tags = inputContent.tags;\n        return JSON.stringify(tags)\n    } else {\n        return \"[]\"\n    }\n}","inputVariables":["input.content"],"outputVariable":"tagatendimento","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"96d2e95b-4db2-4e66-823b-4b257102d925","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#FF6F1E","label":"ExecuteScript","id":"blip-tag-13730057-a7af-4307-f591-44893325fd9e","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false}],"id":"ca264d13-1328-4a85-b54f-f8bde19458ac","root":false,"$title":"SET attendanceInfo","$position":{"top":"841px","left":"1202px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4a7ffd37-6a59-4213-85ca-2cc001d8cf90":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ea258376-ef00-487d-a287-fed778335f17","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"ede1ea5d-3150-40c3-ae51-62591cc4127f","$typeOfContent":"","type":"MergeContact","$title":"Reset \"equipe\"","$invalid":false,"settings":{"extras":{"Equipe":"-"}},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contact.extras.Equipe"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"64868335-c67e-474c-8efc-1987910db37b","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"4a7ffd37-6a59-4213-85ca-2cc001d8cf90","root":false,"$title":"SET inactivyInfo","$position":{"top":"753px","left":"1387px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d7bd60f7-5cb8-40da-8e7a-57b4f602cbb2":{"$contentActions":[{"action":{"$id":"b7b700e2-49c1-408a-9bc7-f7145b0737df","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"852f9150-c7fd-4802-a862-92900ed3178c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"852f9150-c7fd-4802-a862-92900ed3178c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"5a7be9fd-3ac8-4776-b69b-e7fb6fdec135","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1cb8cd87-a03b-411e-b7bb-01eaa808a5d4","type":"text/plain","content":"‚è≥ Por favor, aguarde alguns instantes enquanto chamo um atendente.","metadata":{}},"$cardContent":{"document":{"id":"1cb8cd87-a03b-411e-b7bb-01eaa808a5d4","type":"text/plain","content":"‚è≥ Por favor, aguarde alguns instantes enquanto chamo um atendente."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f2c0fcb8-3203-4bc0-9c41-fb9f1b747cbd","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9","typeOfStateId":"state","$connId":"con_68","$id":"c62103dd-96de-470f-8b8b-92906ccd3b99","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8a8b0f28-4343-4c68-9fae-423c978a2659","$typeOfContent":"","type":"TrackEvent","$title":"Transbordo inicio exibicao","$invalid":false,"settings":{"extras":{},"category":"Transbordo inicio exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4abaeb58-30f0-45e8-b87b-1d4e6f32d72c","$typeOfContent":"","type":"TrackEvent","$title":"Transbordo inicio hora","$invalid":false,"settings":{"extras":{},"category":"Transbordo inicio hora","action":"{{calendar.hour}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"d7bd60f7-5cb8-40da-8e7a-57b4f602cbb2","root":false,"$title":"T.4.0.0","$position":{"top":"611px","left":"1439px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"64868335-c67e-474c-8efc-1987910db37b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"4af926a2-ee8b-4cef-8c89-b39aabb52753","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"2ed26fcb-c649-43c5-8dc8-845c29b174ac","$typeOfContent":"","type":"SetVariable","$title":"Redirect Solution","$invalid":false,"settings":{"variable":"redirectMenu","value":"algoMais"},"conditions":[]},{"$id":"4119bb17-1735-4d67-a58b-46e216376921","$typeOfContent":"","type":"SetVariable","$title":"Redirect Message","$invalid":false,"settings":{"variable":"redirectMessage","value":"algoMais"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"664a3e2b-386b-4b5d-837d-2c30f115f814","$invalid":false},"$tags":[{"background":"#FFEC03","label":"GoTo","id":"blip-tag-acaeeeb9-8edb-b4f6-18b1-3ec3103da0c2","canChangeBackground":false},{"background":"#FF4A1E","label":"SetVariable","id":"blip-tag-458cd3fe-cadf-f31e-cc42-66d836c74748","canChangeBackground":false}],"id":"64868335-c67e-474c-8efc-1987910db37b","root":false,"$title":"[GO TO] Algo Mais","$position":{"top":"945px","left":"1384px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"38fd4bf5-fb1f-408e-a4a0-cb67558dc043":{"$contentActions":[{"action":{"$id":"a9647e07-ce00-431f-b84c-6479c8ba1191","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9f3a9137-aede-4c10-bb2a-46295d180a9b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9f3a9137-aede-4c10-bb2a-46295d180a9b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fbbe5c06-a811-4a97-ba7c-0decdb909a44","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{objMenu@content}}"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6ce6402a-0146-4c51-b2f5-e114cbfb88df","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9","typeOfStateId":"state","$connId":"con_73","$id":"b18ac14b-b0cf-4331-8284-5f4f74a0c323","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6b318a09-88cf-4e41-a790-b69cd431dd3e","$typeOfContent":"","type":"ExecuteScript","$title":"DEFINIR MENU","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, boldValue, italicValue) => {\n  let convertPlatform = platform.toLowerCase();\n  let convertBold = boldValue;\n  if (typeof boldValue === typeof toString()) {\n    convertBold = JSON.parse(boldValue);\n  }\n  let convertItalic = italicValue;\n  if (typeof italicValue === typeof toString()) {\n    convertItalic = JSON.parse(italicValue);\n  }\n\n  const default_msg = {\n    \"whatsapp\": {\n      \"button\": {\n        \"active\": true,\n        \"body\": 'N√£o se preocupe com a falta de intera√ß√£o por aqui, assim que a consulta for finalizada eu volto com mais informa√ß√µes!\\n\\nPor√©m, se precisar sair desta etapa, basta selecionar o {{n1}}bot√£o abaixo.{{n2}}',\n        \"options\": ['Cancelar consulta']\n      },\n      \"list\": {\n        \"active\": false,\n        \"header\": '',\n        \"body\": '',\n        \"button\": '',\n        \"title\": '',\n        \"options\": [],\n        \"description\": [],\n        \"footer\": ''\n      },\n      \"template\": {\n        \"active\": false,\n        \"codeTemplate\": \"\",\n        \"nameTemplate\": \"\",\n        \"idiomTemplate\": \"pt_BR\"\n      },\n      \"unsuportedContent\": {\n        \"active\": false,\n        \"body\": '',\n        \"options\": []\n      },\n      \"image\": {\n        \"active\": false,\n        \"url\": '',\n        \"body\": '',\n        \"options\": [],\n        \"footer\": ''\n      }\n    },\n    \"blipchat\": {\n      \"quickReplay\": {\n        \"active\": false,\n        \"addNumber\": false,\n        \"separated\": \"\",\n        \"text\": '',\n        \"options\": [],\n        \"values\": []\n      },\n      \"menu\": {\n        \"active\": true,\n        \"addNumber\": false,\n        \"separated\": \"\",\n        \"text\": 'N√£o se preocupe com a falta de intera√ß√£o por aqui, assim que a consulta for finalizada eu volto com mais informa√ß√µes!\\n\\nPor√©m, se precisar sair desta etapa, basta selecionar o {{n1}}bot√£o abaixo.{{n2}}',\n        \"options\": ['Cancelar consulta'],\n        \"values\": ['Cancelar consulta']\n      },\n      \"link\": {\n        \"active\": false,\n        \"text\": '',\n        \"url\": ''\n      }\n    },\n    \"default\": {\n      \"text\": {\n        \"active\": false,\n        \"addNumber\": false,\n        \"separated\": \"\",\n        \"text\": 'N√£o se preocupe com a falta de intera√ß√£o por aqui, assim que a consulta for finalizada eu volto com mais informa√ß√µes!\\n\\nPor√©m, se precisar sair desta etapa, basta selecionar o {{n1}}bot√£o abaixo.{{n2}}',\n        \"options\": ['Cancelar consulta']\n      },\n      \"textMenu\": {\n        \"active\": false,\n        \"addNumber\": true,\n        \"separated\": \"\",\n        \"text\": '',\n        \"init\": 0,\n        \"subMenuModValue\": false,\n        \"subMenuValues\": [],\n        \"options\": [],\n        \"subMenu\": []\n      }\n    },\n    \"config\": {\n      \"platform\": convertPlatform,\n      \"activeBold\": false,\n      \"boldValue\": convertBold,\n      \"activereplaceBold\": false,\n      \"replaceBold\": {\n        \"open\": \"%%%\",\n        \"close\": \"@@@\"\n      },\n      \"activeItalic\": false,\n      \"italicValue\": convertItalic,\n      \"activereplaceItalic\": false,\n      \"replaceItalic\": {\n        \"open\": \"###\",\n        \"close\": \"&&&\"\n      },\n      \"BreakLine\": '\\n',\n      \"replaceBreakLine\": '---',\n      \"replaceToBreakLine\": '___'\n    }\n  };\n\n  return getMenuForPlatform(default_msg);\n};","inputVariables":["platform","boldValue","italicValue"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4161c5d9-19eb-4437-bdc3-8eecf330f757","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO SEM ATENDENTE EXIBICAO","$invalid":false,"settings":{"extras":{},"category":"Transbordo sem atendente exibicao","action":"Exibicao"},"conditions":[]},{"$id":"a2cc79de-d925-400e-88f5-440d48ba9a7a","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO SEM ATENDENTE USERID","$invalid":false,"settings":{"extras":{},"category":"Transbordo sem atendente userid","action":"{{contact.identity}}"},"conditions":[]},{"$id":"1865b23d-bf04-45fc-981a-b256cc689897","$typeOfContent":"","type":"TrackEvent","$title":"TRANSBORDO VALIDACAO DE ATENDENTE","$invalid":false,"settings":{"extras":{},"category":"Transbordo validacao de atendente","action":"Nao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":["Cancelar consulta"],"$defaultOutput":{"stateId":"desk:8d8d079e-0173-4af2-bcf1-28050e50baa9","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#167491","label":"Event","id":"blip-tag-7fdca123-c247-340f-96b0-96f4620c06eb","canChangeBackground":false}],"id":"38fd4bf5-fb1f-408e-a4a0-cb67558dc043","root":false,"$title":"T.4.0.0 [Acordo/Evas√£o]","$position":{"top":"594px","left":"926px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e1a07d70-0531-4a74-b6e5-9256fbf03fc3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"2408e195-b7d8-4066-9814-0615f894c32f","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2072"}],"$conditionOutputs":[{"stateId":"64868335-c67e-474c-8efc-1987910db37b","typeOfStateId":"state","$connId":"con_78","$id":"9398c20a-1521-4777-bb16-3ffadc5ec0ed","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:2093"}],"$invalid":false,"$$hashKey":"object:2087"}],"$enteringCustomActions":[{"$id":"8d05636a-968f-4d8d-a902-8f9347d0879b","$typeOfContent":"","type":"SetVariable","$title":"ticketId","$invalid":false,"settings":{"variable":"ticketId","value":"{{helpdeskopenticketcommandresponse@resource.id}}"},"conditions":[]},{"$id":"833b5974-8de4-4f95-be6b-7026f5dc4720","$typeOfContent":"","type":"ProcessHttp","$title":"Change Status","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"{{config.token}}"},"method":"POST","body":"{\n    \"id\": \"{{$guid}}\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"method\": \"set\",\n    \"uri\": \"/tickets/change-status\",\n    \"type\": \"application/vnd.iris.ticket+json\",\n    \"resource\": {\n        \"id\": \"{{ticketId}}\",\n        \"status\": \"ClosedClient\"\n    }\n}","uri":"https://ccrriosp.http.msging.net/commands","responseStatusVariable":"statusClose","responseBodyVariable":"responseClose"},"conditions":[]},{"$id":"78b1a880-3f31-47a9-983a-41b1b8a3876d","$typeOfContent":"","type":"ProcessHttp","$title":"Fechar Ticket","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"method":"POST","body":"{\n    \"id\": \"44ffea8b-2a9a-43bb-b6e0-617c17955f4e\",\n    \"method\": \"set\",\n    \"to\": \"postmaster@desk.msging.net\",\n    \"uri\": \"/tickets/{{ticketId}}/close\",\n    \"type\": \"application/vnd.iris.ticket+json\",\n    \"resource\": {\n        \"closedBy\": \"agent%40email.net@blip.ai\",\n        \"tags\": [\n            \"Encerrado pelo Cliente\"\n        ]\n    }\n}","uri":"https://ccrriosp.http.msging.net/commands","responseStatusVariable":"fecharTicketStatus","responseBodyVariable":"fecharTicketResponse"},"conditions":[]},{"$id":"68371608-82da-4584-97ed-65b0a141871e","$typeOfContent":"","type":"MergeContact","$title":"Reset \"equipe\"","$invalid":false,"settings":{"extras":{"Equipe":"-"}},"conditions":[{"source":"context","comparison":"exists","values":[],"variable":"contact.extras.Equipe"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"64868335-c67e-474c-8efc-1987910db37b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#FF1E90","label":"Http","id":"blip-tag-aefc1f19-48e4-67a4-2d7d-c973d302eaf5","canChangeBackground":false}],"id":"e1a07d70-0531-4a74-b6e5-9256fbf03fc3","root":false,"$title":"Close a Ticket as a user [API]","$position":{"top":"815px","left":"993px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#f06292","textColor":"#000000","commentsIdList":[]}},"c1f0627c-744d-411d-8f03-e6ea61db6252":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ed8680b1-2fe7-40b1-a10e-4348dd0427f4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:3204"}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"b07e05be-6146-4453-971e-fb49aec2012c","$typeOfContent":"","type":"ProcessHttp","$title":"Mudar Status Ticket","$invalid":false,"settings":{"headers":{"Authorization":"{{config.token}}","Content-Type":"application/json"},"uri":"https://ccrriosp.http.msging.net/commands","method":"POST","body":"{\n   \"id\":\"{{random.guid}}\",\n   \"to\":\"postmaster@desk.msging.net\",\n   \"method\":\"set\",\n   \"uri\":\"/tickets/change-status\",\n   \"type\":\"application/vnd.iris.ticket+json\",\n   \"resource\":{\n      \"id\":\"{{ticketId}}\",\n      \"status\":\"ClosedClient\"\n   }\n}","responseStatusVariable":"statusEncerra","responseBodyVariable":"responseEncerra"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"c1f0627c-744d-411d-8f03-e6ea61db6252","root":false,"$title":"Novo bloco","$position":{"top":"559px","left":"499px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}