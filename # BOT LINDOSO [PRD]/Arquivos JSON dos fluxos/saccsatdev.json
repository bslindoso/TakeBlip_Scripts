{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"e46361e2-38f5-4e9b-9ea8-7d7795f3712f","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"welcome","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"713f5ae5-024c-48ce-a665-476b11ff8d12","$connId":"con_3","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"168px","left":"374px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"d514b2b9-4f0c-421c-9f79-9fa54ff89dcc","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"377afe1e-202d-4223-9c32-b36c39c0b811","typeOfStateId":"state","$connId":"con_8","$id":"a2218525-d54a-4459-8b4e-2ad124f0ad8e","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"377afe1e-202d-4223-9c32-b36c39c0b811","typeOfStateId":"state","$connId":"con_13","$id":"1a305d89-8f67-4c09-b258-ea3746b7f5b2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"bc4b6a27-7c8d-48f2-bd45-63fa4a733227","$typeOfContent":"","type":"ExecuteScript","$title":"exception","$invalid":false,"settings":{"function":"run","source":"function run(previousState, typeInput) {\n    try {\n        typeInput = JSON.parse(typeInput).input\n        let idFormated = previousState.split(' ');\n        idFormated = idFormated[0].replace(/\\[/g,'').replace(/\\]/g,'').replace(/\\./g,'');\n        const exception = {\n            id: `${idFormated}`,\n            input: '{{input.content}}',\n            redirectMenu: `${typeInput}`\n        }\n        return exception\n    }\n    catch (e) {\n        return 'error'\n    }\n}","inputVariables":["state.previous.name","validInputJs"],"outputVariable":"exception","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#FF961E","label":"executeScript","id":"blip-tag-10da33cd-3fdf-48d2-f8c7-275ffd02103c","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"122px","left":"877px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f961d4b1-ed0e-4055-8a4c-65a8c884cedb","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"959b012a-ccc6-442f-b9a0-28ea0ae1b8d8","typeOfStateId":"state","$connId":"con_18","$id":"4c701ca2-f14b-44c6-a2e2-8a66dc700445","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"returnException"}],"$invalid":false},{"stateId":"c9d0c48a-7d6b-468b-9458-41577eea43f7","typeOfStateId":"state","$connId":"con_23","$id":"547fe83f-0afb-43c2-916c-a7a82bca8415","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"fdc1d3a5-3c54-4f20-936f-e3b3dd4d1ddd","$typeOfContent":"","type":"SetVariable","$title":"service","$invalid":false,"settings":{"variable":"service","value":"saccsat"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"welcome","$title":"[REQUERIMENTS]","$position":{"top":"268px","left":"376px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#000000","textColor":"#ffffff"}},"c9d0c48a-7d6b-468b-9458-41577eea43f7":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"fallback","typeOfStateId":"state","$connId":"con_28","$id":"3da54f7a-133f-4e6c-89bd-0dc7cc3bdc84","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"d0b8fdd6-7718-48f3-b3ad-8a9dd537f898","typeOfStateId":"state","$connId":"con_33","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["5","4"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"44483a8a-fd47-402a-807b-b50c46d02e96","typeOfStateId":"state","$connId":"con_38","$id":"3eff8c2b-4003-49f3-a732-5d56cd43750c","conditions":[{"source":"context","comparison":"equals","values":["3","2","1"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"79699b3e-9792-4285-afc5-b5aa42552260","typeOfStateId":"state","$connId":"con_43","$id":"303f5508-4559-41a4-91c3-816831033608","conditions":[{"source":"context","comparison":"equals","values":["MENU"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","typeOfStateId":"state","$connId":"con_48","$id":"7e7cff67-6680-44da-9e70-bb398a9a0334","conditions":[{"source":"context","comparison":"equals","values":["SAIR"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': 'Qual nota voc√™ daria para a qualidade de nosso atendente?',\n    'options': [\"‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Excelente)\", \"‚≠ê‚≠ê‚≠ê‚≠ê (Bom)\", \"‚≠ê‚≠ê‚≠ê (Regular)\", \"‚≠ê‚≠ê (Ruim)\", \"‚≠ê (P√©ssimo)\"],\n    'values': [\"5\", \"4\", \"3\", \"2\", \"1\"],\n    'description': [],\n    'itens': [\n      { name: ['5'] },\n      { name: ['4'] },\n      { name: ['3'] },\n      { name: ['2'] },\n      { name: ['1'] }\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${ i + 1 }`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": false,\n      \"whatsappList\": true,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": false,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8940abf0-026c-43a6-b327-285522bdc4b3","$typeOfContent":"","type":"TrackEvent","$title":"quero te ouvir exibicao","$invalid":false,"settings":{"extras":{},"category":"quero te ouvir exibicao","action":"Exibicao"},"conditions":[]},{"$id":"6146ae07-d367-4b08-9daa-f2a8e356a3fc","$typeOfContent":"","type":"TrackEvent","$title":"nota exibicao","$invalid":false,"settings":{"extras":{},"category":"nota exibicao","action":"Exibicao"},"conditions":[{"source":"input","comparison":"exists","values":[]}]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    try {\n\n        input = input.normalize('NFD').replace(/[\\u0300-\\u036f]/g, \"\")\n        input = input.toUpperCase()\n\n        let opcao = [\n            { name: [`ERRO NOTA`, 'OI'] },\n            { name: ['5', '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (EXCELENTE)', '5.', 'CINCO'] },\n            { name: ['4', '‚≠ê‚≠ê‚≠ê‚≠ê (BOM)', '4.', 'QUATRO'] },\n            { name: ['3', '‚≠ê‚≠ê‚≠ê (REGULAR)', '3.', 'TRES'] },\n            { name: ['2', '‚≠ê‚≠ê (RUIM)', '2.', 'DOIS'] },\n            { name: ['1', '‚≠ê (PESSIMO)', '1.', 'UM'] },\n            { name: ['MENU', 'VOLTAR AO INICIO', 'REINICIAR'] },\n            { name: ['SAIR'] }\n        ]\n\n        for (i = 0; i < opcao.length; i++) {\n            for (x = 0; x < opcao[i].name.length; x++) {\n                if (opcao[i].name[x] == (input)) {\n                    return {type: 'success', input: opcao[i].name[0], validation: 'Nota'}\n                    \n                }\n            }\n        }\n        return {type: 'error', input: `ERRO NOTA`, validation: 'Nota'}\n    }\n    catch (e) {\n        return {type: 'error', input: `ERRO SCRIPT`, validation: 'Nota'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"056fcc22-7bd5-4068-b861-1fab1d467d8f","$typeOfContent":"","type":"SetVariable","$title":"score","$invalid":false,"settings":{"variable":"score","value":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]},{"source":"input","comparison":"exists","values":[]}]},{"$id":"ca0780fb-4590-4991-b281-fda1d115b2b6","$typeOfContent":"","type":"TrackEvent","$title":"avaliacao chatbot selecao","$invalid":false,"settings":{"extras":{},"category":"avaliacao chatbot selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","values":["success"],"variable":"validInputJs@type"},{"source":"input","comparison":"exists","values":[]}]},{"$id":"66155932-cd0b-4c34-9628-39d25d459551","$typeOfContent":"","type":"TrackEvent","$title":"nota inesperado","$invalid":false,"settings":{"extras":{},"category":"nota inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"813414c9-d940-47f2-b66e-c12391ad47ac","$typeOfContent":"","type":"TrackEvent","$title":"nota input","$invalid":false,"settings":{"extras":{},"category":"nota input","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-c54b55c8-285f-be44-167f-ddb9370efbe9","canChangeBackground":false},{"background":"#FF6F1E","label":"executeScript","id":"blip-tag-df3af129-53bb-ec72-481d-85ae1c73cfe0","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"c9d0c48a-7d6b-468b-9458-41577eea43f7","$title":"[CS.1.1.0] [MENU] - Avalia√ß√£o","$position":{"top":"380px","left":"376px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d0b8fdd6-7718-48f3-b3ad-8a9dd537f898":{"$contentActions":[{"action":{"$id":"dae27844-162c-4bc1-9de5-52025a93cfb2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f2e65761-b1bd-4544-b1c5-da48ade2b312","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f2e65761-b1bd-4544-b1c5-da48ade2b312","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c23164f1-318f-4b95-bc2c-2b9d6a872dd6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3b86a634-70e0-44ea-a404-b0a78ad874ca","type":"text/plain","content":"Fiquei feliz em saber disso. Muito obrigada! ü§©","metadata":{}},"$cardContent":{"document":{"id":"3b86a634-70e0-44ea-a404-b0a78ad874ca","type":"text/plain","content":"Fiquei feliz em saber disso. Muito obrigada! ü§©"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7df22ccf-7add-47a7-a5fa-b05285e46802","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"0d68c4ef-1cae-474d-8000-52d4518e35c9","$typeOfContent":"","type":"TrackEvent","$title":"csat nota alta exibicao","$invalid":false,"settings":{"extras":{},"category":"csat nota alta exibicao","action":"Exibicao"},"conditions":[]},{"$id":"f08fd0f7-65b5-4226-9e03-9715554ca400","$typeOfContent":"","type":"TrackEvent","$title":"csat humano positiva relatorio","$invalid":false,"settings":{"extras":{},"category":"csat humano positiva relatorio","action":"{{contact.name}} | {{phone}} | {{score}} | {{ticket}} | {{menuOptEscolhido}}"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-2664cb57-327e-f755-8a3a-fd0d71ef0745","canChangeBackground":false}],"id":"d0b8fdd6-7718-48f3-b3ad-8a9dd537f898","root":false,"$title":"[CS.1.3.0] Nota Alta","$position":{"top":"534.111px","left":"228.333px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8e8437dc-8fe9-44b0-ab6e-a25e7ddbcf7d":{"$contentActions":[{"action":{"$id":"40ccc244-df19-4bf9-a7d1-e4f5f4c46722","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19eb619d-6f11-4923-b326-72ab8352b8ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b5a6f654-d2d1-4e03-b68a-1f821b914c28","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{objMenu@type}}","rawContent":"{{contentJs}}"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be996d59-606a-485c-bd73-cb31970b6f66","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"79699b3e-9792-4285-afc5-b5aa42552260","typeOfStateId":"state","$connId":"con_53","$id":"4b50d6da-6cf1-44f9-bdd4-b7dcf8db0efe","conditions":[{"source":"context","comparison":"equals","values":["MENU"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","typeOfStateId":"state","$connId":"con_58","$id":"3eff8c2b-4003-49f3-a732-5d56cd43750c","conditions":[{"source":"context","comparison":"equals","values":["Encerrar","SAIR","N√£o, quero encerrar"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"d207d526-bf88-4dab-acc4-733a83d163d4","typeOfStateId":"state","$connId":"con_63","$id":"193e696a-490b-4ec2-bc53-b712ddbbf686","conditions":[{"source":"context","comparison":"equals","values":["Outro Motivo"],"variable":"validInputJs@input"}],"$invalid":false},{"stateId":"ed95ebbf-b2a4-4655-b3c4-1a9305ee7345","typeOfStateId":"state","$connId":"con_68","$id":"27f0a842-7e33-45ce-b5cf-dc880b1372f3","conditions":[{"source":"context","comparison":"equals","values":["Fui mal atendido(a)","Ainda sem solu√ß√£o","Ainda com d√∫vidas"],"variable":"validInputJs@input"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"0af07bf9-f694-4636-a08b-fc1d339ed605","$typeOfContent":"","type":"ExecuteScript","$title":"inputOptionJs","$invalid":false,"settings":{"function":"run","source":"function run() {\n\n  let properties = {\n    'text': `{{n1}}Escolha um dos motivos para a sua nota{{n2}} para que possamos melhorar o seu atendimento.`,\n    'options': [\"Fui mal atendido(a)\", \"Ainda sem solu√ß√£o\", \"Ainda com d√∫vidas\", \"Outro motivo\"],\n    'values': [\"Fui mal atendido(a)\", \"Ainda sem solu√ß√£o\", \"Ainda com d√∫vidas\", \"Outro motivo\"],\n    'description': [],\n    'itens': [\n      { name: ['Fui mal atendido(a)'] },\n      { name: ['Ainda sem solu√ß√£o'] },\n      { name: ['Ainda com d√∫vidas'] },\n      { name: ['Outro motivo'] },\n    ]\n  }\n\n  properties.itens = addItensNumeracao(properties.itens);\n\n  // Adi√ß√£o de op√ß√µes sem numera√ß√£o\n  let opcoesExtras = [\n    { name: ['Menu', 'Voltar ao in√≠cio', 'Reiniciar'] },\n    { name: ['Sair', 'Finalizar', 'Encerrar'] }\n  ]\n\n  opcoesExtras = addItens(opcoesExtras);\n\n  for (let i = 0; i < opcoesExtras.length; i++) {\n    properties.itens.push(opcoesExtras[i]);\n  }\n\n  return JSON.stringify(properties);\n}\n\nfunction addItens(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n  }\n  return newItens;\n}\n\nfunction addItensNumeracao(itens) {\n  let newItens = [];\n  let newNames;\n  let name;\n  let match;\n  for (let i = 0; i < itens.length; i++) {\n    name = itens[i].name;\n    newNames = []\n    for (let y = 0; y < itens[i].name.length; y++) {\n      match = name[y];\n      newNames.push(match);\n      // Adiciona uma varia√ß√£o lowerCase e UpperCase para cada op√ß√£o do itens\n      newNames.push(match.toLowerCase());\n      newNames.push(match.toUpperCase());\n      newItens[i] = { name: newNames };\n    }\n    newNames.push(`${ i + 1 }`); // Acrescenta numera√ß√£o autom√°tica\n  }\n  return newItens;\n} \n","inputVariables":[],"outputVariable":"inputOptionJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"181a73ce-4d24-4c10-90f2-d2e8c352791e","$typeOfContent":"","type":"ExecuteScript","$title":"objMenu","$invalid":false,"settings":{"function":"run","source":"{{resource.FunctionGetMenu}}\n\nconst run = (platform, menu) => {\n  let convertPlatform = platform.toLowerCase();\n  menu = JSON.parse(menu);\n  platform = platform.toLowerCase();\n\n  if (platform == 'instagram' || platform == 'messenger') {\n    const objectType = {\n      'type': `text/plain`\n    }\n    return objectType\n  };\n\n  let default_msg = {\n    \"text\": menu.text,\n    \"header\": 'Menu',\n    \"body\": menu.text,\n    \"footer\": '',\n    \"button\": 'Menu',\n    \"title\": 'Menu',\n    \"namespaceTemplate\": '',\n    \"nameTemplate\": '',\n    \"options\": menu.options,\n    \"values\": menu.values,\n    \"submenu\": [],\n    \"description\": menu.description,\n    \"menuScope\": {\n      \"whatsappButton\": true,\n      \"whatsappList\": false,\n      \"blipchatQuickReply\": false,\n      \"blipchatMenu\": true,\n      \"defaultText\": false,\n      \"platform\": convertPlatform\n    },\n  };\n\n  var newMenu = getMenuForPlatform(default_msg);\n\n  return newMenu;\n};","inputVariables":["platform","inputOptionJs"],"outputVariable":"objMenu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"18db78c0-fa11-4575-866e-6f13d900f271","$typeOfContent":"","type":"ExecuteScript","$title":"contentJs","$invalid":false,"settings":{"function":"run","source":"function run(menu, platform, objMenu) {\n  objMenu = JSON.parse(objMenu);\n  platform = platform.toLowerCase();\n\n  switch (platform) {\n    case 'instagram':\n      return geraMenuNumerico(menu);\n\n    case 'messenger':\n      return geraMenuNumerico(menu);\n\n    default:\n      return objMenu.content;\n  }\n}\n\nfunction geraMenuNumerico(menu) {\n  menu = JSON.parse(menu);\n\n  let listaOptions = '\\n\\n';\n  for (let i = 0; i < menu.options.length; i++) {\n    listaOptions = listaOptions + (i + 1) + '. ' + menu.options[i] + '\\n';\n  }\n\n  return menu.text + listaOptions;\n}","inputVariables":["inputOptionJs","platform","objMenu"],"outputVariable":"contentJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ee7f20f2-6581-44e1-99b3-dbb09af51957","$typeOfContent":"","type":"TrackEvent","$title":"csat nota baixa exibicao","$invalid":false,"settings":{"extras":{},"category":"csat nota baixa exibicao","action":"Exibicao"},"conditions":[]},{"$id":"0af694ca-acda-4473-9fd6-902752b5ca9d","$typeOfContent":"","type":"TrackEvent","$title":"menu motivo da nota negativa exibicao","$invalid":false,"settings":{"extras":{},"category":"menu motivo da nota negativa exibicao","action":"Exibicao"},"conditions":[]},{"$id":"375c4898-e102-419c-9a3a-a355848a3d2b","$typeOfContent":"","type":"TrackEvent","$title":"csat humano negativo relatorio","$invalid":false,"settings":{"extras":{},"category":"avaliacao chatbot regular ruim pessimo relatorio","action":"{{contact.name}} | {{phone}} | {{score}} | {{ticket}} | {{menuOptEscolhido}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4c3fd580-c601-45cc-8eae-e805e71a605f","$typeOfContent":"","type":"ExecuteScript","$title":"validInputJs","$invalid":false,"settings":{"function":"run","source":"// ============================================================================\n//      TYPE\n// ============================================================================\n// - reserved => quando h√° alguma palavra reservada que o bot dever√° processar, \n// como SAIR E MENU por exemplo\n// - error => quando alguma valida√ß√£o dever√° retornar um erro para cair em exce√ß√£o\n// - success => quando a valida√ß√£o foi bem sucedida.\n// ============================================================================\n//      INPUT\n// ============================================================================\n// Retorna o input ap√≥s processamento.\n// - Se type == error => o input ser√° a descri√ß√£o do erro. Ex: ERRO CEP\n// - Se type == success => o input ser√° o input original processado.\n// ============================================================================\n//      VALIDATION\n// ============================================================================\n// Retorna em qual valida√ß√£o o input foi processado. Ex: cep\n// ============================================================================\n{{resource.FunctionProcessInput}}\n\nfunction run(input, inputType, platform, menu) {\n    try {\n\n        // =================================================================================\n        //             ATEN√á√ÉO: MANIPULAR SOMENTE AS DUAS CONSTANTES A SEGUIR\n        // =================================================================================\n        // - validacaoMenu => true para valida√ß√£o de Menu, false para Input\n        // - validacoesInput => insira aqui que tipo de valida√ß√£o de input vai ser  \n        //   necess√°rio (se mais de um for selecionado, apenas o mais acima ser√° validado)\n        // - erroMenuEspecial => altere somente se, caso a valida√ß√£o seja um Menu e para\n        //   este menu haja um tratamento diferente de exce√ß√£o.\n        // =================================================================================\n        const validacaoMenu = true;\n        const erroMenuEspecial = 'ERRO DINAMICO';\n        const validacoesInput = {\n            data: false,\n            email: false,\n            cep: false,\n            img: false,\n            imgTxt: false,\n            nome: false\n        };\n        // ========================================================================\n\n        // Inicia o objeto que ser√° retornado pela fun√ß√£o\n        let processedInput = {\n            'type': null,\n            'input': null,\n            'validation': 'none'\n        }\n\n        // Verifica se o usu√°rio digitou SAIR ou MENU\n        if (input == 'sair' || input == 'SAIR' || input == 'Sair') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'SAIR'\n            return JSON.stringify(processedInput)\n        } else if (input == 'menu' || input == 'MENU' || input == 'Menu') {\n            processedInput.type = 'reserved'\n            processedInput.input = 'MENU'\n            return JSON.stringify(processedInput)\n        }\n\n        // Formata vari√°veis\n        menu = JSON.parse(menu);\n        platform = platform.toUpperCase()\n\n        if (validacaoMenu) {\n            // Valida√ß√£o de MENU\n            processedInput = validaMenu(input, menu, platform)\n\n            // Verifica se precisa mudar a mensagem de erro do Menu Din√¢mico para o Especial\n            if ((processedInput.input == 'ERRO DINAMICO' || processedInput.input == 'ERRO NUMERICO') && erroMenuEspecial != '') {\n                processedInput.input = erroMenuEspecial; \n            }\n            return JSON.stringify(processedInput);\n\n        } else {\n            // Valida√ß√£o de INPUT\n            const val = Object.entries(validacoesInput);\n            processedInput = validaInput(val, input, inputType)\n\n            // Se nenhuma valida√ß√£o foi processada, retorna o input sem valida√ß√£o\n            if (processedInput.input == 'INPUT SEM VALIDA√á√ïES') {\n                return JSON.stringify({type: 'success', input: input, validation: 'none'});\n\n            } else {\n                return JSON.stringify(processedInput);\n            }\n        }\n\n    } catch (e) {\n        return {type: 'error', input: 'ERRO INESPERADO', validation: 'none'}\n    }\n}","inputVariables":["input.content","input.type","platform","inputOptionJs"],"outputVariable":"validInputJs"},"conditions":[]},{"$id":"7834d7d6-0901-47a7-8f76-9e857ae74938","$typeOfContent":"","type":"TrackEvent","$title":"menu motivo da nota negativa selecao","$invalid":false,"settings":{"extras":{},"category":"menu motivo da nota negativa selecao","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]},{"$id":"859391b8-323c-4c7b-9355-631dc5c26b1c","$typeOfContent":"","type":"TrackEvent","$title":"menu motivo da nota negativa input inesperado","$invalid":false,"settings":{"extras":{},"category":"menu motivo da nota negativa input inesperado","action":"{{input.content}}"},"conditions":[{"source":"input","comparison":"exists","values":[]},{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["error","reserved"]}]},{"$id":"f28834f0-151f-40e2-b6ff-0771c9406b61","$typeOfContent":"","type":"TrackEvent","$title":"avaliacao csat humano motivo da nota relatorio","$invalid":false,"settings":{"extras":{},"category":"avaliacao csat humano motivo da nota relatorio","action":"{{validInputJs@input}}"},"conditions":[{"source":"context","comparison":"equals","variable":"validInputJs@type","values":["success"]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-ed2ab0b6-d476-fa9f-0ed2-e09dd9fec033","canChangeBackground":false},{"background":"#FF961E","label":"ExecuteScript","id":"blip-tag-4cffa4e2-3244-409f-90a7-9fff4b556eb1","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-59565120-de68-cdcc-653c-94c14e2b5e9e","canChangeBackground":false}],"id":"8e8437dc-8fe9-44b0-ab6e-a25e7ddbcf7d","$title":"[CS.1.5.0] [MENU] - Nota Baixa","$position":{"top":"638px","left":"557px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#455a64","textColor":"#ffffff"}},"d207d526-bf88-4dab-acc4-733a83d163d4":{"$contentActions":[{"action":{"$id":"3aa84a5f-0709-4bb8-ab62-bb9a4a9d02ac","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"360fef91-7651-4fb9-97cb-4c0cccc3e238","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"360fef91-7651-4fb9-97cb-4c0cccc3e238","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"af03f14a-cfa5-4924-8fac-a29a76806e00","$typeOfContent":"text","type":"SendMessage","settings":{"id":"00f9b6d7-30f1-48cf-92ee-cddb8ac77ff5","type":"text/plain","content":"Entendi! Pode digitar o motivo. ","metadata":{}},"$cardContent":{"document":{"id":"00f9b6d7-30f1-48cf-92ee-cddb8ac77ff5","type":"text/plain","content":"Entendi! Pode digitar o motivo. "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"f7041af0-d48e-4b95-a7cd-dcfffb7efaa1","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:30"},"$invalid":false}],"$conditionOutputs":[{"stateId":"79699b3e-9792-4285-afc5-b5aa42552260","typeOfStateId":"state","$connId":"con_73","$id":"c373f99f-8317-4540-898b-86cc59e2c59b","conditions":[{"source":"input","comparison":"equals","values":["menu","inicio","reiniciar"]}],"$invalid":false},{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","typeOfStateId":"state","$connId":"con_78","$id":"3c56b049-518f-4193-a7a2-15d6820b224c","conditions":[{"source":"input","comparison":"equals","values":["sair","finalizar","encerrar"]}],"$invalid":false},{"stateId":"582d43f4-d4e7-4da0-a981-944bc62707dd","typeOfStateId":"state","$connId":"con_83","$id":"f05384ee-3238-4258-b80a-0cbae5cd2cee","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"67fea08f-968d-4c84-a5a0-128487517052","$typeOfContent":"","type":"TrackEvent","$title":"solicita para digitar o motivo exibicao","$invalid":false,"settings":{"extras":{},"category":"solicita para digitar o motivo exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[{"$id":"59dbda94-6e35-49c7-adca-d632283aa2e5","$typeOfContent":"","type":"SetVariable","$title":"motivo nota baixa","$invalid":false,"settings":{"variable":"motivo","value":"{{input.content}}"},"conditions":[]},{"$id":"b72281fb-0eaf-46c1-8201-6445491fd3c0","$typeOfContent":"","type":"TrackEvent","$title":"motivo nota baixa","$invalid":false,"settings":{"extras":{},"category":"motivo nota baixa","action":"{{motivo}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-2664cb57-327e-f755-8a3a-fd0d71ef0745","canChangeBackground":false},{"background":"#FFEC03","label":"userInput","id":"blip-tag-75aa2141-c180-cddf-606b-031dca4c04f1","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"d207d526-bf88-4dab-acc4-733a83d163d4","root":false,"$title":"[CS.1.9.0] Outro Motivo","$position":{"top":"769.75px","left":"554.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"582d43f4-d4e7-4da0-a981-944bc62707dd":{"$contentActions":[{"action":{"$id":"3a15d034-6c81-4145-bdfa-f3100b48a8fa","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4be9ad42-622f-4c78-9b60-b98f11e422d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4be9ad42-622f-4c78-9b60-b98f11e422d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c452b1ae-aaaa-4450-a82f-4dae91d9b1f1","$typeOfContent":"text","type":"SendMessage","settings":{"id":"934caca6-3c9a-4fc0-963d-5cc6e4f9b501","type":"text/plain","content":"Agradecemos pela sua {{n1}}opini√£o.{{n2}}","metadata":{}},"$cardContent":{"document":{"id":"934caca6-3c9a-4fc0-963d-5cc6e4f9b501","type":"text/plain","content":"Agradecemos pela sua {{n1}}opini√£o.{{n2}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7df22ccf-7add-47a7-a5fa-b05285e46802","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"227fd0ec-4025-49c7-a3da-9f898546cd17","$typeOfContent":"","type":"TrackEvent","$title":"agradecimento exibicao","$invalid":false,"settings":{"extras":{},"category":"agradecimento exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-2664cb57-327e-f755-8a3a-fd0d71ef0745","canChangeBackground":false}],"id":"582d43f4-d4e7-4da0-a981-944bc62707dd","root":false,"$title":"[CS.1.6.1] Obrigado","$position":{"top":"897px","left":"556.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"377afe1e-202d-4223-9c32-b36c39c0b811":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f4a76ec3-f892-4cad-ad43-60297c09eb7b","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3fb7ef00-299c-4276-8405-acb5cf3a78a4","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Exce√ß√µes","$invalid":false,"settings":{"context":{"type":"text/plain","value":"{{exception}}"},"address":"sacexcecao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-82243cbc-e3cc-2e9d-4799-05fe802b8731","canChangeBackground":false}],"id":"377afe1e-202d-4223-9c32-b36c39c0b811","$title":"[REDIRECT TO] Exce√ß√µes","$position":{"top":"122px","left":"1061px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"20f2a16a-1d69-47d1-9a24-d087fc0b331b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"581d2ca6-5ab2-4e38-8726-d22b30bcf23c","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"3ed14941-bd24-4013-a18d-1f4c6e4ace91","$typeOfContent":"","type":"SetVariable","$title":"cleamException","$invalid":false,"settings":{"variable":"exception"},"conditions":[]}],"$leavingCustomActions":[{"$id":"8735939c-ee24-45e9-ba72-24fe28e39c0d","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Finalizar","$invalid":false,"settings":{"context":{"type":"text/plain","value":"ola"},"address":"sacfinalizacao"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-82243cbc-e3cc-2e9d-4799-05fe802b8731","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","root":false,"$title":"[REDIRECT TO] Finalizar","$position":{"top":"251.25px","left":"1061.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"79699b3e-9792-4285-afc5-b5aa42552260":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6d96947e-81eb-4195-9a03-8a7f8906e5eb","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"7455ae48-cff1-4bbb-b8f7-34f0ecea3ba1","$typeOfContent":"","type":"Redirect","$title":"[GO TO] Menu Principal","$invalid":false,"settings":{"context":{"type":"text/plain","value":"Menu"},"address":"sacboasvindas"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#0A6045","label":"REDIRECT TO","id":"blip-tag-82243cbc-e3cc-2e9d-4799-05fe802b8731","canChangeBackground":false}],"id":"79699b3e-9792-4285-afc5-b5aa42552260","root":false,"$title":"[REDIRECT TO] Menu Principal","$position":{"top":"382.25px","left":"1061.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#c8e6c9","textColor":"#000000"}},"959b012a-ccc6-442f-b9a0-28ea0ae1b8d8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aebf3f0a-56ac-4466-b042-70cabc54dbf4","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{returnBlockId}}","typeOfStateId":"variable","$id":"5a5e1d62-fe29-4e31-87f5-baa07e27c542","conditions":[{"source":"context","comparison":"notEquals","values":["ERROR"],"variable":"returnBlockId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ad440f48-87c3-4fa8-be77-43d1b0e5b835","$typeOfContent":"","type":"SetVariable","$title":"returnException","$invalid":false,"settings":{"variable":"returnException","value":"false"},"conditions":[]},{"$id":"c8ef55ca-3bf7-4e60-8e94-8a2a9ae327c5","$typeOfContent":"","type":"ExecuteScript","$title":"returnBlockId","$invalid":false,"settings":{"function":"run","source":"function run(exception) {\n  try {\n    exception = JSON.parse(exception)\n    const exceptionId = exception.id\n\n    const blockList = [\n      { exceptionId: \"CS110\", blockId: \"c9d0c48a-7d6b-468b-9458-41577eea43f7\" },\n      { exceptionId: \"CS150\", blockId: \"8e8437dc-8fe9-44b0-ab6e-a25e7ddbcf7d\" }\n    ]\n\n    let returnBlockId = \"\"\n\n    blockList.forEach(element => {\n      var find = exceptionId == element.exceptionId ? element.blockId : ''\n      if (find != '') {\n        returnBlockId = find\n      }\n    })\n\n    if (returnBlockId == \"\") {\n      returnBlockId = \"ERROR: COULDN'T MATCH EXCEPTION ID. DID YOU LINKED EXCEPTION ID TO BLOCK ID?\"\n    }\n\n    return returnBlockId\n  } catch (e) {\n    return \"ERROR: SCRIPT FAILURE\"\n  }\n}","inputVariables":["exception"],"outputVariable":"returnBlockId","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#FF961E","label":"executeScript","id":"blip-tag-10da33cd-3fdf-48d2-f8c7-275ffd02103c","canChangeBackground":false},{"background":"#FF4A1E","label":"Set variable","id":"blip-tag-024ed08b-c8b4-9452-aa33-a09569f77a2d","canChangeBackground":false}],"id":"959b012a-ccc6-442f-b9a0-28ea0ae1b8d8","root":false,"$title":"Retorno Exce√ß√£o","$position":{"top":"159px","left":"561px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#eb9694","textColor":"#000000","commentsIdList":[]}},"44483a8a-fd47-402a-807b-b50c46d02e96":{"$contentActions":[{"action":{"$id":"96d54af1-97bd-44cb-9e87-b1e9953e2604","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6efff17f-cfb8-4dbd-9dbf-ef66b877b6c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6efff17f-cfb8-4dbd-9dbf-ef66b877b6c5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"e443065c-f0d3-44e6-aed3-ce6d26b9aeea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e94e8a8d-81c9-4d81-9278-6c69e27f5253","type":"text/plain","content":"Que pena saber disso... üò™","metadata":{}},"$cardContent":{"document":{"id":"e94e8a8d-81c9-4d81-9278-6c69e27f5253","type":"text/plain","content":"Que pena saber disso... üò™"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4909d503-84b4-42f7-bf67-53aa271ed17c","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"8e8437dc-8fe9-44b0-ab6e-a25e7ddbcf7d","typeOfStateId":"state","$connId":"con_88","$id":"6f90de55-5991-46d5-b244-81044e928ae5","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"8e8437dc-8fe9-44b0-ab6e-a25e7ddbcf7d","$invalid":false,"typeOfStateId":"state"},"$tags":[],"id":"44483a8a-fd47-402a-807b-b50c46d02e96","root":false,"$title":"[CS.1.4.0] Nota Baixa","$position":{"top":"550px","left":"555.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed95ebbf-b2a4-4655-b3c4-1a9305ee7345":{"$contentActions":[{"action":{"$id":"3a15d034-6c81-4145-bdfa-f3100b48a8fa","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4be9ad42-622f-4c78-9b60-b98f11e422d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4be9ad42-622f-4c78-9b60-b98f11e422d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"c452b1ae-aaaa-4450-a82f-4dae91d9b1f1","$typeOfContent":"text","type":"SendMessage","settings":{"id":"934caca6-3c9a-4fc0-963d-5cc6e4f9b501","type":"text/plain","content":"Agradecemos pela sua {{n1}}opini√£o.{{n2}} Saiba que estamos em constante evolu√ß√£o para melhor te atender üòäüíô","metadata":{}},"$cardContent":{"document":{"id":"934caca6-3c9a-4fc0-963d-5cc6e4f9b501","type":"text/plain","content":"Agradecemos pela sua {{n1}}opini√£o.{{n2}} Saiba que estamos em constante evolu√ß√£o para melhor te atender üòäüíô"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"7df22ccf-7add-47a7-a5fa-b05285e46802","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"227fd0ec-4025-49c7-a3da-9f898546cd17","$typeOfContent":"","type":"TrackEvent","$title":"agradecimento exibicao","$invalid":false,"settings":{"extras":{},"category":"agradecimento exibicao","action":"Exibicao"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"20f2a16a-1d69-47d1-9a24-d087fc0b331b","$invalid":false,"typeOfStateId":"state"},"$tags":[{"background":"#61D36F","label":"Event tracking","id":"blip-tag-2664cb57-327e-f755-8a3a-fd0d71ef0745","canChangeBackground":false}],"id":"ed95ebbf-b2a4-4655-b3c4-1a9305ee7345","root":false,"$title":"[CS.1.6.0] Obrigado","$position":{"top":"899px","left":"365px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}